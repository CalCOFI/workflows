<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Join Larval and Bottle Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="explore_join-larvae-bottle_files/libs/clipboard/clipboard.min.js"></script>
<script src="explore_join-larvae-bottle_files/libs/quarto-html/quarto.js"></script>
<script src="explore_join-larvae-bottle_files/libs/quarto-html/popper.min.js"></script>
<script src="explore_join-larvae-bottle_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="explore_join-larvae-bottle_files/libs/quarto-html/anchor.min.js"></script>
<link href="explore_join-larvae-bottle_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="explore_join-larvae-bottle_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="explore_join-larvae-bottle_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="explore_join-larvae-bottle_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="explore_join-larvae-bottle_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="explore_join-larvae-bottle_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="explore_join-larvae-bottle_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="explore_join-larvae-bottle_files/libs/datatables-binding-0.26/datatables.js"></script>
<script src="explore_join-larvae-bottle_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="explore_join-larvae-bottle_files/libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="explore_join-larvae-bottle_files/libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="explore_join-larvae-bottle_files/libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="explore_join-larvae-bottle_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="explore_join-larvae-bottle_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#load-packages-and-connect-to-database" id="toc-load-packages-and-connect-to-database" class="nav-link active" data-scroll-target="#load-packages-and-connect-to-database"><span class="toc-section-number">1</span>  Load packages and Connect to Database</a></li>
  <li><a href="#get-nearest-bottle-data" id="toc-get-nearest-bottle-data" class="nav-link" data-scroll-target="#get-nearest-bottle-data"><span class="toc-section-number">2</span>  Get Nearest Bottle Data</a></li>
  <li><a href="#get-space-time-for-larval-data" id="toc-get-space-time-for-larval-data" class="nav-link" data-scroll-target="#get-space-time-for-larval-data"><span class="toc-section-number">3</span>  Get Space &amp; Time for Larval Data</a></li>
  <li><a href="#get-space-time-for-larval-data-with-_new-tables-no-results" id="toc-get-space-time-for-larval-data-with-_new-tables-no-results" class="nav-link" data-scroll-target="#get-space-time-for-larval-data-with-_new-tables-no-results"><span class="toc-section-number">4</span>  Get Space &amp; Time for Larval Data with <code>*_new</code> Tables – no results</a></li>
  <li><a href="#added-ctd_casts.datetime" id="toc-added-ctd_casts.datetime" class="nav-link" data-scroll-target="#added-ctd_casts.datetime"><span class="toc-section-number">5</span>  Added <code>ctd_casts.datetime</code></a></li>
  <li><a href="#show-tables" id="toc-show-tables" class="nav-link" data-scroll-target="#show-tables"><span class="toc-section-number">6</span>  Show Tables</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Join Larval and Bottle Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="load-packages-and-connect-to-database" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="load-packages-and-connect-to-database"><span class="header-section-number">1</span> Load packages and Connect to Database</h2>
<p>With <a href="https://calcofi.io/calcofi4r/reference/cc_db_connect.html"><code>cc_db_connect()</code></a>, note that you must either be running this from the CalCOFI server or have a tunnelled SSH connection with a user account on the server.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">"librarian"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"librarian"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use librarian::shelf() to load packages, installing if needed</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  calcofi<span class="sc">/</span>calcofi4r,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  dplyr, DBI, DT, glue, readr, sf, skimr,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">quiet =</span> T)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>tbl_head <span class="ot">&lt;-</span> <span class="cf">function</span>(tbl, <span class="at">n=</span><span class="dv">10</span>){</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbGetQuery</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    con, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">glue</span>(<span class="st">"SELECT * FROM {tbl} LIMIT {n}"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>tbl_fields <span class="ot">&lt;-</span> <span class="cf">function</span>(tbl){</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbListFields</span>(con, tbl) <span class="sc">%&gt;%</span> <span class="fu">paste</span>(<span class="at">collapse=</span><span class="st">", "</span>)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">cc_db_connect</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="get-nearest-bottle-data" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="get-nearest-bottle-data"><span class="header-section-number">2</span> Get Nearest Bottle Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create function to form query and return results</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>get_nearest_bottle <span class="ot">&lt;-</span> <span class="cf">function</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    fld,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    datetime, max_hrs,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    lon, lat, max_kms,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    depth_min, depth_max,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">verbose =</span> <span class="cn">FALSE</span>){</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  sql <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT </span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="st">      b.{fld},</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="st">      c.datetime, c.longitude, c.latitude,</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="st">      b.depthm,</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">      ST_Distance(c.geom, ST_GeomFromText('POINT({lon} {lat})', 4326)::GEOGRAPHY)/1000</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="st">        AS diff_kms,</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="st">      EXTRACT(EPOCH FROM c.datetime - '{datetime}'::TIMESTAMP)/3600</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="st">        AS diff_hrs</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM ctd_bottles AS b</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="st">    LEFT JOIN</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="st">      ctd_casts AS c USING (cast_count)</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="st">    WHERE</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="st">      ST_DWithin(</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="st">        c.geom::GEOGRAPHY,</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="st">        ST_GeomFromText('POINT({lon} {lat})', 4326)::GEOGRAPHY,</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="st">        {max_kms} * 1000) AND</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="st">      c.datetime &lt;= ('{datetime}'::TIMESTAMP + INTERVAL '{max_hrs} HOUR') AND</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="st">      c.datetime &gt;= ('{datetime}'::TIMESTAMP - INTERVAL '{max_hrs} HOUR') AND</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="st">    depthm &lt;= {depth_max} AND</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="st">    depthm &gt;= {depth_min}"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (verbose)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(sql)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dbGetQuery</span>(con, sql) <span class="sc">%&gt;%</span> </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tibble</span>()</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="co"># run with "most recent" larval data attributable in space and time</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">get_nearest_bottle</span>(</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">fld       =</span> <span class="st">"t_degc"</span>,</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">datetime  =</span> <span class="st">"1999-12-06 20:32:00 UTC"</span>, </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_hrs   =</span> <span class="dv">800</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">lon       =</span> <span class="sc">-</span><span class="fl">117.8483</span>,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">lat       =</span>  <span class="fl">29.11833</span>, </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">max_kms   =</span> <span class="dv">1000</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">depth_min =</span> <span class="dv">0</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">depth_max =</span> <span class="dv">20</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose   =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>SELECT 
  b.t_degc,
  c.datetime, c.longitude, c.latitude,
  b.depthm,
  ST_Distance(c.geom, ST_GeomFromText('POINT(-117.8483 29.11833)', 4326)::GEOGRAPHY)/1000
    AS diff_kms,
  EXTRACT(EPOCH FROM c.datetime - '1999-12-06 20:32:00 UTC'::TIMESTAMP)/3600
    AS diff_hrs
FROM ctd_bottles AS b
LEFT JOIN
  ctd_casts AS c USING (cast_count)
WHERE
  ST_DWithin(
    c.geom::GEOGRAPHY,
    ST_GeomFromText('POINT(-117.8483 29.11833)', 4326)::GEOGRAPHY,
    1000 * 1000) AND
  c.datetime &lt;= ('1999-12-06 20:32:00 UTC'::TIMESTAMP + INTERVAL '800 HOUR') AND
  c.datetime &gt;= ('1999-12-06 20:32:00 UTC'::TIMESTAMP - INTERVAL '800 HOUR') AND
depthm &lt;= 20 AND
depthm &gt;= 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-08ba6ae3ffd539233f24" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-08ba6ae3ffd539233f24">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44"],[14.97,14.97,14.89,14.89,14.87,14.86,14.24,14.24,14.08,14.07,13.99,13.97,14.19,14.19,14.19,14.19,14.19,14.18,14.4,14.4,14.42,14.22,14.09,14.06,13.91,13.85,14.73,14.73,14.47,14.34,14.23,14.72,14.72,14.43,13.55,14.27,14.27,14.18,13.97,13.96,14.52,14.52,14.52,14.52],["2000-01-08T18:32:00Z","2000-01-08T18:32:00Z","2000-01-08T18:32:00Z","2000-01-08T18:32:00Z","2000-01-08T18:32:00Z","2000-01-08T18:32:00Z","2000-01-08T21:38:00Z","2000-01-08T21:38:00Z","2000-01-08T21:38:00Z","2000-01-08T21:38:00Z","2000-01-08T21:38:00Z","2000-01-08T21:38:00Z","2000-01-09T02:14:00Z","2000-01-09T02:14:00Z","2000-01-09T02:14:00Z","2000-01-09T02:14:00Z","2000-01-09T02:14:00Z","2000-01-09T02:14:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T20:19:00Z","2000-01-07T23:47:00Z","2000-01-07T23:47:00Z","2000-01-07T23:47:00Z","2000-01-07T23:47:00Z","2000-01-07T23:47:00Z","2000-01-08T02:56:00Z","2000-01-08T02:56:00Z","2000-01-08T02:56:00Z","2000-01-08T02:56:00Z","2000-01-08T07:08:00Z","2000-01-08T07:08:00Z","2000-01-08T07:08:00Z","2000-01-08T07:08:00Z","2000-01-08T07:08:00Z","2000-01-08T11:19:00Z","2000-01-08T11:19:00Z","2000-01-08T11:19:00Z","2000-01-08T11:19:00Z"],[-118.578333,-118.578333,-118.578333,-118.578333,-118.578333,-118.578333,-118.891666,-118.891666,-118.891666,-118.891666,-118.891666,-118.891666,-119.238333,-119.238333,-119.238333,-119.238333,-119.238333,-119.238333,-117.303333,-117.303333,-117.303333,-117.303333,-117.303333,-117.303333,-117.303333,-117.303333,-117.391666,-117.391666,-117.391666,-117.391666,-117.391666,-117.53,-117.53,-117.53,-117.53,-117.876666,-117.876666,-117.876666,-117.876666,-117.876666,-118.215,-118.215,-118.215,-118.215],[32.348333,32.348333,32.348333,32.348333,32.348333,32.348333,32.176666,32.176666,32.176666,32.176666,32.176666,32.176666,32.003333,32.003333,32.003333,32.003333,32.003333,32.003333,32.958333,32.958333,32.958333,32.958333,32.958333,32.958333,32.958333,32.958333,32.91,32.91,32.91,32.91,32.91,32.85,32.85,32.85,32.85,32.678333,32.678333,32.678333,32.678333,32.678333,32.513333,32.513333,32.513333,32.513333],[0,2,9,10,18,20,0,2,9,10,19,20,0,2,10,11,19,20,0,1,2,6,10,11,19,20,0,2,10,19,20,0,1,10,20,0,2,10,19,20,0,1,10,20],[364.85196045627,364.85196045627,364.85196045627,364.85196045627,364.85196045627,364.85196045627,353.49326771382,353.49326771382,353.49326771382,353.49326771382,353.49326771382,353.49326771382,346.5148536634,346.5148536634,346.5148536634,346.5148536634,346.5148536634,346.5148536634,428.90690264046,428.90690264046,428.90690264046,428.90690264046,428.90690264046,428.90690264046,428.90690264046,428.90690264046,422.63572403304,422.63572403304,422.63572403304,422.63572403304,422.63572403304,414.84277914281,414.84277914281,414.84277914281,414.84277914281,394.69933319977,394.69933319977,394.69933319977,394.69933319977,394.69933319977,378.02298117869,378.02298117869,378.02298117869,378.02298117869],[790,790,790,790,790,790,793.1,793.1,793.1,793.1,793.1,793.1,797.7,797.7,797.7,797.7,797.7,797.7,767.783333333333,767.783333333333,767.783333333333,767.783333333333,767.783333333333,767.783333333333,767.783333333333,767.783333333333,771.25,771.25,771.25,771.25,771.25,774.4,774.4,774.4,774.4,778.6,778.6,778.6,778.6,778.6,782.783333333333,782.783333333333,782.783333333333,782.783333333333]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>t_degc<\/th>\n      <th>datetime<\/th>\n      <th>longitude<\/th>\n      <th>latitude<\/th>\n      <th>depthm<\/th>\n      <th>diff_kms<\/th>\n      <th>diff_hrs<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># render temperature using simple mean</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x<span class="sc">$</span>t_degc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.34477</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compare weighted means using seperation difference in space (kilometers)...</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(x<span class="sc">$</span>t_degc, x<span class="sc">$</span>diff_kms)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.34289</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ... or time (hours)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">weighted.mean</span>(x<span class="sc">$</span>t_degc, x<span class="sc">$</span>diff_hrs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.34511</code></pre>
</div>
</div>
</section>
<section id="get-space-time-for-larval-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="get-space-time-for-larval-data"><span class="header-section-number">3</span> Get Space &amp; Time for Larval Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>d_larvae <span class="ot">&lt;-</span> <span class="fu">tbl</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  con, <span class="st">"larvae_counts"</span>) <span class="sc">%&gt;%</span>  <span class="co"># tbl_fields("larvae_counts")</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cruise, ship, orderocc, towtype, townum, netloc: spccode, count</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"stations"</span>),    <span class="co"># tbl_fields("stations")    </span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cruise, ship, orderocc: longitude, latitude, line, station, geom</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cruise"</span>, <span class="st">"ship"</span>, <span class="st">"orderocc"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"tows"</span>),        <span class="co"># tbl_fields("tows")    </span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cruise, ship, orderocc, towtype, townum, netloc: shf, volsampled, percsorted, datetime, date</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cruise"</span>, <span class="st">"ship"</span>, <span class="st">"orderocc"</span>, <span class="st">"towtype"</span>, <span class="st">"townum"</span>, <span class="st">"netloc"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(date), <span class="fu">desc</span>(datetime)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># show_query() # uncomment to show SQL</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>d_larvae_miss <span class="ot">&lt;-</span> d_larvae <span class="sc">%&gt;%</span> </span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(date) <span class="sc">|</span> <span class="fu">is.na</span>(longitude)) </span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>d_larvae_miss <span class="sc">%&gt;%</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">"data/larvae-count_missing-location-or-date.csv"</span>)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(d_larvae_miss) <span class="co"># 90,131 without attributable date or location</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 90131</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show cruise-ship in larvae_counts missing stations with location</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>d_larvae_miss_stations <span class="ot">&lt;-</span> <span class="fu">tbl</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  con, <span class="st">"larvae_counts"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"stations"</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cruise"</span>, <span class="st">"ship"</span>, <span class="st">"orderocc"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cruise, ship) <span class="sc">%&gt;%</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_orderocc =</span> <span class="fu">n</span>(),</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># show_query() # uncomment to show SQL</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>d_larvae_miss_stations <span class="sc">%&gt;%</span> </span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">"data/larvae-count_cruise-ship_missing-in_stations.csv"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>d_larvae_miss_stations <span class="sc">%&gt;%</span> </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"The cruise and ship values from the larvae_counts table without a match in the stations table."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-ccd9432447c578ae98ec" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ccd9432447c578ae98ec">{"x":{"filter":"none","vertical":false,"caption":"<caption>The cruise and ship values from the larvae_counts table without a match in the stations table.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176"],["0001","0004","0006","0007","0010","0010","0010","0101","0104","0106","0107","0110","0110","0110","0201","0202","0204","0204","0207","0210","0210","0211","0302","0302","0304","0304","0307","0307","0310","0310","0310","0401","0401","0402","0402","0403","0404","0404","0404","0405","0407","0407","0410","0411","0411","0501","0501","0501","0502","0502","0503","0504","0504","0504","0507","0507","0509","0510","0510","0511","0602","0604","0604","0604","0607","0610","0610","0610","0701","0704","0706","0707","0710","0711","0801","0804","0804","0807","0808","0810","0810","0901","0903","0904","0907","0911","1001","1004","1004","1008","1009","1011","1101","1104","1104","1108","1110","1202","1203","1204","1204","1207","1207","1208","1209","1210","1301","1304","1304","1307","1307","1311","1402","1404","1404","1407","1407","1411","1501","1504","1504","1507","1507","1511","1601","1604","1604","1607","1701","1704","1704","1708","1802","1804","1806","1902","1904","2001","2101","2105","3906","4003","4004","4005","4006","4103","4104","4105","4106","4107","4108","5002","5002","5002","5003","5003","5003","5003","5004","5004","5004","5005","5005","5005","5006","5006","5006","5007","5007","5007","5008","5008","5008","5009","5009","5009"],["NH","JD","JD","NH","JD","M4","NH","JD","JD","JD","NH","JD","M4","NH","JD","NH","JD","M4","NH","JD","M4","NH","JD","SP","JD","RR","FR","NH","JD","M2","NH","JD","LM","LM","NH","FR","JD","LM","NH","LM","FR","JD","LM","LM","RR","JD","LM","NH","JD","LM","FR","JD","LM","NH","LM","NH","M2","JD","M2","NH","JD","JD","NH","OD","NH","JD","M2","RR","JD","JD","MF","NH","M2","NH","JD","JD","MF","JD","NH","M2","NH","NH","JD","FR","M2","NH","NH","FR","MF","NH","SH","NH","NH","FR","SH","NH","NH","NH","SH","OS","SH","OS","SH","OS","OS","NH","SH","OS","SH","NH","SH","NH","SH","OS","SH","NH","SH","NH","NH","NH","SH","OC","SH","OC","RL","RL","SH","OS","RL","RL","SH","SR","SH","SH","SR","RL","RL","RL","RL","SH","ES","ES","ES","ES","ES","ES","ES","ES","ES","ES","ES","BD","CR","HO","BD","CR","HO","PT","BD","CR","HO","BD","CR","HO","BD","CR","PT","BD","CR","PT","BD","CR","PT","BD","CR","PT"],[586,861,1323,440,1243,1996,441,535,713,1482,579,209,82,408,795,1990,751,169,381,2433,616,262,910,1361,325,589,7,237,1750,960,349,673,10,33,960,23,442,39,703,67,35,577,56,21,385,180,60,626,231,30,31,167,89,913,26,527,51,414,66,338,833,234,725,257,631,1670,1396,329,722,616,11,446,60,204,501,595,554,379,458,83,281,451,644,784,560,493,681,454,1103,579,16,385,1385,426,906,433,455,978,480,271,298,827,144,264,23,620,1355,417,886,703,249,879,395,752,413,1155,183,823,1171,820,592,753,379,638,1137,747,1004,600,531,891,1182,613,483,1072,805,274,720,614,473,385,21,62,64,41,27,64,71,67,44,12,1,21,34,28,25,3,39,11,24,46,30,18,50,48,28,65,21,48,50,20,31,31,4,21,7,10]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cruise<\/th>\n      <th>ship<\/th>\n      <th>n_orderocc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show cruise-ship in larvae_counts missing tows with datetime</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>d_larvae_miss_tows <span class="ot">&lt;-</span> <span class="fu">tbl</span>(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  con, <span class="st">"larvae_counts"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"tows"</span>),        <span class="co"># tbl_fields("tows")    </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cruise, ship, orderocc, towtype, townum, netloc: shf, volsampled, percsorted, datetime, date</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cruise"</span>, <span class="st">"ship"</span>, <span class="st">"orderocc"</span>, <span class="st">"towtype"</span>, <span class="st">"townum"</span>, <span class="st">"netloc"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cruise, ship) <span class="sc">%&gt;%</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_orderocc =</span> <span class="fu">n</span>(),</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># show_query() # uncomment to show SQL</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>d_larvae_miss_tows <span class="sc">%&gt;%</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">write_csv</span>(<span class="st">"data/larvae-count_cruise-ship_missing-in_tows.csv"</span>)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>d_larvae_miss_tows <span class="sc">%&gt;%</span> </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"The cruise and ship values from the larvae_counts table without a match in the tows table."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-c33187bff1107b3f276f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c33187bff1107b3f276f">{"x":{"filter":"none","vertical":false,"caption":"<caption>The cruise and ship values from the larvae_counts table without a match in the tows table.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164"],["0403","0007","0706","0307","0302","8104","5005","0610","4104","8904","5007","0110","0404","5004","0509","0210","1411","5008","5005","5007","0504","5003","4106","5008","5009","0211","1001","0407","0110","7210","0810","0006","0410","0106","5003","0302","8803","5003","0101","0610","9306","1501","0402","0110","5009","0707","9804","0501","5004","4003","4006","0004","9504","9809","0604","0810","0204","9001","5009","1202","9703","0304","0001","5004","0404","0502","1407","0307","0904","9704","0507","0903","0501","0911","0602","0604","0310","5006","9904","9910","1301","5002","0710","1402","0411","9107","0010","0201","4107","0704","1404","0610","0607","5006","0807","0510","0504","4103","0504","0804","9709","4004","0502","0804","0901","9802","0204","5005","5002","9807","9908","9707","0402","5003","0407","0104","9503","0107","0010","0808","5008","0010","0604","0401","0801","1101","8701","8304","0401","8511","0501","5002","0701","4005","9701","1304","5007","5006","0210","9901","0310","0510","9104","0711","0207","0411","0404","2101","7803","0503","0507","3906","0405","4105","4108","0907","0304","1207","0310","0511","8903","1311","0202","9203"],["FR","NH","MF","NH","SP","PN","HO","JD","ES","JD","PT","M4","LM","BD","M2","JD","NH","BD","CR","BD","JD","HO","ES","CR","PT","NH","NH","JD","NH","AX","NH","JD","LM","JD","CR","JD","JD","BD","JD","RR","JD","NH","LM","JD","BD","NH","JD","LM","CR","ES","ES","JD","JD","NH","JD","M2","M4","JD","CR","NH","JD","JD","NH","HO","NH","JD","NH","FR","FR","NH","LM","JD","JD","NH","JD","NH","NH","CR","JD","NH","SH","CR","M2","SH","LM","NH","M4","JD","ES","JD","OS","M2","NH","PT","JD","JD","NH","ES","LM","MF","NH","ES","LM","JD","NH","JD","JD","BD","HO","NH","NH","JD","NH","PT","FR","JD","JD","NH","NH","NH","PT","JD","OD","LM","JD","NH","JD","TC","JD","JD","NH","BD","JD","ES","JD","SH","CR","BD","M4","RR","JD","M2","JD","NH","NH","RR","JD","RL","OP","FR","NH","ES","LM","ES","ES","M2","RR","SH","M2","NH","JD","NH","NH","NH"],[23,440,11,237,1361,10,48,1670,71,2,20,82,39,24,51,2433,149,31,50,48,167,39,44,31,10,262,186,577,408,1,281,1323,56,1482,3,910,8,25,535,329,554,160,33,209,21,446,103,60,46,62,27,861,70,50,234,83,169,6,7,239,315,325,586,30,703,231,222,7,784,77,26,644,180,493,833,725,349,65,301,123,320,34,60,53,21,1705,1996,795,12,616,94,1396,631,21,379,414,913,64,89,554,34,64,30,595,451,122,751,18,28,49,119,30,960,11,35,713,416,579,441,458,4,1243,257,10,501,261,8,341,673,51,626,21,722,41,208,84,50,28,616,65,1750,66,1496,204,381,385,442,302,99,31,527,21,67,67,1,560,589,6,960,338,18,136,1990,1268]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cruise<\/th>\n      <th>ship<\/th>\n      <th>n_orderocc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":3},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get larvae with valid space and time attribution</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>d_larvae_st <span class="ot">&lt;-</span> d_larvae <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(date),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!</span><span class="fu">is.na</span>(longitude)) </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(d_larvae_st) <span class="co"># 307,365 rows with valid space and time attribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 307365</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>d_larvae_st1 <span class="ot">&lt;-</span> d_larvae_st <span class="sc">%&gt;%</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>geom)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>d_larvae_st1 <span class="sc">%&gt;%</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-123c3f66d1f708432d76" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-123c3f66d1f708432d76">{"x":{"filter":"none","vertical":false,"data":[["1"],["9910"],["M4"],[98],["CB"],[1],["S"],[226],[2],[-117.848333],[29.118333],[108.8],[61.1],[4.76],[439],[1],["1999-12-06T20:32:00Z"],["1999-12-06"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cruise<\/th>\n      <th>ship<\/th>\n      <th>orderocc<\/th>\n      <th>towtype<\/th>\n      <th>townum<\/th>\n      <th>netloc<\/th>\n      <th>spccode<\/th>\n      <th>count<\/th>\n      <th>longitude<\/th>\n      <th>latitude<\/th>\n      <th>line<\/th>\n      <th>station<\/th>\n      <th>shf<\/th>\n      <th>volsampled<\/th>\n      <th>percsorted<\/th>\n      <th>datetime<\/th>\n      <th>date<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,5,7,8,9,10,11,12,13,14,15]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>So the most recent larval data with attributable space and time is: - 1999-12-06 20:32:00 (longitude: -117.848333; latitude: 29.118333)</p>
<p>We’re clearly mismatching something since the most recent date for the ERDDAP subset is <code>2020-01-18T04:57:00Z</code>:</p>
<ul>
<li><a href="https://coastwatch.pfeg.noaa.gov/erddap/tabledap/erdCalCOFIlrvcntAtoAM.html">ERDDAP - CalCOFI Larvae Counts, Scientific Names A to AM - Data Access Form</a></li>
</ul>
<p>Here are some of the files output above highlighting larvae_count data without expected matches:</p>
<ul>
<li><a href="https://github.com/CalCOFI/scripts/blob/main/data/larvae-count_cruise-ship_missing-in_stations.csv">larvae-count_cruise-ship_missing-in_stations.csv</a></li>
<li><a href="https://github.com/CalCOFI/scripts/blob/main/data/larvae-count_cruise-ship_missing-in_tows.csv">larvae-count_cruise-ship_missing-in_tows.csv</a></li>
<li><a href="https://github.com/CalCOFI/scripts/blob/main/data/larvae-count_missing-location-or-date.csv">larvae-count_missing-location-or-date.csv</a></li>
</ul>
</section>
<section id="get-space-time-for-larval-data-with-_new-tables-no-results" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="get-space-time-for-larval-data-with-_new-tables-no-results"><span class="header-section-number">4</span> Get Space &amp; Time for Larval Data with <code>*_new</code> Tables – no results</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># try with *_new tables:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl</span>(con, <span class="st">"larvae_counts"</span>) <span class="sc">%&gt;%</span>   <span class="co"># tbl_fields("larvae_counts")</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cruise, ship, orderocc, towtype, townum, netloc: spccode, count</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"cruises"</span>),        <span class="co"># tbl_fields("cruises")</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cruise, ship: cruiseid</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cruise"</span>, <span class="st">"ship"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"stations_new"</span>),   <span class="co"># tbl_fields("stations_new")</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># cruiseid, orderocc: stationid, latitude, longitude, line, station</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"cruiseid"</span>, <span class="st">"orderocc"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"tows_new"</span>),       <span class="co"># tbl_fields("tows_new")</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># stationid, towtype, townumber: towid, starttime</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"stationid"</span>, <span class="st">"towtype"</span>, <span class="st">"townum"</span> <span class="ot">=</span> <span class="st">"townumber"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(starttime), <span class="sc">!</span><span class="fu">is.na</span>(longitude)) <span class="sc">%&gt;%</span> </span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(starttime))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Source:     SQL [0 x 16]
# Database:   postgres  [admin@localhost:5432/gis]
# Ordered by: desc(starttime)
# … with 16 variables: cruise &lt;chr&gt;, ship &lt;chr&gt;, orderocc &lt;int&gt;, towtype &lt;chr&gt;,
#   townum &lt;int&gt;, netloc &lt;chr&gt;, spccode &lt;int&gt;, count &lt;int&gt;, cruiseid &lt;int&gt;,
#   stationid &lt;int&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;, line &lt;dbl&gt;,
#   station &lt;dbl&gt;, towid &lt;int&gt;, starttime &lt;dttm&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># yikes, no rows!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="added-ctd_casts.datetime" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="added-ctd_casts.datetime"><span class="header-section-number">5</span> Added <code>ctd_casts.datetime</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add a single field with datetime to make querying easier</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbSendQuery</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  con,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ALTER TABLE ctd_casts ADD COLUMN IF NOT EXISTS datetime TIMESTAMP"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>NOTICE:  column "datetime" of relation "ctd_casts" already exists, skipping</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;PqResult&gt;
  SQL  ALTER TABLE ctd_casts ADD COLUMN IF NOT EXISTS datetime TIMESTAMP
  ROWS Fetched: 0 [complete]
       Changed: 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbSendQuery</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  con,</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"UPDATE ctd_casts </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">  SET datetime = (date::text || ' ' || time::text || ' America/Los_Angeles')::timestamp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in result_create(conn@ptr, statement, immediate): Closing open result
set, cancelling previous query</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;PqResult&gt;
  SQL  UPDATE ctd_casts 
  SET datetime = (date::text || ' ' || time::text || ' America/Los_Angeles')::timestamp
  ROWS Fetched: 0 [complete]
       Changed: 35376</code></pre>
</div>
</div>
</section>
<section id="show-tables" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="show-tables"><span class="header-section-number">6</span> Show Tables</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show all tables</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(con)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in result_create(conn@ptr, statement, immediate): Closing open result
set, cancelling previous query</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "geography_columns"          "geometry_columns"          
 [3] "spatial_ref_sys"            "field_labels"              
 [5] "krill_abundances"           "stations_order"            
 [7] "r_sta_cnt"                  "species_groups"            
 [9] "dissolved_inorganic_carbon" "ctd_bottles"               
[11] "egg_counts"                 "larvae_counts"             
[13] "ctd_casts"                  "scrippscast"               
[15] "species_codes"              "stations"                  
[17] "taxa_hierarchy"             "tow_types"                 
[19] "tsn_list"                   "tows"                      
[21] "stations_hull"              "aoi_fed_sanctuaries"       
[23] "grd_a"                      "ships"                     
[25] "grd_mer"                    "r_mer100km"                
[27] "stations_new"               "tows_new"                  
[29] "raster_columns"             "raster_overviews"          
[31] "test_rast"                  "cruises"                   
[33] "effort_areas"               "places"                    
[35] "effort_grid"                "effort_ctrs"               
[37] "effort_zones"              </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"ctd_casts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-3b41f62015e748a5bb4b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3b41f62015e748a5bb4b">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[1009,500,1010,1011,1012,1013,1015,1016,1017,1018],["1950-02-03-C-31CR","1949-08-03-C-31BD","1950-02-03-C-31CR","1950-02-03-C-31CR","1950-02-03-C-31CR","1950-02-03-C-31CR","1950-02-03-C-31CR","1950-02-03-C-31CR","1950-02-03-C-31CR","1950-02-03-C-31CR"],["195002","194908","195002","195002","195002","195002","195002","195002","195002","195002"],["1950028330550","1949081800180","1950029330300","1950029330400","1950029330700","1950029330800","1950029670900","1950029670800","1950029670700","1950029670600"],["8330550","1800180","9330300","9330400","9330700","9330800","9670900","9670800","9670700","9670600"],["19-5002CR-HY-041-2048-08330550","19-4908BD-HY-228-0200-01800180","19-5002CR-HY-042-1206-09330300","19-5002CR-HY-042-1818-09330400","19-5002CR-HY-043-1418-09330700","19-5002CR-HY-043-2030-09330800","19-5002CR-HY-044-0854-09670900","19-5002CR-HY-044-1506-09670800","19-5002CR-HY-044-2124-09670700","19-5002CR-HY-045-0336-09670600"],["083.3 055.0","018.0 018.0","093.3 030.0","093.3 040.0","093.3 070.0","093.3 080.0","096.7 090.0","096.7 080.0","096.7 070.0","096.7 060.0"],[1,3,1,1,1,1,1,1,1,1],["ST","NST","ST","ST","ST","ST","NRO","NRO","NRO","IMX"],[-63.23,null,-14.5,-55.43,-174,-215.63,null,null,null,null],["1950-02-10","1949-08-16","1950-02-11","1950-02-11","1950-02-12","1950-02-12","1950-02-13","1950-02-13","1950-02-13","1950-02-14"],[1950,1949,1950,1950,1950,1950,1950,1950,1950,1950],[2,8,2,2,2,2,2,2,2,2],[18304,18126,18305,18305,18306,18306,18307,18307,18307,18308],[41,228,42,42,43,43,44,44,44,45],["20:48:00","02:00:00","12:06:00","18:18:00","14:18:00","20:30:00","08:54:00","15:06:00","21:24:00","03:36:00"],[33.733333,46.25,32.833333,32.466666,31.5,31.125,30.266666,30.516666,30.866666,31.216666],[33,46,32,32,31,31,30,30,30,31],[44,15,50,28,30,7.5,16,31,52,13],["N","N","N","N","N","N","N","N","N","N"],[-120.4,-125.783333,-117.516666,-118.2,-120.233333,-120.916666,-121.158333,-120.516666,-119.833333,-119.183333],[-120,-125,-117,-118,-120,-120,-121,-120,-119,-119],[24,47,31,12,14,55,9.5,31,50,11],["W","W","W","W","W","W","W","W","W","W"],[83.3,18,93.3,93.3,93.3,93.3,96.7,96.7,96.7,96.7],[83.3,18,93.3,93.3,93.3,93.3,96.7,96.7,96.7,96.7],[83.4,18.1,93.4,93.5,93.4,93.5,96.7,97,97,96.9],[55,18,30,40,70,80,90,80,70,60],[55,18,30,40,70,80,90,80,70,60],[55,18.8,29.9,40.2,70,80.4,89.7,80.6,70.3,60.4],[1052,null,732,1920,null,3749,4023,null,3658,3749],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],["CREST","BLACK DOUGLAS","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST"],["31CR","31BD","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR"],["HY","HY","HY","HY","HY","HY","HY","HY","HY","HY"],[null,null,null,null,null,null,null,null,null,null],[197,505,198,199,200,201,203,204,205,206],[null,null,null,null,null,null,null,null,null,null],["083 55","018 18","093 30","093 40","093 70","093 80","097 90","097 80","097 70","097 60"],[null,null,null,null,null,null,null,null,null,null],["5002      ","4908      ","5002      ","5002      ","5002      ","5002      ","5002      ","5002      ","5002      ","5002      "],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[22,25,22,27,30,34,36,30,36,34],[8,5,8,24,24,24,18,8,8,2],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[5,1,5,4,1,1,1,1,1,1],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],["0101000020E61000009A99999999195EC0EE0912DBDDDD4040","0101000020E61000002A38BC2022725FC00000000000204740","0101000020E6100000213D450E11615DC0BBD6DEA7AA6A4040","0101000020E6100000CDCCCCCCCC8C5DC0DB1324B6BB3B4040","0101000020E6100000F70489EDEE0E5EC00000000000803F40","0101000020E6100000BBD6DEA7AA3A5EC00000000000203F40","0101000020E61000002A38BC20224A5EC084F4143944443E40","0101000020E6100000213D450E11215EC084F4143944843E40","0101000020E61000005D6BEF5355F55DC01D8EAED2DDDD3E40","0101000020E6100000C4D155BABBCB5DC0B727486C77373F40"],["1950-02-10T20:48:00Z","1949-08-16T02:00:00Z","1950-02-11T12:06:00Z","1950-02-11T18:18:00Z","1950-02-12T14:18:00Z","1950-02-12T20:30:00Z","1950-02-13T08:54:00Z","1950-02-13T15:06:00Z","1950-02-13T21:24:00Z","1950-02-14T03:36:00Z"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cast_count<\/th>\n      <th>cruiseid<\/th>\n      <th>cruise<\/th>\n      <th>cruz_sta<\/th>\n      <th>dbsta_id<\/th>\n      <th>castid<\/th>\n      <th>sta_id<\/th>\n      <th>quarter<\/th>\n      <th>sta_code<\/th>\n      <th>distance<\/th>\n      <th>date<\/th>\n      <th>year<\/th>\n      <th>month<\/th>\n      <th>juliandate<\/th>\n      <th>julianday<\/th>\n      <th>time<\/th>\n      <th>latitude<\/th>\n      <th>latdeg<\/th>\n      <th>latmin<\/th>\n      <th>lathem<\/th>\n      <th>longitude<\/th>\n      <th>londeg<\/th>\n      <th>lonmin<\/th>\n      <th>lonhem<\/th>\n      <th>rptline<\/th>\n      <th>stline<\/th>\n      <th>acline<\/th>\n      <th>rptsta<\/th>\n      <th>ststa<\/th>\n      <th>acsta<\/th>\n      <th>bottomdepth<\/th>\n      <th>secchi<\/th>\n      <th>foreiu<\/th>\n      <th>shipname<\/th>\n      <th>shipcode<\/th>\n      <th>datatype<\/th>\n      <th>orderocc<\/th>\n      <th>eventnum<\/th>\n      <th>cruzleg<\/th>\n      <th>origstaid<\/th>\n      <th>dataor<\/th>\n      <th>cruznum<\/th>\n      <th>intchl<\/th>\n      <th>intc14<\/th>\n      <th>incstr<\/th>\n      <th>incend<\/th>\n      <th>pstlan<\/th>\n      <th>civilt<\/th>\n      <th>timezone<\/th>\n      <th>wavedir<\/th>\n      <th>waveht<\/th>\n      <th>waveprd<\/th>\n      <th>winddir<\/th>\n      <th>windspd<\/th>\n      <th>barometer<\/th>\n      <th>dryt<\/th>\n      <th>wett<\/th>\n      <th>wea<\/th>\n      <th>cloudtype<\/th>\n      <th>cloudamount<\/th>\n      <th>visibility<\/th>\n      <th>geom<\/th>\n      <th>datetime<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,8,10,12,13,14,15,17,18,19,21,22,23,25,26,27,28,29,30,31,32,33,37,38,39,43,44,49,50,51,52,53,54,55,56,57,58,59,60,61]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"ctd_bottles"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-da90c9cf0ddb858d2a6d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-da90c9cf0ddb858d2a6d">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[1626,1626,1626,1626,1626,1626,1626,1626,1626,1626],[50312,50313,50314,50315,50316,50317,50318,50319,50320,50321],["126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0","126.7 050.0"],["19-5007PT-HY-191-0000-12670500-0301A-3","19-5007PT-HY-191-0000-12670500-0400A-7","19-5007PT-HY-191-0000-12670500-0404A-3","19-5007PT-HY-191-0000-12670500-0500A-7","19-5007PT-HY-191-0000-12670500-0503A-3","19-5007PT-HY-191-0000-12670500-0600A-7","19-5007PT-HY-191-0000-12670500-0606A-3","19-5007PT-HY-191-0000-12670500-0700A-7","19-5007PT-HY-191-0000-12670500-0800A-7","19-5007PT-HY-191-0000-12670500-0808A-3"],[301,400,404,500,503,600,606,700,800,808],[8.39,7.48,7.44,6.68,6.66,5.96,5.92,5.34,4.84,4.8],[34.4,34.4,34.4,34.429,34.43,34.449,34.45,34.479,34.508,34.51],[1.46,0.55,0.52,0.35,0.34,0.36,0.36,0.41,0.47,0.68],[26.749,26.885,26.89,27.019,27.023,27.129,27.135,27.229,27.311,27.317],[22.2,8.2,7.7,5.1,5,5.2,5.2,5.8,6.6,9.5],[63.50491,23.91991,22.61508,15.21978,14.78487,15.65295,15.65286,17.82524,20.43218,29.56128],[null,null,null,null,null,null,null,null,null,null],[3,7,3,7,3,7,3,7,7,3],[2,2,2,2,2,2,2,2,2,2],[null,null,null,null,null,null,null,null,null,null],[2,3,2,3,2,3,2,3,3,2],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,8],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,8],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[2.9,3.05,3.05,3.17,3.17,3.24,3.24,3.25,3.27,3.27],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[303,402,406,503,506,604,610,705,806,814],[8.36,7.44,7.4,6.63,6.61,5.91,5.87,5.28,4.77,4.73],[134.5,122.8,122.2,110.9,110.6,101.1,100.6,92,84.7,84.1],[0.6,0.73,0.73,0.84,0.85,0.95,0.95,1.04,1.13,1.14],[null,null,null,null,null,null,null,null,null,null],[63.50491,23.91991,22.61508,15.21978,14.78487,15.65295,15.65286,17.82524,20.43218,29.56128],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cast_count<\/th>\n      <th>btl_cnt<\/th>\n      <th>sta_id<\/th>\n      <th>depth_id<\/th>\n      <th>depthm<\/th>\n      <th>t_degc<\/th>\n      <th>salinity<\/th>\n      <th>o2ml_l<\/th>\n      <th>stheta<\/th>\n      <th>o2sat<\/th>\n      <th>oxy_umolperkg<\/th>\n      <th>btlnum<\/th>\n      <th>recind<\/th>\n      <th>t_prec<\/th>\n      <th>t_qual<\/th>\n      <th>s_prec<\/th>\n      <th>s_qual<\/th>\n      <th>p_qual<\/th>\n      <th>o_qual<\/th>\n      <th>sthtaq<\/th>\n      <th>o2satq<\/th>\n      <th>chlora<\/th>\n      <th>chlqua<\/th>\n      <th>phaeop<\/th>\n      <th>phaqua<\/th>\n      <th>po4um<\/th>\n      <th>po4q<\/th>\n      <th>sio3um<\/th>\n      <th>sio3qu<\/th>\n      <th>no2um<\/th>\n      <th>no2q<\/th>\n      <th>no3um<\/th>\n      <th>no3q<\/th>\n      <th>nh3um<\/th>\n      <th>nh3q<\/th>\n      <th>c14as1<\/th>\n      <th>c14a1p<\/th>\n      <th>c14a1q<\/th>\n      <th>c14as2<\/th>\n      <th>c14a2p<\/th>\n      <th>c14a2q<\/th>\n      <th>darkas<\/th>\n      <th>darkap<\/th>\n      <th>darkaq<\/th>\n      <th>meanas<\/th>\n      <th>meanap<\/th>\n      <th>meanaq<\/th>\n      <th>inctim<\/th>\n      <th>lightp<\/th>\n      <th>r_depth<\/th>\n      <th>r_temp<\/th>\n      <th>r_sal<\/th>\n      <th>r_dynht<\/th>\n      <th>r_nuts<\/th>\n      <th>r_oxy_umolkg<\/th>\n      <th>dic1<\/th>\n      <th>dic2<\/th>\n      <th>ta1<\/th>\n      <th>ta2<\/th>\n      <th>ph1<\/th>\n      <th>ph2<\/th>\n      <th>dic_q_comment<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,49,50,51,52,53,54,55,56,57,58,59,60,61]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"larvae_counts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-2965db3f63e62b98ffa6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2965db3f63e62b98ffa6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["5107","5107","5107","5107","5107","5107","5107","5107","5107","5107"],["PT","PT","PT","PT","PT","PT","PT","PT","PT","PT"],[15,15,15,15,15,15,15,15,15,15],["C1","C1","C1","C1","C1","C1","C1","C1","C1","C1"],[1,1,1,1,1,1,1,1,1,1],["S","S","S","S","S","S","S","S","S","S"],[924,2,851,299,955,635,1,610,486,31],[2,1,3,1,1,1,2,7,1,6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cruise<\/th>\n      <th>ship<\/th>\n      <th>orderocc<\/th>\n      <th>towtype<\/th>\n      <th>townum<\/th>\n      <th>netloc<\/th>\n      <th>spccode<\/th>\n      <th>count<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,5,7,8]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"tows"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-914af8e8137d92d98962" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-914af8e8137d92d98962">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["5111","5111","5111","5111","5111","5111","5111","5111","5111","5111"],["BD","BD","BD","BD","BD","BD","BD","BD","BD","CR"],[35,36,37,38,39,40,41,42,43,1],["C1","C1","C1","C1","C1","C1","C1","C1","C1","C1"],[1,1,1,1,1,1,1,1,1,1],["S","S","S","S","S","S","S","S","S","S"],[1.55,1.6,2.07,2.8,2.76,1.4,2.84,2.53,1.48,1.22],[354.8,342.7,273.3,491.3,508.5,381.1,502.7,533.3,373.8,284.1],[1,1,1,1,1,1,1,1,1,1],["1951-11-09T01:04:00Z","1951-11-09T07:26:00Z","1951-11-09T13:58:00Z","1951-11-09T18:36:00Z","1951-11-10T00:31:00Z","1951-11-10T11:09:00Z","1951-11-10T14:24:00Z","1951-11-10T22:06:00Z","1951-11-11T03:03:00Z","1951-10-30T18:00:00Z"],["1951-11-09","1951-11-09","1951-11-09","1951-11-09","1951-11-10","1951-11-10","1951-11-10","1951-11-10","1951-11-11","1951-10-30"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cruise<\/th>\n      <th>ship<\/th>\n      <th>orderocc<\/th>\n      <th>towtype<\/th>\n      <th>townum<\/th>\n      <th>netloc<\/th>\n      <th>shf<\/th>\n      <th>volsampled<\/th>\n      <th>percsorted<\/th>\n      <th>datetime<\/th>\n      <th>date<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,5,7,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"tows_new"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-bd2c0d39fc3651ea1d1a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bd2c0d39fc3651ea1d1a">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[12937,12938,12939,12940,12941,12942,12943,12944,12945,12946],[12938,12939,12940,12941,12942,12943,12944,12945,12946,12947],["C1","C1","C1","C1","C1","C1","C1","C1","C1","C1"],[1,1,1,1,1,1,1,1,1,1],["1959-05-16T10:46:00Z","1959-05-16T16:41:00Z","1959-05-16T19:15:00Z","1959-05-16T22:30:00Z","1959-05-17T01:30:00Z","1959-05-17T05:56:00Z","1959-05-17T08:26:00Z","1959-05-17T12:39:00Z","1959-06-10T12:41:00Z","1959-06-10T15:06:00Z"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>towid<\/th>\n      <th>stationid<\/th>\n      <th>towtype<\/th>\n      <th>townumber<\/th>\n      <th>starttime<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"tow_types"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-202f4b555a27e8bf88f0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-202f4b555a27e8bf88f0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["C2","C1","CB","MT","BT","HR","M1","M2","PV","CV"],["CalCOFI Two Meter Oblique Tow (2-m^2 mouth area 1.6-m diameter)","CalCOFI One Meter Oblique Tow (0.8 m^2 mouth area 1-m diameter) ","CalCOFI Oblique Bongo Tow (0.4 m^2 mouth area 0.71-m diameter)","Twin Winged Continuous-Flow Surface Tow","NULL","NULL","Multiple Opening Closing Nets Environmental Sensor System (1 m^2 mouth)","Multiple Opening Closing Nets Environmental Sensor System (3 m^2 mouth)","Paired Tows of CalCOFI Vertical Egg Net","CalCOFI Vertical Egg Tow (ring net with 0.25m^2 mouth)"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>code<\/th>\n      <th>description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"stations"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-65667f49fbeb24d18248" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-65667f49fbeb24d18248">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],["5101","5101","5101","5101","5101","5101","5101","5101","5101","5101"],["47","47","47","47","47","47","47","47","47","47"],[1,2,3,4,5,6,7,8,9,10],[-118.625,-118.975,-120.358333,-121.033333,-121.75,-122.4,-122.666666,-122.333333,-121.45,-120.75],[33.833333,33.666666,33,32.616666,32.366666,31.983333,32.575,33,33.233333,33.566666],[86.7,86.7,86.7,86.7,86.7,86.7,83.3,83.3,83.3,83.3],[35,40,60,70,80,90,90,80,70,60],["0101000020E61000000000000000A85DC0BBD6DEA7AAEA4040","0101000020E61000006666666666BE5DC075ADBD4F55D54040","0101000020E6100000F70489EDEE165EC00000000000804040","0101000020E61000002A38BC2022425EC00F4757E9EE4E4040","0101000020E61000000000000000705EC00F4757E9EE2E4040","0101000020E61000009A99999999995EC0DB1324B6BBFB3F40","0101000020E6100000BBD6DEA7AAAA5EC09A99999999494040","0101000020E61000005D6BEF5355955EC00000000000804040","0101000020E6100000CDCCCCCCCC5C5EC0EE0912DBDD9D4040","0101000020E61000000000000000305EC0A8E0F08288C84040"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>cruise<\/th>\n      <th>ship<\/th>\n      <th>orderocc<\/th>\n      <th>longitude<\/th>\n      <th>latitude<\/th>\n      <th>line<\/th>\n      <th>station<\/th>\n      <th>geom<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_head</span>(<span class="st">"stations_new"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-9fd9f6647f66643b0c73" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9fd9f6647f66643b0c73">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10"],[1,2,3,4,5,6,7,8,9,10],[1,1,1,1,1,1,1,1,1,1],[1,2,3,4,5,6,7,8,9,10],[33.833333,33.666666,33,32.616666,32.366666,31.983333,32.575,33,33.233333,33.566666],[-118.625,-118.975,-120.358333,-121.033333,-121.75,-122.4,-122.666666,-122.333333,-121.45,-120.75],[86.7,86.7,86.7,86.7,86.7,86.7,83.3,83.3,83.3,83.3],[35,40,60,70,80,90,90,80,70,60]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>stationid<\/th>\n      <th>cruiseid<\/th>\n      <th>orderocc<\/th>\n      <th>latitude<\/th>\n      <th>longitude<\/th>\n      <th>line<\/th>\n      <th>station<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>