<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2026-02-05">

<title>Ingest Bottle Database</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ingest_calcofi.org_bottle-database_files/libs/clipboard/clipboard.min.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-html/popper.min.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-html/anchor.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ingest_calcofi.org_bottle-database_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ingest_calcofi.org_bottle-database_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ingest_calcofi.org_bottle-database_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">
<link href="ingest_calcofi.org_bottle-database_files/libs/htmltools-fill-0.5.9/fill.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/datatables-binding-0.34.0/datatables.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="ingest_calcofi.org_bottle-database_files/libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/crosstalk-1.2.2/css/crosstalk.min.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/crosstalk-1.2.2/js/crosstalk.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/dt-ext-colreorder-1.13.6/css/colReorder.dataTables.min.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/dt-ext-colreorder-1.13.6/js/dataTables.colReorder.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/dt-ext-rowgroup-1.13.6/css/rowGroup.dataTables.min.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/dt-ext-rowgroup-1.13.6/js/dataTables.rowGroup.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/dt-ext-responsive-1.13.6/css/responsive.dataTables.min.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/dt-ext-responsive-1.13.6/js/dataTables.responsive.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/selectize-0.12.0/selectize.min.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/viz-1.8.2/viz.js"></script>
<link href="ingest_calcofi.org_bottle-database_files/libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="ingest_calcofi.org_bottle-database_files/libs/grViz-binding-1.0.11/grViz.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/jsoneditor-0.18.7/jsoneditor.min.js"></script>
<script src="ingest_calcofi.org_bottle-database_files/libs/jsonedit-binding-4.0.0/jsonedit.js"></script>


</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="1">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a></li>
  <li><a href="#check-for-any-mismatched-tables-and-fields" id="toc-check-for-any-mismatched-tables-and-fields" class="nav-link" data-scroll-target="#check-for-any-mismatched-tables-and-fields"><span class="header-section-number">2</span> Check for any mismatched tables and fields</a>
  <ul>
  <li><a href="#data-integrity-check-passed-calcofi-bottle-database" id="toc-data-integrity-check-passed-calcofi-bottle-database" class="nav-link" data-scroll-target="#data-integrity-check-passed-calcofi-bottle-database"><span class="header-section-number">2.1</span> ✅ Data Integrity Check Passed: CalCOFI Bottle Database</a>
  <ul class="collapse">
  <li><a href="#passed-with-accepted-exceptions" id="toc-passed-with-accepted-exceptions" class="nav-link" data-scroll-target="#passed-with-accepted-exceptions"><span class="header-section-number">2.1.1</span> Passed with Accepted Exceptions</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#show-source-files" id="toc-show-source-files" class="nav-link" data-scroll-target="#show-source-files"><span class="header-section-number">3</span> Show Source Files</a></li>
  <li><a href="#show-csv-tables-and-fields-to-ingest" id="toc-show-csv-tables-and-fields-to-ingest" class="nav-link" data-scroll-target="#show-csv-tables-and-fields-to-ingest"><span class="header-section-number">4</span> Show CSV Tables and Fields to Ingest</a></li>
  <li><a href="#show-tables-and-fields-redefined" id="toc-show-tables-and-fields-redefined" class="nav-link" data-scroll-target="#show-tables-and-fields-redefined"><span class="header-section-number">5</span> Show tables and fields redefined</a></li>
  <li><a href="#load-tables-into-database" id="toc-load-tables-into-database" class="nav-link" data-scroll-target="#load-tables-into-database"><span class="header-section-number">6</span> Load Tables into Database</a></li>
  <li><a href="#apply-ship-corrections" id="toc-apply-ship-corrections" class="nav-link" data-scroll-target="#apply-ship-corrections"><span class="header-section-number">7</span> Apply Ship Corrections</a></li>
  <li><a href="#column-naming-rationale" id="toc-column-naming-rationale" class="nav-link" data-scroll-target="#column-naming-rationale"><span class="header-section-number">8</span> Column Naming Rationale</a>
  <ul>
  <li><a href="#ambiguous-column-pairs" id="toc-ambiguous-column-pairs" class="nav-link" data-scroll-target="#ambiguous-column-pairs"><span class="header-section-number">8.1</span> Ambiguous column pairs</a></li>
  <li><a href="#r_-reported-pre-qc-values" id="toc-r_-reported-pre-qc-values" class="nav-link" data-scroll-target="#r_-reported-pre-qc-values"><span class="header-section-number">8.2</span> <code>R_*</code> = “Reported” (pre-QC) values</a></li>
  </ul></li>
  <li><a href="#consolidate-casts-columns" id="toc-consolidate-casts-columns" class="nav-link" data-scroll-target="#consolidate-casts-columns"><span class="header-section-number">9</span> Consolidate Casts Columns</a></li>
  <li><a href="#pivot-bottle-measurements" id="toc-pivot-bottle-measurements" class="nav-link" data-scroll-target="#pivot-bottle-measurements"><span class="header-section-number">10</span> Pivot Bottle Measurements</a></li>
  <li><a href="#pivot-cast-conditions" id="toc-pivot-cast-conditions" class="nav-link" data-scroll-target="#pivot-cast-conditions"><span class="header-section-number">11</span> Pivot Cast Conditions</a></li>
  <li><a href="#load-measurement-type-reference" id="toc-load-measurement-type-reference" class="nav-link" data-scroll-target="#load-measurement-type-reference"><span class="header-section-number">12</span> Load Measurement Type Reference</a>
  <ul>
  <li><a href="#measurement_type-vs-lookup" id="toc-measurement_type-vs-lookup" class="nav-link" data-scroll-target="#measurement_type-vs-lookup"><span class="header-section-number">12.1</span> <code>measurement_type</code> vs <code>lookup</code></a></li>
  </ul></li>
  <li><a href="#verify-primary-keys" id="toc-verify-primary-keys" class="nav-link" data-scroll-target="#verify-primary-keys"><span class="header-section-number">13</span> Verify Primary Keys</a></li>
  <li><a href="#schema-documentation" id="toc-schema-documentation" class="nav-link" data-scroll-target="#schema-documentation"><span class="header-section-number">14</span> Schema Documentation</a>
  <ul>
  <li><a href="#primary-key-strategy" id="toc-primary-key-strategy" class="nav-link" data-scroll-target="#primary-key-strategy"><span class="header-section-number">14.1</span> Primary Key Strategy</a></li>
  <li><a href="#foreign-key-relationships" id="toc-foreign-key-relationships" class="nav-link" data-scroll-target="#foreign-key-relationships"><span class="header-section-number">14.2</span> Foreign Key Relationships</a></li>
  </ul></li>
  <li><a href="#add-spatial" id="toc-add-spatial" class="nav-link" data-scroll-target="#add-spatial"><span class="header-section-number">15</span> Add Spatial</a>
  <ul>
  <li><a href="#add-casts.geom" id="toc-add-casts.geom" class="nav-link" data-scroll-target="#add-casts.geom"><span class="header-section-number">15.1</span> Add <code>casts.geom</code></a></li>
  <li><a href="#load-grid-table" id="toc-load-grid-table" class="nav-link" data-scroll-target="#load-grid-table"><span class="header-section-number">15.2</span> Load <code>grid</code> table</a></li>
  <li><a href="#update-casts.grid_key" id="toc-update-casts.grid_key" class="nav-link" data-scroll-target="#update-casts.grid_key"><span class="header-section-number">15.3</span> Update <code>casts.grid_key</code></a></li>
  <li><a href="#create-casts_derived-view" id="toc-create-casts_derived-view" class="nav-link" data-scroll-target="#create-casts_derived-view"><span class="header-section-number">15.4</span> Create <code>casts_derived</code> VIEW</a></li>
  <li><a href="#map-cast-locations" id="toc-map-cast-locations" class="nav-link" data-scroll-target="#map-cast-locations"><span class="header-section-number">15.5</span> Map Cast Locations</a></li>
  </ul></li>
  <li><a href="#report" id="toc-report" class="nav-link" data-scroll-target="#report"><span class="header-section-number">16</span> Report</a></li>
  <li><a href="#validate-local-database" id="toc-validate-local-database" class="nav-link" data-scroll-target="#validate-local-database"><span class="header-section-number">17</span> Validate Local Database</a></li>
  <li><a href="#enforce-column-types" id="toc-enforce-column-types" class="nav-link" data-scroll-target="#enforce-column-types"><span class="header-section-number">18</span> Enforce Column Types</a></li>
  <li><a href="#data-preview" id="toc-data-preview" class="nav-link" data-scroll-target="#data-preview"><span class="header-section-number">19</span> Data Preview</a>
  <ul>
  <li><a href="#casts-35644-rows" id="toc-casts-35644-rows" class="nav-link" data-scroll-target="#casts-35644-rows"><span class="header-section-number">19.1</span> <code>casts</code> (35,644 rows)</a></li>
  <li><a href="#bottle-895371-rows" id="toc-bottle-895371-rows" class="nav-link" data-scroll-target="#bottle-895371-rows"><span class="header-section-number">19.2</span> <code>bottle</code> (895,371 rows)</a></li>
  <li><a href="#bottle_measurement-11135600-rows" id="toc-bottle_measurement-11135600-rows" class="nav-link" data-scroll-target="#bottle_measurement-11135600-rows"><span class="header-section-number">19.3</span> <code>bottle_measurement</code> (11,135,600 rows)</a></li>
  <li><a href="#cast_condition-235513-rows" id="toc-cast_condition-235513-rows" class="nav-link" data-scroll-target="#cast_condition-235513-rows"><span class="header-section-number">19.4</span> <code>cast_condition</code> (235,513 rows)</a></li>
  <li><a href="#measurement_type-47-rows" id="toc-measurement_type-47-rows" class="nav-link" data-scroll-target="#measurement_type-47-rows"><span class="header-section-number">19.5</span> <code>measurement_type</code> (47 rows)</a></li>
  </ul></li>
  <li><a href="#write-parquet-outputs" id="toc-write-parquet-outputs" class="nav-link" data-scroll-target="#write-parquet-outputs"><span class="header-section-number">20</span> Write Parquet Outputs</a></li>
  <li><a href="#write-metadata" id="toc-write-metadata" class="nav-link" data-scroll-target="#write-metadata"><span class="header-section-number">21</span> Write Metadata</a></li>
  <li><a href="#upload-to-gcs-archive" id="toc-upload-to-gcs-archive" class="nav-link" data-scroll-target="#upload-to-gcs-archive"><span class="header-section-number">22</span> Upload to GCS Archive</a></li>
  <li><a href="#cleanup" id="toc-cleanup" class="nav-link" data-scroll-target="#cleanup"><span class="header-section-number">23</span> Cleanup</a></li>
  <li><a href="#todo" id="toc-todo" class="nav-link" data-scroll-target="#todo"><span class="header-section-number">24</span> TODO</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Ingest Bottle Database</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">2026-02-05</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p><strong>Source</strong>: <a href="https://calcofi.org/data/oceanographic-data/bottle-database/">Bottle Database | CalCOFI.org</a></p>
<ul>
<li>Download: <a href="https://calcofi.org/downloads/database/CalCOFI_Database_194903-202105_csv_16October2023.zip" class="uri">https://calcofi.org/downloads/database/CalCOFI_Database_194903-202105_csv_16October2023.zip</a></li>
</ul>
<p><strong>Goal</strong>: Ingest bottle database from source CSV files into a local wrangling DuckDB, then export as parquet files for downstream use.</p>
<p><strong>Two source tables</strong>:</p>
<ul>
<li><code>194903-202105_Cast.csv</code> (61 fields) — station-level: cruise, location, meteorology, integrated measurements</li>
<li><code>194903-202105_Bottle.csv</code> (62 fields) — sample-level: depth, temperature, salinity, O₂, nutrients, pigments, C14, pH</li>
</ul>
<p><strong>Coverage</strong>: 1949-03 to 2021-05 (72 years)</p>
<p><strong>Join key</strong>: <code>cast_id</code> (in both tables; source column <code>Cst_Cnt</code>)</p>
<p>This workflow processes CalCOFI bottle database CSV files and outputs parquet files. The workflow:</p>
<ol type="1">
<li>Reads CSV files from source directory (with GCS archive sync)</li>
<li>Loads into local wrangling DuckDB with column renames</li>
<li>Applies ship name/code corrections</li>
<li>Consolidates temporal columns into <code>datetime_utc</code>, drops derivable columns, creates <code>casts_derived</code> VIEW</li>
<li>Pivots bottle measurements into long-format <code>bottle_measurement</code> table</li>
<li>Pivots cast environmental conditions into <code>cast_condition</code> table</li>
<li>Loads <code>measurement_type</code> reference table</li>
<li>Validates primary keys and foreign key integrity</li>
<li>Adds spatial geometry and grid assignments</li>
<li>Exports to parquet files (for later integration into Working DuckLake)</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_local(here::here("../calcofi4db"), force = T)</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"../calcofi4db"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"../calcofi4r"</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  CalCOFI<span class="sc">/</span>calcofi4db,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  CalCOFI<span class="sc">/</span>calcofi4r,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  DBI, dm, dplyr, DT, fs, glue, gargle, googledrive, here, htmltools,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  janitor, jsonlite, knitr, listviewer, litedown, lubridate, mapview,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  purrr, readr, rlang, sf, stringr, tibble, tidyr, units, webshot2,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">quiet =</span> T)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">readr.show_col_types =</span> F)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">DT.options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># define paths</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>provider     <span class="ot">&lt;-</span> <span class="st">"calcofi.org"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>dataset      <span class="ot">&lt;-</span> <span class="st">"bottle-database"</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>dataset_name <span class="ot">&lt;-</span> <span class="st">"CalCOFI Bottle Database"</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>dir_data     <span class="ot">&lt;-</span> <span class="st">"~/My Drive/projects/calcofi/data-public"</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>subdir       <span class="ot">&lt;-</span> <span class="st">"CalCOFI_Database_194903-202105_csv_16October2023"</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>overwrite    <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>dir_parquet  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="fu">glue</span>(<span class="st">"data/parquet/{provider}_{dataset}"</span>))</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>db_path      <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="fu">glue</span>(<span class="st">"data/wrangling/{provider}_{dataset}.duckdb"</span>))</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (overwrite){</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file_exists</span>(db_path)) <span class="fu">file_delete</span>(db_path)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dir_exists</span>(dir_parquet)) <span class="fu">dir_delete</span>(dir_parquet)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">dir_create</span>(<span class="fu">dirname</span>(db_path))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">get_duckdb_con</span>(db_path)</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="fu">load_duckdb_extension</span>(con, <span class="st">"spatial"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="co"># load data using calcofi4db package</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="co"># - reads from local Google Drive mount</span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># - syncs to GCS archive if files changed (creates new timestamped archive)</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># - tracks GCS archive path for provenance</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>dir_dataset <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{dir_data}/{provider}/{dataset}"</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv_files</span>(</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">provider           =</span> provider,</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset            =</span> dataset,</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">subdir             =</span> subdir,</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir_data           =</span> dir_data,</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">sync_archive       =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">metadata_dir       =</span> <span class="fu">here</span>(<span class="st">"metadata"</span>),</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">field_descriptions =</span> <span class="fu">list</span>(</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="st">"194903-202105_Cast"</span>   <span class="ot">=</span> <span class="fu">glue</span>(</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{dir_dataset}/Cast Field Descriptions.csv"</span>),</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">"194903-202105_Bottle"</span> <span class="ot">=</span> <span class="fu">glue</span>(</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{dir_dataset}/Bottle Field Descriptions - UTF-8.csv"</span>)))</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a><span class="co"># show source files summary</span></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Loaded {nrow(d$source_files)} tables from {d$paths$dir_csv}"</span>))</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total rows: {sum(d$source_files$nrow)}"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="check-for-any-mismatched-tables-and-fields" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="check-for-any-mismatched-tables-and-fields"><span class="header-section-number">2</span> Check for any mismatched tables and fields</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check data integrity</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># type_exceptions = "all": type mismatches (34) are expected since readr</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># infers types differently (e.g. quality codes as numeric, Time as hms);</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># these are resolved during ingestion via flds_redefine.csv type_new</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>integrity <span class="ot">&lt;-</span> <span class="fu">check_data_integrity</span>(</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">d               =</span> d,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name    =</span> dataset_name,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">type_exceptions =</span> <span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<section id="data-integrity-check-passed-calcofi-bottle-database" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="data-integrity-check-passed-calcofi-bottle-database"><span class="header-section-number">2.1</span> ✅ Data Integrity Check Passed: CalCOFI Bottle Database</h3>
<section id="passed-with-accepted-exceptions" class="level4" data-number="2.1.1">
<h4 data-number="2.1.1" class="anchored" data-anchor-id="passed-with-accepted-exceptions"><span class="header-section-number">2.1.1</span> Passed with Accepted Exceptions</h4>
<p>34 type mismatch(es) were found but accepted as known exceptions (e.g., readr infers types differently from redefinition metadata; resolved during ingestion via <code>flds_redefine.csv</code> <code>type_new</code> column).</p>
<hr>
</section>
</section>
</section>
<section id="show-source-files" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="show-source-files"><span class="header-section-number">3</span> Show Source Files</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_source_files</span>(d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-3e8bead3502e1b2cd1ea" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3e8bead3502e1b2cd1ea">{"x":{"filter":"none","vertical":false,"caption":"<caption>Source CSV files with local and GCS paths for provenance.<\/caption>","data":[["194903-202105_Bottle","194903-202105_Cast"],[895371,35644],[62,61],[171307.3,12232],["2023-10-16 14:46","2023-10-16 14:37"],["194903-202105_Bottle.csv","194903-202105_Cast.csv"],["<a href='https://storage.googleapis.com/calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv' target='_blank'>194903-202105_Bottle.csv<\/a>","<a href='https://storage.googleapis.com/calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv' target='_blank'>194903-202105_Cast.csv<\/a>"],["/Users/bbest/My Drive/projects/calcofi/data-public/calcofi.org/bottle-database/CalCOFI_Database_194903-202105_csv_16October2023/194903-202105_Bottle.csv","/Users/bbest/My Drive/projects/calcofi/data-public/calcofi.org/bottle-database/CalCOFI_Database_194903-202105_csv_16October2023/194903-202105_Cast.csv"],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>table<\/th>\n      <th>rows<\/th>\n      <th>cols<\/th>\n      <th>file_size_kb<\/th>\n      <th>last_mod<\/th>\n      <th>local_file<\/th>\n      <th>gcs_file<\/th>\n      <th>local_path<\/th>\n      <th>gcs_path<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"pageLength":20,"columnDefs":[{"targets":[7,8],"visible":false},{"className":"dt-right","targets":[1,2,3]},{"name":"table","targets":0},{"name":"rows","targets":1},{"name":"cols","targets":2},{"name":"file_size_kb","targets":3},{"name":"last_mod","targets":4},{"name":"local_file","targets":5},{"name":"gcs_file","targets":6},{"name":"local_path","targets":7},{"name":"gcs_path","targets":8}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,20,25,50,100]},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="show-csv-tables-and-fields-to-ingest" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="show-csv-tables-and-fields-to-ingest"><span class="header-section-number">4</span> Show CSV Tables and Fields to Ingest</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>d_csv<span class="sc">$</span>tables <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Tables to ingest."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-ec37c89e978a7bfe54ff" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ec37c89e978a7bfe54ff">{"x":{"filter":"none","vertical":false,"caption":"<caption>Tables to ingest.<\/caption>","data":[["1","2"],["194903-202105_Bottle","194903-202105_Cast"],[895371,35644],[62,61]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>tbl<\/th>\n      <th>nrow<\/th>\n      <th>ncol<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"tbl","targets":1},{"name":"nrow","targets":2},{"name":"ncol","targets":3}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>d_csv<span class="sc">$</span>fields <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Fields to ingest."</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-f4cffa43cae9f17b5654" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f4cffa43cae9f17b5654">{"x":{"filter":"none","vertical":false,"caption":"<caption>Fields to ingest.<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123"],["194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Bottle","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast","194903-202105_Cast"],["Cst_Cnt","Btl_Cnt","Sta_ID","Depth_ID","Depthm","T_degC","Salnty","O2ml_L","STheta","O2Sat","Oxy_µmol/Kg","BtlNum","RecInd","T_prec","T_qual","S_prec","S_qual","P_qual","O_qual","SThtaq","O2Satq","ChlorA","Chlqua","Phaeop","Phaqua","PO4uM","PO4q","SiO3uM","SiO3qu","NO2uM","NO2q","NO3uM","NO3q","NH3uM","NH3q","C14As1","C14A1p","C14A1q","C14As2","C14A2p","C14A2q","DarkAs","DarkAp","DarkAq","MeanAs","MeanAp","MeanAq","IncTim","LightP","R_Depth","R_TEMP","R_Sal","R_DYNHT","R_Nuts","R_Oxy_µmol/Kg","DIC1","DIC2","TA1","TA2","pH1","pH2","DIC Quality Comment","Cst_Cnt","Cruise_ID","Cruise","Cruz_Sta","DbSta_ID","Cast_ID","Sta_ID","Quarter","Sta_Code","Distance","Date","Year","Month","Julian_Date","Julian_Day","Time","Lat_Dec","Lat_Deg","Lat_Min","Lat_Hem","Lon_Dec","Lon_Deg","Lon_Min","Lon_Hem","Rpt_Line","St_Line","Ac_Line","Rpt_Sta","St_Station","Ac_Sta","Bottom_D","Secchi","ForelU","Ship_Name","Ship_Code","Data_Type","Order_Occ","Event_Num","Cruz_Leg","Orig_Sta_ID","Data_Or","Cruz_Num","IntChl","IntC14","Inc_Str","Inc_End","PST_LAN","Civil_T","TimeZone","Wave_Dir","Wave_Ht","Wave_Prd","Wind_Dir","Wind_Spd","Barometer","Dry_T","Wet_T","Wea","Cloud_Typ","Cloud_Amt","Visibility"],["numeric","numeric","character","character","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","hms","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","logical","numeric","logical","logical","logical","logical","numeric","character","numeric","numeric","character","character","character","numeric","character","numeric","character","numeric","numeric","numeric","numeric","hms","numeric","numeric","numeric","character","numeric","numeric","numeric","character","character","numeric","numeric","character","numeric","numeric","numeric","numeric","numeric","character","character","character","numeric","numeric","numeric","character","character","character","numeric","numeric","hms","hms","hms","hms","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric","numeric"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>tbl<\/th>\n      <th>fld<\/th>\n      <th>type<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"tbl","targets":1},{"name":"fld","targets":2},{"name":"type","targets":3}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="show-tables-and-fields-redefined" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="show-tables-and-fields-redefined"><span class="header-section-number">5</span> Show tables and fields redefined</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_tables_redefine</span>(d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7e808f89a55378940d7e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7e808f89a55378940d7e">{"x":{"filter":"none","vertical":false,"caption":"<caption>Tables to redefine.<\/caption>","data":[["1","2"],["194903-202105_Bottle","194903-202105_Cast"],["bottle","casts"],["water sample measurements at specific depths from CalCOFI bottle casts (1949-2021)","station-level cast metadata including location, meteorological observations, and integrated measurements"],[false,false]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>tbl_old<\/th>\n      <th>tbl_new<\/th>\n      <th>tbl_description<\/th>\n      <th>is_equal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"targets":4,"visible":false},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"tbl_old","targets":1},{"name":"tbl_new","targets":2},{"name":"tbl_description","targets":3},{"name":"is_equal","targets":4}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 2).node()).css({'background-color':value == true ? \"lightgray\" : value == false ? \"lightgreen\" : null});\n}"},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show_fields_redefine</span>(d)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-d76d900f0f1ee7e1a8e9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d76d900f0f1ee7e1a8e9">{"x":{"filter":"none","vertical":false,"extensions":["ColReorder","RowGroup","Responsive"],"caption":"<caption>Fields to redefine.<\/caption>","data":[["194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Cast → casts","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle","194903-202105_Bottle → bottle"],["Cst_Cnt → cast_id","Cruise_ID → cruise_key","Cruise → cruise","Cruz_Sta → cruz_sta","DbSta_ID → db_sta_key","Cast_ID → cast_key","Sta_ID → sta_key","Quarter → quarter","Sta_Code → sta_code","Distance → distance","Date → date","Year → year","Month → month","Julian_Date → julian_date","Julian_Day → julian_day","Time → time","Lat_Dec → lat_dec","Lat_Deg → lat_deg","Lat_Min → lat_min","Lat_Hem → lat_hem","Lon_Dec → lon_dec","Lon_Deg → lon_deg","Lon_Min → lon_min","Lon_Hem → lon_hem","Rpt_Line → rpt_line","St_Line → st_line","Ac_Line → ac_line","Rpt_Sta → rpt_sta","St_Station → st_station","Ac_Sta → ac_sta","Bottom_D → bottom_depth_m","Ship_Name → ship_name","Ship_Code → ship_code","Data_Type → data_type","Order_Occ → order_occ","Event_Num → event_num","Cruz_Leg → cruz_leg","Orig_Sta_ID → orig_sta_id","Data_Or → data_or","Cruz_Num → cruz_num","IntChl → int_chl","IntC14 → int_c14","Inc_Str → inc_str","Inc_End → inc_end","PST_LAN → pst_lan","Civil_T → civil_t","TimeZone → time_zone","Wave_Dir → wave_dir","Wave_Ht → wave_ht","Wave_Prd → wave_prd","Wind_Dir → wind_dir","Wind_Spd → wind_spd","Barometer → barometer","Dry_T → dry_t","Wet_T → wet_t","Wea → wea","Cloud_Typ → cloud_typ","Cloud_Amt → cloud_amt","Visibility → visibility","Secchi → secchi","ForelU → forel_u","Cst_Cnt → cast_id","Btl_Cnt → bottle_id","Sta_ID → sta_key","Depth_ID → depth_key","Depthm → depth_m","T_degC → t_deg_c","Salnty → salnty","O2ml_L → o2ml_l","STheta → s_theta","O2Sat → o2sat","Oxy_µmol/Kg → oxy_umol_kg","BtlNum → btl_num","RecInd → rec_ind","T_prec → t_prec","T_qual → t_qual","S_prec → s_prec","S_qual → s_qual","P_qual → p_qual","O_qual → o_qual","SThtaq → s_thtaq","O2Satq → o2satq","ChlorA → chlor_a","Chlqua → chlqua","Phaeop → phaeop","Phaqua → phaqua","PO4uM → po4u_m","PO4q → po4q","SiO3uM → si_o3u_m","SiO3qu → si_o3qu","NO2uM → no2u_m","NO2q → no2q","NO3uM → no3u_m","NO3q → no3q","NH3uM → nh3u_m","NH3q → nh3q","C14As1 → c14as1","C14A1p → c14a1p","C14A1q → c14a1q","C14As2 → c14as2","C14A2p → c14a2p","C14A2q → c14a2q","DarkAs → dark_as","DarkAp → dark_ap","DarkAq → darkaq","MeanAs → mean_as","MeanAp → mean_ap","MeanAq → mean_aq","IncTim → inc_tim","LightP → light_p","R_Depth → r_depth","R_TEMP → r_temp","R_Sal → r_sal","R_DYNHT → r_dynht","R_Nuts → r_nuts","R_Oxy_µmol/Kg → r_oxy_umol_kg","DIC1 → dic1","DIC2 → dic2","TA1 → ta1","TA2 → ta2","pH1 → p_h1","pH2 → p_h2","DIC Quality Comment → dic_quality_comment"],["numeric → integer","character → varchar","character → varchar","character → varchar","character → varchar","character → varchar","character → varchar","numeric → smallint","character → varchar","numeric → decimal","character → date","numeric → smallint","numeric → smallint","numeric → decimal","numeric → smallint","character → varchar","numeric → decimal","numeric → smallint","numeric → decimal","character → varchar","numeric → decimal","numeric → smallint","numeric → decimal","character → varchar","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","character → varchar","character → varchar","character → varchar","numeric → smallint","numeric → smallint","character → varchar","character → varchar","character → varchar","character → varchar","numeric → decimal","numeric → decimal","character → varchar","character → varchar","character → varchar","character → varchar","numeric → smallint","numeric → smallint","numeric → decimal","numeric → smallint","numeric → smallint","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → smallint","numeric → smallint","numeric → smallint","numeric → smallint","numeric → decimal","numeric → smallint","numeric → integer","numeric → integer","character → varchar","character → varchar","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → smallint","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","character → varchar","character → varchar","character → varchar","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","numeric → decimal","character → varchar","numeric → decimal","numeric → decimal","character → varchar","numeric → decimal","numeric → decimal","character → varchar","numeric → decimal","numeric → decimal","character → varchar","numeric → decimal","numeric → decimal","character → varchar","character → varchar","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","numeric → decimal","character → varchar"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62],["Cast Count - All CalCOFI casts ever conducted, consecutively numbered","Cruise identifier [Year]-[Month]-[Day]-C-[Ship Code]","Cruise Name [Year][Month]","Cruise Name and Station [Year][Month][Line][Station]","Line and Station","Cast Identifier [Century] - [YY][MM][ShipCode] - [CastType][Julian Day] - [CastTime]-[Line][Sta]","Line and Station","Quarter of the year","Station Designation (See Station_ID and 0-St_Code for codes)","Nautical miles from coast intercept, calculated from estimated latitude and longitude","Date (Month Day Year)","Year","Month","OA Date: days since December 30, 1899","Julian Day of the year","Time (UTC) CTD reached terminal depth","Observed Latitude in decimal degrees","Observed Latitude in degrees","Observed Latitude in minutes","Observed Latitude Hemisphere","Observed Longitude in decimal degrees","Observed Longitude in degrees","Observed Longitude in minutes","Observed Longitude Hemisphere","Reported Line Number","Nearest Standard Line","Calculated actual line from observed latitude and longitude","Reported Station Number","Nearest Standard Station Number","Calculated actual station from observed lat and long","Bottom depth in meters","Ship's Name","Ship's NODC Code","Data Type","Order station was occupied (within each cruise)","Event number; includes all research operations within each cruise (e.g. nets, CTD)","Leg of cruise, if multiple legs","IEH Reported Station ID","Data Origin","Cruise Designation (Year Month)","Integrated Chlorophyll per half light day","Integrated Primary Productivity per half light day","Incubation Start Time (PST)","Incubation End Time (PST)","Time of Local Apparent Noon (PST)","Time of Civil Twilight (PST)","Time Zone","Wave Direction reported using an abbreviated 360 degree azimuth circle with 00 representing True North, 18 represents 180 degrees","Wave Height in feet","Wave Period in seconds","Wind Direction reported using an abbreviated 360 degree azimuth circle with 0 representing True North, 18 representing 180 degrees","Wind Speed in knots","Millibars to the tenths","Dry Air Temperature from a Sling Psychrometer in degrees Celsius","Wet Air Temperature from a Sling Psychrometer in degrees Celsius","1 Digit Code from The World Meteorological Organization, Code source WMO 4501","1 Digit Code from The World Meteorological Organization, Code source WMO 0500","1 Digit Code from The World Meteorological Organization, Code source WMO 2700, in oktas","1 Digit Code from The World Meteorological Organization, Code source WMO 4300","Secchi disk depth in meters","Water color; Only used in CalCOFI dataset from 1988-10 through 1998-04","Cast Count - All CalCOFI casts ever conducted, consecutively numbered","Bottle Count - All CalCOFI bottles ever sampled, consecutively numbered","Line and Station [Line] [Station]","Uses the Cast_ID prefix but adds three additional variables: [Depth][Bottle]-[Rec_Ind]","Bottle depth in meters","Water temperature in degrees Celsius","Salinity (Practical Salinity Scale 1978)","Milliliters oxygen per liter of seawater","Potential Density (Sigma Theta), Kg/M3","Oxygen percent saturation","Oxygen micromoles per kilogram seawater","Niskin bottle sample was collected from","Record Indicator (quality code that applies to the whole bottle, instead of just to a specific parameter)","Temperature Precision","Quality Code","Salinity Precision","Quality Code","Quality Code","Quality Code","Quality Code","Quality Code","Micrograms Chlorophyll-a per liter seawater, measured fluorometrically","Quality Code","Micrograms Phaeopigment per liter seawater, measured fluorometrically","Quality Code","Micromoles Phosphate per liter of seawater","Quality Code","Micromoles Silicate per liter of seawater","Quality Code","Micromoles Nitrite per liter of seawater","Quality Code","Micromoles Nitrate per liter of seawater","Quality Code","Micromoles Ammonia per liter of seawater","Quality Code","14C Assimilation of Replicate 1 (milligrams carbon per cubic meter of seawater per half light day)","Precision of 14C Assimilation of Replicate 1","Quality Code","14C Assimilation of Replicate 2 (milligrams carbon per cubic meter of seawater per half light day)","Precision of 14C Assimilation of Replicate 2","Quality Code","14C Assimilation of Dark/Control Bottle (milligrams carbon per cubic meter of seawater per half light day)","Precision of 14C Assimilation of Dark/Control Bottle","Quality Code","Mean 14C Assimilation of Replicates 1 and 2 (milligrams carbon per cubic meter of seawater per half light day)","Precision of Mean 14C Assimilation of Replicates 1 and 2","Quality Code","Elapsed incubation time of the primary productivity experiment","Light intensities of the incubation tubes in the primary productivity experiment, expressed as percentages","Reported Depth (from pressure) in meters","Reported (Potential) Temperature in degrees Celsius","Reported Salinity (from Specific Volume Anomaly, M3/Kg)","Reported Dynamic Height in units of dynamic meters (work per unit mass)","Reported Ammonium concentration","Reported Oxygen micromoles/kilogram","Dissolved Inorganic Carbon micromoles per kilogram solution","Dissolved Inorganic Carbon micromoles per kilogram solution (on a replicate sample)","Total Alkalinity micromoles per kilogram solution","Total Alkalinity micromoles per kilogram solution (on a replicate sample)","pH (the degree of acidity/alkalinity of a solution)","pH (the degree of acidity/alkalinity of a solution) on a replicate sample","Quality Comment"],[null,null,null,null,null,null,null,null,null,"nautical miles",null,null,null,null,null,null,"decimal degrees","degrees","minutes",null,"decimal degrees","degrees","minutes",null,null,null,null,null,null,null,"meters",null,null,null,null,null,null,null,null,null,"milligrams chl per square meter per half light day","milligrams C per square meter per half light day",null,null,null,null,null,"degrees","feet","seconds","degrees","knots","millibars","degrees Celsius","degrees Celsius",null,null,null,null,"meters","Forel-Ule Scale",null,null,null,null,"meters","degrees Celsius","Practical Salinity Scale","milliliters per liter","kilograms per cubic meter","percent saturation","micromoles per kilogram",null,null,null,null,null,null,null,null,null,null,"micrograms per liter",null,"micrograms per liter",null,"micromoles per liter",null,"micromoles per liter",null,"micromoles per liter",null,"micromoles per liter",null,"micromoles per liter",null,"milligrams C per cubic meter per half light day",null,null,"milligrams C per cubic meter per half light day",null,null,"milligrams C per cubic meter per half light day",null,null,"milligrams C per cubic meter per half light day",null,null,null,"percent","meters","degrees Celsius","Specific Volume Anomaly","dynamic meters","micromoles per liter","micromoles per kilogram","micromoles per kilogram","micromoles per kilogram","micromoles per kilogram","micromoles per kilogram","pH scale","pH scale",null],["*_id convention: sequential integer PK (values: 1 2 3...)","*_key convention: varchar identifier (e.g. 1949-03-01-C-31CR)",null,null,"*_key convention: varchar compact Line+Station (e.g. 05400560); same info as sta_key in different format","*_key convention: varchar composite key (e.g. 19-4903CR-HY-060-0930-05400560); renamed from cast_id to avoid conflict with Cst_Cnt-&gt;cast_id","*_key convention: varchar Line and Station (e.g. 054.0 056.0)",null,null,null,"parse M/D/Y format",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"*_id convention: integer FK to casts.cast_id","*_id convention: sequential integer PK (values: 1 2 3...)","*_key convention: varchar Line and Station (e.g. 054.0 056.0)","*_key convention: varchar extends cast_key with depth suffix (e.g. 19-4903CR-...-0000A-3)","unit suffix convention: depth in meters",null,null,null,null,null,"fix: source is Oxy_µmol/Kg (micromoles) not millimoles",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"R_* = reported value from instrument before QC; cf. depth_m (QC'd)","R_* = reported potential temperature before QC; cf. t_deg_c (QC'd)","R_* = reported Specific Volume Anomaly (values ~233 units 10^-8 m^3/kg); WARNING: different parameter/scale than salnty (PSS-78 values ~33.44)","R_* = reported dynamic height; no QC'd counterpart in dataset","R_* = reported ammonium concentration; cf. nh3u_m (QC'd)","fix: source is R_Oxy_µmol/Kg (micromoles) not millimoles; R_* = reported/pre-QC value",null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,"as.Date(date, format = \"%m/%d/%Y\")",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>tbl<\/th>\n      <th>fld<\/th>\n      <th>type<\/th>\n      <th>order<\/th>\n      <th>fld_description<\/th>\n      <th>units<\/th>\n      <th>notes<\/th>\n      <th>mutation<\/th>\n      <th>tbl_is_equal<\/th>\n      <th>fld_is_equal<\/th>\n      <th>type_is_equal<\/th>\n      <th>order_is_equal<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"colReorder":true,"rowGroup":{"dataSrc":0},"pageLength":50,"columnDefs":[{"targets":[0,8,9,10,11],"visible":false},{"className":"dt-right","targets":3},{"name":"tbl","targets":0},{"name":"fld","targets":1},{"name":"type","targets":2},{"name":"order","targets":3},{"name":"fld_description","targets":4},{"name":"units","targets":5},{"name":"notes","targets":6},{"name":"mutation","targets":7},{"name":"tbl_is_equal","targets":8},{"name":"fld_is_equal","targets":9},{"name":"type_is_equal","targets":10},{"name":"order_is_equal","targets":11}],"order":[],"autoWidth":false,"orderClasses":false,"responsive":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[9]; $(this.api().cell(row, 1).node()).css({'background-color':value == true ? \"lightgray\" : value == false ? \"lightgreen\" : null});\nvar value=data[10]; $(this.api().cell(row, 2).node()).css({'background-color':value == true ? \"lightgray\" : value == false ? \"lightgreen\" : null});\nvar value=data[11]; $(this.api().cell(row, 3).node()).css({'background-color':value == true ? \"lightgray\" : value == false ? \"lightgreen\" : null});\n}"},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="load-tables-into-database" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="load-tables-into-database"><span class="header-section-number">6</span> Load Tables into Database</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use ingest_dataset() which handles:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># - transform_data() for applying redefinitions</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - provenance tracking via gcs_path from read_csv_files()</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># - ingest_to_working() for each table</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>tbl_stats <span class="ot">&lt;-</span> <span class="fu">ingest_dataset</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">con     =</span> con,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">d       =</span> d,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode    =</span> <span class="cf">if</span> (overwrite) <span class="st">"replace"</span> <span class="cf">else</span> <span class="st">"append"</span>,</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>tbl_stats <span class="sc">|&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">rownames =</span> <span class="cn">FALSE</span>, <span class="at">filter =</span> <span class="st">"top"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-9ee2b0f892bb844d1bf5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9ee2b0f892bb844d1bf5">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35644\" data-max=\"895371\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35644\" data-max=\"895371\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1770323326539.41\" data-max=\"1770323328248.45\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["194903-202105_Bottle","194903-202105_Cast"],["bottle","casts"],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv"],[895371,35644],[895371,35644],["2026-02-05T20:28:46Z","2026-02-05T20:28:48Z"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>tbl<\/th>\n      <th>tbl_new<\/th>\n      <th>gcs_path<\/th>\n      <th>rows_input<\/th>\n      <th>rows_after<\/th>\n      <th>ingested_at<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[3,4]},{"name":"tbl","targets":0},{"name":"tbl_new","targets":1},{"name":"gcs_path","targets":2},{"name":"rows_input","targets":3},{"name":"rows_after","targets":4},{"name":"ingested_at","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="apply-ship-corrections" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="apply-ship-corrections"><span class="header-section-number">7</span> Apply Ship Corrections</h2>
<p>Apply known ship name/code corrections from <code>ship_renames.csv</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>ship_renames_csv <span class="ot">&lt;-</span> <span class="fu">here</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"metadata/calcofi.org/bottle-database/ship_renames.csv"</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>d_ship_renames <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(ship_renames_csv)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># apply each correction</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>n_updated_total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(d_ship_renames))) {</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  old_name <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_name[i]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  old_code <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_code[i]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  new_name <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_name_new[i]</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  new_code <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_code_new[i]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update where both name and code match old values</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  n_updated <span class="ot">&lt;-</span> <span class="fu">dbExecute</span>(con, <span class="fu">glue_sql</span>(</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"UPDATE casts</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="st">     SET ship_name = {new_name}, ship_code = {new_code}</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="st">     WHERE ship_name = {old_name} AND ship_code = {old_code}"</span>,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">.con =</span> con))</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_updated <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Updated {n_updated} casts: "</span>,</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>      <span class="st">"'{old_name}' [{old_code}] -&gt; '{new_name}' [{new_code}]"</span>))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  n_updated_total <span class="ot">&lt;-</span> n_updated_total <span class="sc">+</span> n_updated</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total casts updated: {n_updated_total}"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="column-naming-rationale" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="column-naming-rationale"><span class="header-section-number">8</span> Column Naming Rationale</h2>
<p>The column renames in <code>flds_redefine.csv</code> follow these db conventions:</p>
<ul>
<li><strong><code>*_id</code></strong> for integer primary/foreign keys (e.g.&nbsp;<code>Cst_Cnt</code> → <code>cast_id</code>, <code>Btl_Cnt</code> → <code>bottle_id</code>)</li>
<li><strong><code>*_key</code></strong> for varchar natural/composite keys (e.g.&nbsp;<code>Cast_ID</code> → <code>cast_key</code>, <code>Cruise_ID</code> → <code>cruise_key</code>, <code>Sta_ID</code> → <code>sta_key</code>)</li>
<li><strong>unit suffixes</strong> for measurements (e.g.&nbsp;<code>Depthm</code> → <code>depth_m</code>)</li>
</ul>
<section id="ambiguous-column-pairs" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="ambiguous-column-pairs"><span class="header-section-number">8.1</span> Ambiguous column pairs</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 44%">
<col style="width: 55%">
</colgroup>
<thead>
<tr class="header">
<th>Column pair</th>
<th>Why different</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Cst_Cnt</code> (→ <code>cast_id</code>) vs <code>Cast_ID</code> (→ <code>cast_key</code>)</td>
<td>integer counter (1, 2, 3…) vs varchar composite (19-4903CR-HY-060-0930-05400560)</td>
</tr>
<tr class="even">
<td><code>Sta_ID</code> (→ <code>sta_key</code>) vs <code>DbSta_ID</code> (→ <code>db_sta_key</code>)</td>
<td>“054.0 056.0” (space-separated) vs “05400560” (compact, derivable)</td>
</tr>
<tr class="odd">
<td><code>Depth_ID</code> (→ <code>depth_key</code>) vs <code>Depthm</code> (→ <code>depth_m</code>)</td>
<td>varchar identifier vs numeric depth in meters</td>
</tr>
</tbody>
</table>
</section>
<section id="r_-reported-pre-qc-values" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="r_-reported-pre-qc-values"><span class="header-section-number">8.2</span> <code>R_*</code> = “Reported” (pre-QC) values</h3>
<p>The <code>R_*</code> prefix means original instrument values before quality control. <strong>Critical</strong>: <code>R_Sal</code> (Specific Volume Anomaly, values ~233, units 10⁻⁸ m³/kg) is a <strong>completely different parameter/scale</strong> than <code>Salnty</code> (Practical Salinity PSS-78, values ~33.44). These are pivoted as distinct measurement types (<code>r_salinity_sva</code> vs <code>salinity</code>).</p>
</section>
</section>
<section id="consolidate-casts-columns" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="consolidate-casts-columns"><span class="header-section-number">9</span> Consolidate Casts Columns</h2>
<p>Combine <code>date</code> + <code>time</code> into <code>datetime_utc</code>, drop 16 derivable columns, and create a <code>casts_derived</code> convenience VIEW.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- create datetime_utc from date (DATE) + time (INTERVAL) ----</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co"># date is DATE type (e.g. 1949-03-01), time is INTERVAL (e.g. 09:30:00)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># adding DATE + INTERVAL yields TIMESTAMP; 324 casts have NULL time</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"ALTER TABLE casts ADD COLUMN datetime_utc TIMESTAMP"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="st">  UPDATE casts SET datetime_utc =</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="st">      WHEN </span><span class="sc">\"</span><span class="st">time</span><span class="sc">\"</span><span class="st"> IS NOT NULL</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="st">      THEN CAST(</span><span class="sc">\"</span><span class="st">date</span><span class="sc">\"</span><span class="st"> AS TIMESTAMP) + </span><span class="sc">\"</span><span class="st">time</span><span class="sc">\"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="st">      ELSE CAST(</span><span class="sc">\"</span><span class="st">date</span><span class="sc">\"</span><span class="st"> AS TIMESTAMP)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="st">    END"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35644</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Created datetime_utc: {dbGetQuery(con, 'SELECT COUNT(*) FROM casts WHERE datetime_utc IS NOT NULL')[[1]]} non-null values"</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># -- drop derivable columns ----</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"quarter"</span>, <span class="st">"julian_day"</span>, <span class="st">"julian_date"</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"time_zone"</span>,</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lat_deg"</span>, <span class="st">"lat_min"</span>, <span class="st">"lat_hem"</span>,</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lon_deg"</span>, <span class="st">"lon_min"</span>, <span class="st">"lon_hem"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cruise"</span>, <span class="st">"cruz_sta"</span>, <span class="st">"db_sta_key"</span>, <span class="st">"cruz_num"</span>)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="co"># drop date and time (replaced by datetime_utc)</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(cols_to_drop, <span class="st">"date"</span>, <span class="st">"time"</span>)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>n_before <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cols_to_drop) {</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(con, <span class="fu">glue</span>(<span class="st">'ALTER TABLE casts DROP COLUMN "{col}"'</span>)),</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">warning</span>(<span class="fu">glue</span>(<span class="st">"could not drop {col}: {e$message}"</span>)))</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>n_after <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"casts columns: {n_before} -&gt; {n_after} (dropped {n_before - n_after})"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="pivot-bottle-measurements" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="pivot-bottle-measurements"><span class="header-section-number">10</span> Pivot Bottle Measurements</h2>
<p>Pivot wide-format measurement columns from <code>bottle</code> into long-format <code>bottle_measurement</code> table. Each measurement type has a value, optional precision, and optional quality code.</p>
<div class="cell" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>erDiagram</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    bottle_BEFORE {</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>        int bottle_id PK</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>        int cast_id FK</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        dbl depth_m</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        dbl t_deg_c</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        dbl t_prec</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>        str t_qual</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        dbl salnty</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        dbl s_prec</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        str s_qual</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        dbl o2ml_l</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        str o_qual</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>        dbl chlor_a</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        str chlqua</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>        dbl _etc "... 30 measurement columns"</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    bottle_AFTER {</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        int bottle_id PK</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        int cast_id FK</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        dbl depth_m</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        str depth_qual</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    bottle_measurement {</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        int bottle_measurement_id PK</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>        int bottle_id FK</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>        str measurement_type</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>        dbl measurement_value</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>        dbl measurement_prec</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>        str measurement_qual</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    bottle_BEFORE ||--|{ bottle_measurement : "pivot into"</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>    bottle_AFTER ||--o{ bottle_measurement : "bottle_id"</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="pivot_bottle_meas_diagram">
<div>
<pre class="mermaid mermaid-js" data-label="pivot_bottle_meas_diagram">erDiagram
    bottle_BEFORE {
        int bottle_id PK
        int cast_id FK
        dbl depth_m
        dbl t_deg_c
        dbl t_prec
        str t_qual
        dbl salnty
        dbl s_prec
        str s_qual
        dbl o2ml_l
        str o_qual
        dbl chlor_a
        str chlqua
        dbl _etc "... 30 measurement columns"
    }
    bottle_AFTER {
        int bottle_id PK
        int cast_id FK
        dbl depth_m
        str depth_qual
    }
    bottle_measurement {
        int bottle_measurement_id PK
        int bottle_id FK
        str measurement_type
        dbl measurement_value
        dbl measurement_prec
        str measurement_qual
    }
    bottle_BEFORE ||--|{ bottle_measurement : "pivot into"
    bottle_AFTER ||--o{ bottle_measurement : "bottle_id"
</pre>
</div>
<p>Pivot wide bottle columns into long-format bottle_measurement table.</p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># define measurement mapping: type -&gt; value/prec/qual columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>bottle_meas_map <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>measurement_type,     <span class="sc">~</span>value_col,      <span class="sc">~</span>prec_col,  <span class="sc">~</span>qual_col,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"temperature"</span>,         <span class="st">"t_deg_c"</span>,       <span class="st">"t_prec"</span>,   <span class="st">"t_qual"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"salinity"</span>,            <span class="st">"salnty"</span>,        <span class="st">"s_prec"</span>,   <span class="st">"s_qual"</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oxygen_ml_l"</span>,         <span class="st">"o2ml_l"</span>,        <span class="cn">NA</span>,         <span class="st">"o_qual"</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sigma_theta"</span>,         <span class="st">"s_theta"</span>,       <span class="cn">NA</span>,         <span class="st">"s_thtaq"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oxygen_saturation"</span>,   <span class="st">"o2sat"</span>,         <span class="cn">NA</span>,         <span class="st">"o2satq"</span>,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oxygen_umol_kg"</span>,      <span class="st">"oxy_umol_kg"</span>,   <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"chlorophyll_a"</span>,       <span class="st">"chlor_a"</span>,       <span class="cn">NA</span>,         <span class="st">"chlqua"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"phaeopigment"</span>,        <span class="st">"phaeop"</span>,        <span class="cn">NA</span>,         <span class="st">"phaqua"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"phosphate"</span>,           <span class="st">"po4u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"po4q"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"silicate"</span>,            <span class="st">"si_o3u_m"</span>,      <span class="cn">NA</span>,         <span class="st">"si_o3qu"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nitrite"</span>,             <span class="st">"no2u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"no2q"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nitrate"</span>,             <span class="st">"no3u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"no3q"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ammonia"</span>,             <span class="st">"nh3u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"nh3q"</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_rep1"</span>,            <span class="st">"c14as1"</span>,        <span class="st">"c14a1p"</span>,   <span class="st">"c14a1q"</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_rep2"</span>,            <span class="st">"c14as2"</span>,        <span class="st">"c14a2p"</span>,   <span class="st">"c14a2q"</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_dark"</span>,            <span class="st">"dark_as"</span>,       <span class="st">"dark_ap"</span>,  <span class="st">"darkaq"</span>,</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_mean"</span>,            <span class="st">"mean_as"</span>,       <span class="st">"mean_ap"</span>,  <span class="st">"mean_aq"</span>,</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"light_pct"</span>,           <span class="st">"light_p"</span>,       <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_depth"</span>,             <span class="st">"r_depth"</span>,       <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_temperature"</span>,       <span class="st">"r_temp"</span>,        <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_salinity_sva"</span>,      <span class="st">"r_sal"</span>,         <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_dynamic_height"</span>,    <span class="st">"r_dynht"</span>,       <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_ammonium"</span>,          <span class="st">"r_nuts"</span>,        <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_oxygen_umol_kg"</span>,    <span class="st">"r_oxy_umol_kg"</span>, <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dic_rep1"</span>,            <span class="st">"dic1"</span>,          <span class="cn">NA</span>,         <span class="st">"dic_quality_comment"</span>,</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dic_rep2"</span>,            <span class="st">"dic2"</span>,          <span class="cn">NA</span>,         <span class="st">"dic_quality_comment"</span>,</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">"alkalinity_rep1"</span>,     <span class="st">"ta1"</span>,           <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">"alkalinity_rep2"</span>,     <span class="st">"ta2"</span>,           <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ph_rep1"</span>,             <span class="st">"p_h1"</span>,          <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ph_rep2"</span>,             <span class="st">"p_h2"</span>,          <span class="cn">NA</span>,         <span class="cn">NA</span>)</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="co"># build UNION ALL SQL from mapping</span></span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>sql_parts <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_chr</span>(bottle_meas_map, <span class="cf">function</span>(</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>    measurement_type, value_col, prec_col, qual_col) {</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  prec_expr <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.na</span>(prec_col)) <span class="st">"NULL"</span> <span class="cf">else</span> prec_col</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  qual_expr <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.na</span>(qual_col)) <span class="st">"NULL"</span> <span class="cf">else</span> qual_col</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT bottle_id, '{measurement_type}' AS measurement_type,</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({value_col} AS DOUBLE) AS measurement_value,</span></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({prec_expr} AS DOUBLE) AS measurement_prec,</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({qual_expr} AS VARCHAR) AS measurement_qual</span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a><span class="st">     FROM bottle WHERE {value_col} IS NOT NULL"</span>)</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>sql_create <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CREATE TABLE bottle_measurement AS</span></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a><span class="st">   SELECT ROW_NUMBER() OVER (ORDER BY bottle_id, measurement_type)</span></span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a><span class="st">     AS bottle_measurement_id, *</span></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a><span class="st">   FROM (</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="st">     {paste(sql_parts, collapse = '</span><span class="sc">\n</span><span class="st">UNION ALL</span><span class="sc">\n</span><span class="st">')}</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a><span class="st">   ) sub"</span>)</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, sql_create)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11135600</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n_meas <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM bottle_measurement"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>n_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(DISTINCT measurement_type) FROM bottle_measurement"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement: {format(n_meas, big.mark = ',')} rows, {n_types} measurement types"</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -- drop measurement columns from bottle base table ----</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  bottle_meas_map<span class="sc">$</span>value_col,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(bottle_meas_map<span class="sc">$</span>prec_col),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(bottle_meas_map<span class="sc">$</span>qual_col)))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>n_before <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"bottle"</span>))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cols_to_drop) {</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(con, <span class="fu">glue</span>(<span class="st">'ALTER TABLE bottle DROP COLUMN "{col}"'</span>)),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">warning</span>(<span class="fu">glue</span>(<span class="st">"could not drop {col}: {e$message}"</span>)))</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># rename p_qual to depth_qual (pressure/depth quality code stays in base table)</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">'ALTER TABLE bottle RENAME COLUMN p_qual TO depth_qual'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>n_after <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"bottle"</span>))</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle columns: {n_before} -&gt; {n_after} (dropped {n_before - n_after})"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="pivot-cast-conditions" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="pivot-cast-conditions"><span class="header-section-number">11</span> Pivot Cast Conditions</h2>
<p>Pivot meteorological and environmental observation columns from <code>casts</code> into long-format <code>cast_condition</code> table.</p>
<div class="cell" data-layout-align="default">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>erDiagram</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    casts_BEFORE {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        int cast_id PK</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        str sta_key</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        dbl lat_dec</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        dbl lon_dec</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        ts  datetime_utc</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        dbl wave_dir</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        dbl wave_ht</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>        dbl wave_prd</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>        dbl wind_dir</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>        dbl wind_spd</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        dbl barometer</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        dbl dry_t</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>        dbl wet_t</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>        dbl wea</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>        dbl cloud_typ</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>        dbl cloud_amt</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>        dbl visibility</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>        dbl secchi</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>        dbl forel_u</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>    casts_AFTER {</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>        int cast_id PK</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>        str sta_key</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>        dbl lat_dec</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>        dbl lon_dec</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        ts  datetime_utc</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>    cast_condition {</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>        int cast_condition_id PK</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>        int cast_id FK</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>        str condition_type</span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>        dbl condition_value</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>    casts_BEFORE ||--|{ cast_condition : "pivot into"</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>    casts_AFTER ||--o{ cast_condition : "cast_id"</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div id="pivot_cast_cond_diagram">
<div>
<pre class="mermaid mermaid-js" data-label="pivot_cast_cond_diagram">erDiagram
    casts_BEFORE {
        int cast_id PK
        str sta_key
        dbl lat_dec
        dbl lon_dec
        ts  datetime_utc
        dbl wave_dir
        dbl wave_ht
        dbl wave_prd
        dbl wind_dir
        dbl wind_spd
        dbl barometer
        dbl dry_t
        dbl wet_t
        dbl wea
        dbl cloud_typ
        dbl cloud_amt
        dbl visibility
        dbl secchi
        dbl forel_u
    }
    casts_AFTER {
        int cast_id PK
        str sta_key
        dbl lat_dec
        dbl lon_dec
        ts  datetime_utc
    }
    cast_condition {
        int cast_condition_id PK
        int cast_id FK
        str condition_type
        dbl condition_value
    }
    casts_BEFORE ||--|{ cast_condition : "pivot into"
    casts_AFTER ||--o{ cast_condition : "cast_id"
</pre>
</div>
<p>Pivot wide cast condition columns into long-format cast_condition table.</p>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>cast_cond_map <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>condition_type,        <span class="sc">~</span>source_col,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wave_direction"</span>,       <span class="st">"wave_dir"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wave_height"</span>,          <span class="st">"wave_ht"</span>,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wave_period"</span>,          <span class="st">"wave_prd"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wind_direction"</span>,       <span class="st">"wind_dir"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wind_speed"</span>,           <span class="st">"wind_spd"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"barometric_pressure"</span>,  <span class="st">"barometer"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dry_air_temp"</span>,         <span class="st">"dry_t"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wet_air_temp"</span>,         <span class="st">"wet_t"</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"weather_code"</span>,         <span class="st">"wea"</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cloud_type"</span>,           <span class="st">"cloud_typ"</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cloud_amount"</span>,         <span class="st">"cloud_amt"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"visibility"</span>,           <span class="st">"visibility"</span>,</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"secchi_depth"</span>,         <span class="st">"secchi"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"water_color"</span>,          <span class="st">"forel_u"</span>)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="co"># build UNION ALL SQL</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>sql_parts <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_chr</span>(cast_cond_map, <span class="cf">function</span>(condition_type, source_col) {</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT cast_id, '{condition_type}' AS condition_type,</span></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({source_col} AS DOUBLE) AS condition_value</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="st">     FROM casts WHERE {source_col} IS NOT NULL"</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>sql_create <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CREATE TABLE cast_condition AS</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="st">   SELECT ROW_NUMBER() OVER (ORDER BY cast_id, condition_type)</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="st">     AS cast_condition_id, *</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="st">   FROM (</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="st">     {paste(sql_parts, collapse = '</span><span class="sc">\n</span><span class="st">UNION ALL</span><span class="sc">\n</span><span class="st">')}</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="st">   ) sub"</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, sql_create)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 235513</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>n_cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM cast_condition"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>n_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(DISTINCT condition_type) FROM cast_condition"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition: {format(n_cond, big.mark = ',')} rows, {n_types} condition types"</span>))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># -- drop condition columns from casts ----</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>n_before <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cast_cond_map<span class="sc">$</span>source_col) {</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(con, <span class="fu">glue</span>(<span class="st">'ALTER TABLE casts DROP COLUMN "{col}"'</span>)),</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">warning</span>(<span class="fu">glue</span>(<span class="st">"could not drop {col}: {e$message}"</span>)))</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>n_after <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"casts columns: {n_before} -&gt; {n_after} (dropped {n_before - n_after})"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="load-measurement-type-reference" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="load-measurement-type-reference"><span class="header-section-number">12</span> Load Measurement Type Reference</h2>
<p>Load the <code>measurement_type</code> lookup table that provides units and descriptions for all measurement/condition types across datasets.</p>
<section id="measurement_type-vs-lookup" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="measurement_type-vs-lookup"><span class="header-section-number">12.1</span> <code>measurement_type</code> vs <code>lookup</code></h3>
<p>The <code>measurement_type</code> table and the swfsc <code>lookup</code> table serve fundamentally different purposes:</p>
<ul>
<li><strong><code>measurement_type</code></strong> answers “what was measured?” — provides metadata (units, description, source provenance) for measurement codes used in <code>bottle_measurement</code>, <code>cast_condition</code>, and <code>ichthyo</code></li>
<li><strong><code>lookup</code></strong> answers “what does this code mean?” — translates categorical values (egg developmental stages 1-11, larva stages, tow types) into human-readable descriptions</li>
</ul>
<p>Merging would create a sparse table with many NULL columns (e.g., <code>units</code>/<code>_source_column</code> NULL for egg stages; <code>lookup_num</code>/<code>lookup_chr</code> NULL for temperature). Both tables coexist in the Working DuckLake, loaded from their respective upstream workflows.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>meas_type_csv <span class="ot">&lt;-</span> <span class="fu">here</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"metadata/calcofi.org/bottle-database/measurement_type.csv"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>d_meas_type <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(meas_type_csv)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"measurement_type"</span>, d_meas_type, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="co"># validate FK: all bottle_measurement types exist in reference table</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>orphan_btl_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT measurement_type FROM bottle_measurement</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE measurement_type NOT IN (SELECT measurement_type FROM measurement_type)"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"all bottle_measurement.measurement_type must exist in measurement_type"</span> <span class="ot">=</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(orphan_btl_types) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="co"># validate FK: all cast_condition types exist in reference table</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>orphan_cond_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT condition_type FROM cast_condition</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE condition_type NOT IN (SELECT measurement_type FROM measurement_type)"</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"all cast_condition.condition_type must exist in measurement_type"</span> <span class="ot">=</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(orphan_cond_types) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"measurement_type: {nrow(d_meas_type)} types loaded, FK checks passed"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
<section id="verify-primary-keys" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="verify-primary-keys"><span class="header-section-number">13</span> Verify Primary Keys</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># verify cast_id uniqueness in casts</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cast_keys <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"casts"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(cast_id)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>n_dup_cast <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">duplicated</span>(cast_keys))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"cast_id must be unique in casts"</span> <span class="ot">=</span> n_dup_cast <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"casts.cast_id: {length(cast_keys)} unique values, 0 duplicates"</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="co"># verify bottle_id uniqueness in bottle</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>btl_keys <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"bottle"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(bottle_id)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>n_dup_btl <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">duplicated</span>(btl_keys))</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"bottle_id must be unique in bottle"</span> <span class="ot">=</span> n_dup_btl <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle.bottle_id: {length(btl_keys)} unique values, 0 duplicates"</span>))</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a><span class="co"># verify FK: bottle.cast_id -&gt; casts.cast_id</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>orphan_bottles <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"bottle"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"casts"</span>),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"cast_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"all bottle.cast_id must exist in casts.cast_id"</span> <span class="ot">=</span></span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(orphan_bottles) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FK integrity: all {length(btl_keys)} bottle.cast_id "</span>,</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="st">"found in casts.cast_id"</span>))</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co"># verify bottle_measurement_id uniqueness</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>n_dup_bm_id <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT bottle_measurement_id, COUNT(*) AS n</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM bottle_measurement</span></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY bottle_measurement_id</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"bottle_measurement_id must be unique"</span> <span class="ot">=</span> n_dup_bm_id <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement.bottle_measurement_id: unique, 0 duplicates"</span>))</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="co"># verify composite PK: bottle_measurement (bottle_id, measurement_type)</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>n_dup_meas <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT bottle_id, measurement_type, COUNT(*) AS n</span></span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM bottle_measurement</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY bottle_id, measurement_type</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"bottle_measurement (bottle_id, measurement_type) must be unique"</span> <span class="ot">=</span> n_dup_meas <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement: composite key unique, 0 duplicates"</span>))</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a><span class="co"># verify FK: bottle_measurement.bottle_id -&gt; bottle.bottle_id</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>n_orphan_meas <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(DISTINCT bottle_id) FROM bottle_measurement</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE bottle_id NOT IN (SELECT bottle_id FROM bottle)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"all bottle_measurement.bottle_id must exist in bottle"</span> <span class="ot">=</span> n_orphan_meas <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement FK: all bottle_ids found in bottle"</span>))</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="co"># verify cast_condition_id uniqueness</span></span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>n_dup_cc_id <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT cast_condition_id, COUNT(*) AS n</span></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM cast_condition</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY cast_condition_id</span></span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"cast_condition_id must be unique"</span> <span class="ot">=</span> n_dup_cc_id <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition.cast_condition_id: unique, 0 duplicates"</span>))</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a><span class="co"># verify composite PK: cast_condition (cast_id, condition_type)</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>n_dup_cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT cast_id, condition_type, COUNT(*) AS n</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM cast_condition</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY cast_id, condition_type</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"cast_condition (cast_id, condition_type) must be unique"</span> <span class="ot">=</span> n_dup_cond <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition: composite key unique, 0 duplicates"</span>))</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a><span class="co"># verify FK: cast_condition.cast_id -&gt; casts.cast_id</span></span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>n_orphan_cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(DISTINCT cast_id) FROM cast_condition</span></span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE cast_id NOT IN (SELECT cast_id FROM casts)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"all cast_condition.cast_id must exist in casts"</span> <span class="ot">=</span> n_orphan_cond <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition FK: all cast_ids found in casts"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="schema-documentation" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="schema-documentation"><span class="header-section-number">14</span> Schema Documentation</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude views (casts_derived) — dm_from_con can't access views</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>db_tables <span class="ot">&lt;-</span> <span class="cf">function</span>(con) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(<span class="fu">dbListTables</span>(con), <span class="st">"casts_derived"</span>) <span class="sc">|&gt;</span> <span class="fu">sort</span>()</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>tbls <span class="ot">&lt;-</span> <span class="fu">db_tables</span>(con)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co"># dm object for visualization (keys learned from data, not DB constraints)</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>dm_dev <span class="ot">&lt;-</span> <span class="fu">dm_from_con</span>(con, <span class="at">table_names =</span> tbls, <span class="at">learn_keys =</span> <span class="cn">FALSE</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(dm_dev, <span class="at">view_type =</span> <span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-b5e661da4c71429da06a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b5e661da4c71429da06a">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\npack=true\npackmode= \"node\"\n\n  \"bottle\" [id = \"bottle\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">bottle<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">bottle_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_m<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">btl_num<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rec_ind<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_qual<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_tim<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_file<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_row<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_ingested_at<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_uuid<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"bottle_measurement\" [id = \"bottle_measurement\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">bottle_measurement<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">bottle_measurement_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">bottle_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_value<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_prec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_qual<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"cast_condition\" [id = \"cast_condition\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">cast_condition<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_condition_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">condition_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">condition_value<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"casts\" [id = \"casts\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">casts<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cruise_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">distance<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">lat_dec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">lon_dec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rpt_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">st_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ac_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rpt_sta<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">st_station<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ac_sta<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">bottom_depth_m<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ship_name<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ship_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">data_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">order_occ<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">event_num<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cruz_leg<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">orig_sta_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">data_or<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">int_chl<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">int_c14<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_str<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_end<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">pst_lan<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">civil_t<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_file<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_row<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_ingested_at<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_uuid<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">datetime_utc<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"measurement_type\" [id = \"measurement_type\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">measurement_type<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">dataset<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">units<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_column<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_table<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_workflow<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<section id="primary-key-strategy" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="primary-key-strategy"><span class="header-section-number">14.1</span> Primary Key Strategy</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 50%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th>Table</th>
<th>Primary Key</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>casts</code></td>
<td><code>cast_id</code></td>
<td>Natural key (integer counter from source <code>Cst_Cnt</code>)</td>
</tr>
<tr class="even">
<td><code>bottle</code></td>
<td><code>bottle_id</code></td>
<td>Natural key (integer counter from source <code>Btl_Cnt</code>)</td>
</tr>
<tr class="odd">
<td><code>bottle_measurement</code></td>
<td><code>bottle_measurement_id</code></td>
<td>Integer PK via <code>ROW_NUMBER(ORDER BY bottle_id, measurement_type)</code>; composite <code>(bottle_id, measurement_type)</code> enforced unique</td>
</tr>
<tr class="even">
<td><code>cast_condition</code></td>
<td><code>cast_condition_id</code></td>
<td>Integer PK via <code>ROW_NUMBER(ORDER BY cast_id, condition_type)</code>; composite <code>(cast_id, condition_type)</code> enforced unique</td>
</tr>
<tr class="odd">
<td><code>measurement_type</code></td>
<td><code>measurement_type</code></td>
<td>Natural key (type code string)</td>
</tr>
<tr class="even">
<td><code>grid</code></td>
<td><code>grid_key</code></td>
<td>Natural key</td>
</tr>
</tbody>
</table>
</section>
<section id="foreign-key-relationships" class="level3" data-number="14.2">
<h3 data-number="14.2" class="anchored" data-anchor-id="foreign-key-relationships"><span class="header-section-number">14.2</span> Foreign Key Relationships</h3>
<pre><code>casts.cast_id (PK, integer) — station-level
    ↓
bottle.bottle_id (PK, integer) — sample-level
bottle.cast_id (FK) → casts.cast_id
    ↓
bottle_measurement.bottle_measurement_id (PK, integer) — ROW_NUMBER(ORDER BY bottle_id, measurement_type)
bottle_measurement.bottle_id (FK) → bottle.bottle_id
bottle_measurement.measurement_type (FK) → measurement_type.measurement_type

cast_condition.cast_condition_id (PK, integer) — ROW_NUMBER(ORDER BY cast_id, condition_type)
cast_condition.cast_id (FK) → casts.cast_id
cast_condition.condition_type (FK) → measurement_type.measurement_type

casts.grid_key (FK) → grid.grid_key (after spatial join)
casts.ship_code (soft FK) → ship.ship_nodc (validated after integration with swfsc)</code></pre>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>tbls <span class="ot">&lt;-</span> <span class="fu">db_tables</span>(con)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>dm_dev <span class="ot">&lt;-</span> <span class="fu">dm_from_con</span>(con, <span class="at">table_names =</span> tbls, <span class="at">learn_keys =</span> <span class="cn">FALSE</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># define relationships in dm (in-memory for visualization only)</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>add_bottle_keys <span class="ot">&lt;-</span> <span class="cf">function</span>(dm){</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  dm <span class="sc">|&gt;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(casts, cast_id) <span class="sc">|&gt;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(bottle, bottle_id) <span class="sc">|&gt;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(bottle_measurement, bottle_measurement_id) <span class="sc">|&gt;</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(cast_condition, cast_condition_id) <span class="sc">|&gt;</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(measurement_type, measurement_type) <span class="sc">|&gt;</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(bottle, cast_id, casts) <span class="sc">|&gt;</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(bottle_measurement, bottle_id, bottle) <span class="sc">|&gt;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(bottle_measurement, measurement_type, measurement_type) <span class="sc">|&gt;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(cast_condition, cast_id, casts) <span class="sc">|&gt;</span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(cast_condition, condition_type, measurement_type, measurement_type)</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>dm_dev_fk <span class="ot">&lt;-</span> dm_dev <span class="sc">|&gt;</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_bottle_keys</span>()</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(dm_dev_fk, <span class="at">view_type =</span> <span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-3541c1c02ddf385a34cc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-3541c1c02ddf385a34cc">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\npack=true\npackmode= \"node\"\n\n  \"bottle\" [id = \"bottle\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">bottle<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"cast_id\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"bottle_id\"><U>bottle_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_m<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">btl_num<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rec_ind<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_qual<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_tim<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_file<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_row<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_ingested_at<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_uuid<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"bottle_measurement\" [id = \"bottle_measurement\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">bottle_measurement<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"bottle_measurement_id\"><U>bottle_measurement_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"bottle_id\">bottle_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"measurement_type\">measurement_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_value<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_prec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">measurement_qual<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"cast_condition\" [id = \"cast_condition\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">cast_condition<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"cast_condition_id\"><U>cast_condition_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"cast_id\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"condition_type\">condition_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">condition_value<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"casts\" [id = \"casts\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">casts<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"cast_id\"><U>cast_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cruise_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">distance<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">lat_dec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">lon_dec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rpt_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">st_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ac_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rpt_sta<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">st_station<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ac_sta<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">bottom_depth_m<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ship_name<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ship_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">data_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">order_occ<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">event_num<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cruz_leg<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">orig_sta_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">data_or<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">int_chl<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">int_c14<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_str<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_end<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">pst_lan<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">civil_t<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_file<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_row<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_ingested_at<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_uuid<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">datetime_utc<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"measurement_type\" [id = \"measurement_type\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">measurement_type<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"measurement_type\"><U>measurement_type<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">dataset<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">units<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_column<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_table<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_workflow<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"bottle_measurement\":\"bottle_id\"->\"bottle\":\"bottle_id\" [id=\"bottle_measurement_1\"]\n\"bottle\":\"cast_id\"->\"casts\":\"cast_id\" [id=\"bottle_1\"]\n\"cast_condition\":\"cast_id\"->\"casts\":\"cast_id\" [id=\"cast_condition_1\"]\n\"bottle_measurement\":\"measurement_type\"->\"measurement_type\":\"measurement_type\" [id=\"bottle_measurement_2\"]\n\"cast_condition\":\"condition_type\"->\"measurement_type\":\"measurement_type\" [id=\"cast_condition_2\"]\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="add-spatial" class="level2" data-number="15">
<h2 data-number="15" class="anchored" data-anchor-id="add-spatial"><span class="header-section-number">15</span> Add Spatial</h2>
<section id="add-casts.geom" class="level3" data-number="15.1">
<h3 data-number="15.1" class="anchored" data-anchor-id="add-casts.geom"><span class="header-section-number">15.1</span> Add <code>casts.geom</code></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add geometry column using DuckDB spatial</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co"># note: DuckDB spatial doesn't track SRID metadata (unlike PostGIS)</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># all geometries assumed WGS84 (EPSG:4326) by convention</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">add_point_geom</span>(con, <span class="st">"casts"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="load-grid-table" class="level3" data-number="15.2">
<h3 data-number="15.2" class="anchored" data-anchor-id="load-grid-table"><span class="header-section-number">15.2</span> Load <code>grid</code> table</h3>
<p>Load grid from the swfsc workflow’s GCS parquet output (single source of truth — grid is created in <code>ingest_swfsc.noaa.gov_calcofi-db.qmd</code>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load_gcs_parquet_to_duckdb</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">con        =</span> con,</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gcs_path   =</span> <span class="st">"gs://calcofi-db/ingest/swfsc.noaa.gov_calcofi-db/grid.parquet"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_name =</span> <span class="st">"grid"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="update-casts.grid_key" class="level3" data-number="15.3">
<h3 data-number="15.3" class="anchored" data-anchor-id="update-casts.grid_key"><span class="header-section-number">15.3</span> Update <code>casts.grid_key</code></h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>grid_stats <span class="ot">&lt;-</span> <span class="fu">assign_grid_key</span>(con, <span class="st">"casts"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>grid_stats <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-974758324ff8c62a5497" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-974758324ff8c62a5497">{"x":{"filter":"none","vertical":false,"data":[["1","2"],["not_in_grid","in_grid"],[298,35346]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>status<\/th>\n      <th>n<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"status","targets":1},{"name":"n","targets":2}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="create-casts_derived-view" class="level3" data-number="15.4">
<h3 data-number="15.4" class="anchored" data-anchor-id="create-casts_derived-view"><span class="header-section-number">15.4</span> Create <code>casts_derived</code> VIEW</h3>
<p>Create convenience VIEW after all casts table modifications are complete (column drops, pivots, spatial join). The VIEW adds back temporal and coordinate columns derivable from the base table.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"DROP VIEW IF EXISTS casts_derived"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="st">  CREATE VIEW casts_derived AS</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT *,</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM datetime_utc)::SMALLINT    AS year,</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(MONTH FROM datetime_utc)::SMALLINT   AS month,</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(QUARTER FROM datetime_utc)::SMALLINT AS quarter,</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(DOY FROM datetime_utc)::SMALLINT     AS julian_day,</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="st">    (datetime_utc::DATE - DATE '1899-12-30')     AS julian_date,</span></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lat_dec))::SMALLINT                AS lat_deg,</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lat_dec) - FLOOR(ABS(lat_dec))) * 60    AS lat_min,</span></span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lat_dec &gt;= 0 THEN 'N' ELSE 'S' END AS lat_hem,</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lon_dec))::SMALLINT                AS lon_deg,</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lon_dec) - FLOOR(ABS(lon_dec))) * 60    AS lon_min,</span></span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lon_dec &gt;= 0 THEN 'E' ELSE 'W' END AS lon_hem,</span></span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="st">    STRFTIME(datetime_utc, '%Y%m')                AS cruise,</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="st">    REPLACE(REPLACE(sta_key, '.', ''), ' ', '')   AS db_sta_key</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM casts"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Created casts_derived VIEW with derived temporal/coordinate columns"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="map-cast-locations" class="level3" data-number="15.5">
<h3 data-number="15.5" class="anchored" data-anchor-id="map-cast-locations"><span class="header-section-number">15.5</span> Map Cast Locations</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># slowish, so use cached figure</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>map_casts_png <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="fu">glue</span>(<span class="st">"figures/{provider}_{dataset}_casts_map.png"</span>))</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file_exists</span>(map_casts_png)) {</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  casts_sf <span class="ot">&lt;-</span> calcofi4r<span class="sc">::</span><span class="fu">cc_read_sf</span>(con, <span class="st">"casts"</span>) <span class="sc">|&gt;</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(datetime_utc))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mapView</span>(casts_sf, <span class="at">zcol =</span> <span class="st">"year"</span>)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapshot2</span>(m, <span class="at">file =</span> map_casts_png)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">img</span>(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">src   =</span> map_casts_png <span class="sc">|&gt;</span> <span class="fu">str_replace</span>(<span class="fu">here</span>(), <span class="st">"."</span>),</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="st">"600px"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<img src="./figures/calcofi.org_bottle-database_casts_map.png" width="600px">
</div>
</div>
</section>
</section>
<section id="report" class="level2" data-number="16">
<h2 data-number="16" class="anchored" data-anchor-id="report"><span class="header-section-number">16</span> Report</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>all_tbls <span class="ot">&lt;-</span> <span class="fu">db_tables</span>(con)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>add_bottle_spatial_keys <span class="ot">&lt;-</span> <span class="cf">function</span>(dm){</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  dm <span class="sc">|&gt;</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(grid, grid_key) <span class="sc">|&gt;</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(casts, grid_key, grid)</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>dm_final <span class="ot">&lt;-</span> <span class="fu">dm_from_con</span>(con, <span class="at">table_names =</span> all_tbls, <span class="at">learn_keys =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_bottle_keys</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_bottle_spatial_keys</span>() <span class="sc">|&gt;</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_set_colors</span>(</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightgreen  =</span> grid,</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightyellow =</span> <span class="fu">c</span>(bottle_measurement, cast_condition),</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightblue   =</span> measurement_type)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(dm_final, <span class="at">view_type =</span> <span class="st">"all"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="grViz html-widget html-fill-item" id="htmlwidget-b556adfde27186c74785" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b556adfde27186c74785">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\npack=true\npackmode= \"node\"\n\n  \"bottle\" [id = \"bottle\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">bottle<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"cast_id\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"bottle_id\"><U>bottle_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_m<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">btl_num<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rec_ind<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">depth_qual<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_tim<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_file<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_row<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_ingested_at<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_uuid<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"bottle_measurement\" [id = \"bottle_measurement\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AAAA95AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#FFFFE0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">bottle_measurement<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\" PORT=\"bottle_measurement_id\"><U>bottle_measurement_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\" PORT=\"bottle_id\">bottle_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\" PORT=\"measurement_type\">measurement_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\">measurement_value<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\">measurement_prec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\">measurement_qual<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"cast_condition\" [id = \"cast_condition\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AAAA95AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#FFFFE0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">cast_condition<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\" PORT=\"cast_condition_id\"><U>cast_condition_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\" PORT=\"cast_id\">cast_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\" PORT=\"condition_type\">condition_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFF8FF\">condition_value<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"casts\" [id = \"casts\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">casts<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"cast_id\"><U>cast_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cruise_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cast_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_key<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">sta_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">distance<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">lat_dec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">lon_dec<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rpt_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">st_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ac_line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">rpt_sta<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">st_station<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ac_sta<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">bottom_depth_m<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ship_name<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">ship_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">data_type<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">order_occ<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">event_num<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">cruz_leg<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">orig_sta_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">data_or<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">int_chl<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">int_c14<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_str<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">inc_end<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">pst_lan<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">civil_t<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_file<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_row<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_ingested_at<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">_source_uuid<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">datetime_utc<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">geom<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"grid_key\">grid_key<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"grid\" [id = \"grid\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#609E60AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#90EE90FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">grid<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\" PORT=\"grid_key\"><U>grid_key<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">station<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">line<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">shore<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">pattern<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">spacing<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">zone<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">area_km2<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">geom<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#E8FBE8FF\">geom_ctr<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"measurement_type\" [id = \"measurement_type\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#739099AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#ADD8E6FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">measurement_type<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\" PORT=\"measurement_type\"><U>measurement_type<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\">dataset<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\">description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\">units<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\">_source_column<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\">_source_table<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#EEF7FAFF\">_source_workflow<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"bottle_measurement\":\"bottle_id\"->\"bottle\":\"bottle_id\" [id=\"bottle_measurement_1\"]\n\"bottle\":\"cast_id\"->\"casts\":\"cast_id\" [id=\"bottle_1\"]\n\"cast_condition\":\"cast_id\"->\"casts\":\"cast_id\" [id=\"cast_condition_1\"]\n\"casts\":\"grid_key\"->\"grid\":\"grid_key\" [id=\"casts_1\"]\n\"bottle_measurement\":\"measurement_type\"->\"measurement_type\":\"measurement_type\" [id=\"bottle_measurement_2\"]\n\"cast_condition\":\"condition_type\"->\"measurement_type\":\"measurement_type\" [id=\"cast_condition_2\"]\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>n_casts   <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"casts"</span>) <span class="sc">|&gt;</span> <span class="fu">tally</span>() <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>n_bottles <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"bottle"</span>) <span class="sc">|&gt;</span> <span class="fu">tally</span>() <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>n_meas    <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM bottle_measurement"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>n_cond    <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM cast_condition"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>year_range <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM MIN(datetime_utc))::INTEGER AS yr_min,</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM MAX(datetime_utc))::INTEGER AS yr_max</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM casts"</span>)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>fmt <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">","</span>, ...)</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total casts: {fmt(n_casts)}"</span>))</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total bottles: {fmt(n_bottles)}"</span>))</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total bottle measurements: {fmt(n_meas)}"</span>))</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total cast conditions: {fmt(n_cond)}"</span>))</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Year range: {year_range$yr_min} - {year_range$yr_max}"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="validate-local-database" class="level2" data-number="17">
<h2 data-number="17" class="anchored" data-anchor-id="validate-local-database"><span class="header-section-number">17</span> Validate Local Database</h2>
<p>Validate data quality in the local wrangling database before exporting to parquet. The parquet outputs from this workflow can later be used to update the Working DuckLake.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># validate data quality</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">validate_for_release</span>(con)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (validation<span class="sc">$</span>passed) {</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Validation passed!"</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(validation<span class="sc">$</span>checks) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    validation<span class="sc">$</span>checks <span class="sc">|&gt;</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(status <span class="sc">!=</span> <span class="st">"pass"</span>) <span class="sc">|&gt;</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Validation Warnings"</span>)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Validation FAILED:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"-"</span>, validation<span class="sc">$</span>errors, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Validation FAILED:
- Table 'casts' has 298 NULL values in required column 'grid_key'
- Table 'casts_derived' has 298 NULL values in required column 'grid_key'</code></pre>
</div>
</div>
</section>
<section id="enforce-column-types" class="level2" data-number="18">
<h2 data-number="18" class="anchored" data-anchor-id="enforce-column-types"><span class="header-section-number">18</span> Enforce Column Types</h2>
<p>Force integer/smallint types on columns that R’s <code>numeric</code> mapped to <code>DOUBLE</code> during <code>dbWriteTable()</code>. Uses <code>flds_redefine.csv</code> (<code>type_new</code>) as the source of truth for source-table columns, plus explicit overrides for derived-table columns.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>type_changes <span class="ot">&lt;-</span> <span class="fu">enforce_column_types</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">con            =</span> con,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_flds_rd      =</span> d<span class="sc">$</span>d_flds_rd,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">type_overrides =</span> <span class="fu">list</span>(),</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tables         =</span> <span class="fu">db_tables</span>(con),</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose        =</span> <span class="cn">TRUE</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(type_changes) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  type_changes <span class="sc">|&gt;</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Column type changes applied"</span>)</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-0b8f2026d4017fb7a5b9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0b8f2026d4017fb7a5b9">{"x":{"filter":"none","vertical":false,"caption":"<caption>Column type changes applied<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["bottle","bottle","bottle","bottle","bottle","casts","casts","casts","casts","casts","casts","casts","casts","casts","casts"],["cast_id","bottle_id","btl_num","rec_ind","inc_tim","cast_id","rpt_line","rpt_sta","order_occ","event_num","cruz_leg","inc_str","inc_end","pst_lan","civil_t"],["DOUBLE","DOUBLE","DOUBLE","DOUBLE","INTERVAL","DOUBLE","VARCHAR","VARCHAR","DOUBLE","DOUBLE","DOUBLE","INTERVAL","INTERVAL","INTERVAL","INTERVAL"],["INTEGER","INTEGER","SMALLINT","VARCHAR","VARCHAR","INTEGER","DOUBLE","DOUBLE","SMALLINT","SMALLINT","VARCHAR","VARCHAR","VARCHAR","VARCHAR","VARCHAR"],[true,true,true,true,true,true,true,true,true,true,true,true,true,true,true]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>table<\/th>\n      <th>column<\/th>\n      <th>from_type<\/th>\n      <th>to_type<\/th>\n      <th>success<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"table","targets":1},{"name":"column","targets":2},{"name":"from_type","targets":3},{"name":"to_type","targets":4},{"name":"success","targets":5}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># recreate casts_derived VIEW after type changes</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"DROP VIEW IF EXISTS casts_derived"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="st">  CREATE VIEW casts_derived AS</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT *,</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM datetime_utc)::SMALLINT    AS year,</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(MONTH FROM datetime_utc)::SMALLINT   AS month,</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(QUARTER FROM datetime_utc)::SMALLINT AS quarter,</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(DOY FROM datetime_utc)::SMALLINT     AS julian_day,</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="st">    (datetime_utc::DATE - DATE '1899-12-30')     AS julian_date,</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lat_dec))::SMALLINT                AS lat_deg,</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lat_dec) - FLOOR(ABS(lat_dec))) * 60    AS lat_min,</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lat_dec &gt;= 0 THEN 'N' ELSE 'S' END AS lat_hem,</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lon_dec))::SMALLINT                AS lon_deg,</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lon_dec) - FLOOR(ABS(lon_dec))) * 60    AS lon_min,</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lon_dec &gt;= 0 THEN 'E' ELSE 'W' END AS lon_hem,</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="st">    STRFTIME(datetime_utc, '%Y%m')                AS cruise,</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="st">    REPLACE(REPLACE(sta_key, '.', ''), ' ', '')   AS db_sta_key</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM casts"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Recreated casts_derived VIEW after column type enforcement"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="data-preview" class="level2" data-number="19">
<h2 data-number="19" class="anchored" data-anchor-id="data-preview"><span class="header-section-number">19</span> Data Preview</h2>
<p>Preview first and last rows of each table before writing parquet outputs.</p>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">preview_tables</span>(con, <span class="fu">c</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"casts"</span>, <span class="st">"bottle"</span>, <span class="st">"bottle_measurement"</span>,</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cast_condition"</span>, <span class="st">"measurement_type"</span>))  <span class="co"># grid canonical from swfsc</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<section id="casts-35644-rows" class="level3" data-number="19.1">
<h3 data-number="19.1" class="anchored" data-anchor-id="casts-35644-rows"><span class="header-section-number">19.1</span> <code>casts</code> (35,644 rows)</h3>
<div class="datatables html-widget html-fill-item" id="htmlwidget-f33f8cb062752c3867bd" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f33f8cb062752c3867bd">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-444.63\" data-max=\"-48.54\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"23.916666\" data-max=\"42.658333\" data-scale=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-133.083334\" data-max=\"-115.3\" data-scale=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"24\" data-max=\"126\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"24\" data-max=\"126\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"23.9\" data-max=\"125.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"146\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"146\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"145.8\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-657595080000\" data-max=\"-654158880000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>casts — first 100 of 35,644 rows<\/caption>","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],["1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31HO","1949-03-28-C-31HO","1949-03-28-C-31HO"],["19-4903CR-HY-060-0930-05400560","19-4903CR-HY-060-2112-05200750","19-4903CR-HY-061-0354-05100850","19-4903CR-HY-061-1042-05000950","19-4903CR-HY-061-1706-05001040","19-4903CR-HY-062-0036-04901140","19-4903CR-HY-063-0506-05671460","19-4903CR-HY-063-1154-05671360","19-4903CR-HY-063-1742-05801270","19-4903CR-HY-063-2354-05901170","19-4903CR-HY-064-0612-05901070","19-4903CR-HY-064-1148-06000970","19-4903CR-HY-064-1800-06100870","19-4903CR-HY-064-2330-06100780","19-4903CR-HY-065-0518-06200680","19-4903CR-HY-065-1030-06330580","19-4903CR-HY-066-0000-07200560","19-4903CR-HY-066-0524-07100660","19-4903CR-HY-067-0518-07100760","19-4903HO-HY-073-0073-08101170","19-4903HO-HY-073-0636-08101270","19-4903HO-HY-073-2030-08101070","19-4903HO-HY-074-0224-08100970","19-4903HO-HY-074-0306-08200970","19-4903HO-HY-074-0948-08200870","19-4903HO-HY-074-1606-08200770","19-4903HO-HY-074-2154-08200670","19-4903NS-HY-059-2242-09200390","19-4903NS-HY-060-0700-09200480","19-4903NS-HY-060-1336-09200580","19-4903NS-HY-060-2012-09200680","19-4903NS-HY-061-0224-09200780","19-4903NS-HY-061-0906-09200880","19-4903NS-HY-061-1618-09200980","19-4903NS-HY-061-2354-09201080","19-4903NS-HY-062-0612-09201170","19-4903NS-HY-062-1230-09201270","19-4903NS-HY-062-1906-09201370","19-4903NS-HY-063-1212-10331280","19-4903NS-HY-063-1924-10331190","19-4903NS-HY-064-0048-10331110","19-4903NS-HY-064-0654-10201030","19-4903NS-HY-064-1236-10200940","19-4903NS-HY-064-1854-10200840","19-4903NS-HY-065-0136-10200740","19-4903NS-HY-065-0800-10200640","19-4903NS-HY-065-1430-10200540","19-4903NS-HY-065-2100-10100440","19-4903NS-HY-066-0306-10100340","19-4903NS-HY-066-1718-11100380","19-4903NS-HY-066-2342-11100480","19-4903NS-HY-067-0606-11100580","19-4903NS-HY-067-1236-11100680","19-4903NS-HY-067-1836-11200780","19-4903NS-HY-068-0030-11200880","19-4903NS-HY-068-0624-11200980","19-4903NS-HY-068-1242-11201070","19-4903NS-HY-068-1818-11201170","19-4903NS-HY-069-0030-11331270","19-4903NS-HY-069-0512-11331370","19-4903NS-HY-069-2348-12601320","19-4903NS-HY-070-0442-12601220","19-4903NS-HY-070-1106-12501120","19-4903NS-HY-070-1730-12501020","19-4903NS-HY-070-2306-12400930","19-4903NS-HY-071-0512-12400830","19-4903NS-HY-071-1124-12330730","19-4903NS-HY-071-1806-12330630","19-4903NS-HY-072-0142-12200530","19-4903NS-HY-072-0906-12200440","19-4904CR-HY-087-0606-04400485","19-4904CR-HY-091-1418-04200680","19-4904CR-HY-092-0030-04100770","19-4904CR-HY-092-1348-03900960","19-4904CR-HY-093-0036-03671150","19-4904CR-HY-093-0718-03601250","19-4904CR-HY-093-2248-02401200","19-4904CR-HY-094-0524-02501110","19-4904CR-HY-094-1118-02601020","19-4904CR-HY-094-1730-02800920","19-4904CR-HY-094-2224-02900830","19-4904CR-HY-095-0406-03000740","19-4904CR-HY-095-1042-03100650","19-4904CR-HY-095-1642-03330550","19-4904CR-HY-095-2142-03400460","19-4904CR-HY-096-0430-03500370","19-4904CR-HY-096-1648-04400490","19-4904CR-HY-097-1548-05400560","19-4904CR-HY-097-2030-05330660","19-4904CR-HY-098-0142-05200750","19-4904CR-HY-098-0748-05100850","19-4904CR-HY-098-1342-05000950","19-4904CR-HY-098-1800-05001040","19-4904CR-HY-098-2318-04901140","19-4904CR-HY-099-0542-04801240","19-4904CR-HY-099-1154-04671330","19-4904CR-HY-099-1712-04601430","19-4904HO-HY-089-0042-08200570","19-4904HO-HY-090-0124-08200670","19-4904HO-HY-092-1730-08200770"],["054.0 056.0","052.0 075.0","051.0 085.0","050.0 095.0","050.0 104.0","049.0 114.0","056.7 146.0","056.7 136.0","058.0 127.0","059.0 117.0","059.0 107.0","060.0 097.0","061.0 087.0","061.0 078.0","062.0 068.0","063.3 058.0","072.0 056.0","071.0 066.0","071.0 076.0","081.0 117.0","081.0 127.0","081.0 107.0","081.0 097.0","082.0 097.0","082.0 087.0","082.0 077.0","082.0 067.0","092.0 039.0","092.0 048.0","092.0 058.0","092.0 068.0","092.0 078.0","092.0 088.0","092.0 098.0","092.0 108.0","092.0 117.0","092.0 127.0","092.0 137.0","103.3 128.0","103.3 119.0","103.3 111.0","102.0 103.0","102.0 094.0","102.0 084.0","102.0 074.0","102.0 064.0","102.0 054.0","101.0 044.0","101.0 034.0","111.0 038.0","111.0 048.0","111.0 058.0","111.0 068.0","112.0 078.0","112.0 088.0","112.0 098.0","112.0 107.0","112.0 117.0","113.3 127.0","113.3 137.0","126.0 132.0","126.0 122.0","125.0 112.0","125.0 102.0","124.0 093.0","124.0 083.0","123.3 073.0","123.3 063.0","122.0 053.0","122.0 044.0","044.0 048.5","042.0 068.0","041.0 077.0","039.0 096.0","036.7 115.0","036.0 125.0","024.0 120.0","025.0 111.0","026.0 102.0","028.0 092.0","029.0 083.0","030.0 074.0","031.0 065.0","033.3 055.0","034.0 046.0","035.0 037.0","044.0 049.0","054.0 056.0","053.3 066.0","052.0 075.0","051.0 085.0","050.0 095.0","050.0 104.0","049.0 114.0","048.0 124.0","046.7 133.0","046.0 143.0","082.0 057.0","082.0 067.0","082.0 077.0"],["NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST"],[null,null,null,null,null,null,null,null,null,null,null,-190.33,-151.22,null,null,null,null,null,null,-292.3,null,null,null,-187.06,-173.59,-127.69,null,-48.54,-89.33,null,null,null,null,null,null,-365.31,null,-444.63,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,-127.69],[38.833333,38.583333,38.475,38.333333,38.233333,37.833333,35.366666,35.433333,35.833333,36.066666,36.283333,36.475,36.691666,36.85,37.075,37.25,35.816666,35.393333,35.066666,32.083333,31.783333,32.366666,32.666666,32.833333,32.95,33.25,33.55,32.666666,32.35,32.05,31.708333,31.433333,31.116666,30.841666,30.5,30.183333,29.75,29.541666,27.8,28.283333,28.533333,28.85,29.116666,29.483333,29.866666,30.25,30.675,31.008333,31.366666,29.383333,29.2,28.783333,28.341666,28.058333,27.716666,27.333333,26.95,26.616666,26.25,26,23.916666,24.083333,24.616666,25.133333,25.433333,25.85,26.266666,26.616666,27.083333,27.5,40.833333,40.55,40.2,39.966666,39.783333,39.75,41.866666,41.975,42.066666,42.158333,42.266666,42.416666,42.466666,42.5,42.566666,42.658333,40.7,38.833333,38.616666,38.466666,38.25,38.05,37.866666,37.766666,37.533333,37.333333,37.166666,33.833333,33.533333,33.25],[-124.083333,-125.8,-126.666666,-127.516666,-128.366666,-129.05,-130.216666,-129.45,-128.7,-127.916666,-127.1,-126.316666,-125.533333,-124.8,-123.966666,-123.233333,-121.833333,-122.558333,-123.333333,-124.916666,-125.633333,-124.216666,-123.5,-123.666666,-122.8,-122.083333,-121.35,-118.166666,-118.883333,-119.516666,-120.266666,-120.883333,-121.566666,-122.183333,-122.85,-123.616666,-124.275,-124.95,-122.866666,-122.383333,-121.841666,-121.316666,-120.8,-120.216666,-119.5,-118.833333,-118.508333,-117.5,-116.925,-116,-116.766666,-117.35,-118.05,-118.691666,-119.275,-119.866666,-120.575,-121.05,-121.75,-122.166666,-120.333333,-119.883333,-119.35,-118.85,-118.166666,-117.616666,-117.05,-116.616666,-115.908333,-115.3,-124.833333,-126.4,-127.633333,-129.183333,-130.7,-131.6,-133.083333,-132.116666,-131.233333,-130.25,-129.466666,-128.566666,-127.616666,-126.6,-125.883333,-125.066666,-124.75,-124.083333,-124.963333,-125.8,-126.783333,-127.533333,-128.2,-128.85,-129.8,-130.666666,-131.333333,-120.666666,-121.366666,-122.083333],[54,52,51,50,50,49,56.7,56.7,58,59,59,60,61,61,62,63.3,72,71,71,81,81,81,81,82,82,82,82,92,92,92,92,92,92,92,92,92,92,92,103.3,103.3,103.3,102,102,102,102,102,102,101,101,111,111,111,111,112,112,112,112,112,113.3,113.3,126,126,125,125,124,124,123.3,123.3,122,122,44,42,41,39,36.7,36,24,25,26,28,29,30,31,33.3,34,35,44,54,53.3,52,51,50,50,49,48,46.7,46,82,82,82],[54,52,51,50,50,49,56.7,56.7,58,59,59,60,61,61,62,63,72,71,71,81,81,81,81,82,82,82,82,92,92,92,92,92,92,92,92,92,92,92,103,103,103,102,102,102,102,102,102,101,101,111,111,111,111,112,112,112,112,112,113,113,126,126,125,125,124,124,123,123,122,122,44,42,41,39,36.7,36,24,25,26,28,29,30,31,33,34,35,44,54,53,52,51,50,50,49,48,46.7,46,82,82,82],[53.8,51.5,50.3,49.2,48,48.4,56.5,57.7,57.5,58.1,58.8,59.5,60.1,60.9,61.6,62.3,71.40000000000001,71.7,71.5,81,80.8,81.3,81.5,80.40000000000001,81.7,81.90000000000001,82.2,92.7,92.59999999999999,92.5,92.40000000000001,92.3,92.2,92.09999999999999,92.09999999999999,91.8,92.2,91.7,103.5,102.5,102.6,102.4,102.4,102.1,102,101.8,100.7,101.4,101.1,111.8,110.9,111.4,111.8,111.6,111.7,112.1,112.2,112.5,112.5,112.7,125.6,125.9,124.8,123.8,124,123.5,122.9,122.4,122,121.5,43.6,41.9,41,39.1,37,35.5,23.9,25.2,26.4,27.8,28.8,29.8,31.3,33.1,34.1,35.2,44.4,53.8,53,52,51,50.4,49.9,49.1,48.2,47.4,46.8,82.40000000000001,82.2,81.90000000000001],[56,75,85,95,104,114,146,136,127,117,107,97,87,78,68,58,56,66,76,117,127,107,97,97.3,87,77,67,39,48,58,68,78,88,98,108,117,127,137,128,119,111,103,94,84,74,64,54,44,34,38,48,58,68,78,88,98,107,117,127,137,132,122,112,102,93,83,73,63,53,44,48.5,68,77,96,115,125,120,111,102,92,83,74,65,55,46,37,49,56,66,75,85,95,104,114,124,133,143,57,67,77],[56,75,85,95,104,114,146,136,127,117,107,97,87,78,68,58,56,66,76,117,127,107,97,97,87,77,67,39,48,58,68,78,88,98,108,117,127,137,128,119,111,103,94,84,74,64,54,44,34,38,48,58,68,78,88,98,107,117,127,137,132,122,112,102,93,83,73,63,53,44,48.5,68,77,96,115,125,120,111,102,92,83,74,65,55,46,37,49,56,66,75,85,95,104,114,124,133,143,57,67,77],[55.8,75.09999999999999,84.7,94.3,103.7,113.7,145.8,137.4,126.4,116.5,106.3,96.7,86.90000000000001,78.09999999999999,67.8,58.8,54.9,65.7,76.40000000000001,116.7,126.9,106.9,96.8,97.3,87,76.90000000000001,66.7,38.4,48.6,57.9,68.7,77.7,87.7,96.59999999999999,106.7,117.6,128.4,137.5,128.3,119,110.9,102.5,94.59999999999999,85.2,74.2,63.7,56.9,43.1,34,38,48.1,57.9,69.2,78.8,88.09999999999999,97.8,108.9,117,127.9,134.7,130,123.4,113,103.1,92.8,83.2,73.40000000000001,65.7,54,43.8,48.5,66.09999999999999,80.90000000000001,98,114.3,123.3,120.1,110.1,101.1,91,82.7,72.90000000000001,63.5,53.4,46,37.4,48.6,55.8,66.3,76,87.59999999999999,96.7,104.9,112.3,123.7,134.1,142.1,57.1,67,76.90000000000001],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","HORIZON","HORIZON","HORIZON"],["31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31HO","31HO","31HO","31HO","31HO","31HO","31HO","31HO","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31HO","31HO","31HO"],["HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["054 56","052 75","051 85","050 95","050 104","049 114","057 146","057 136","058 127","059 117","059 107","060 97","061 87","061 78","062 68","063 58","072 56","071 66","071 76","081 117","081 127","081 107","081 97","082 57","082 87","082 77","082 67","092 39","092 48","092 58","092 68","092 78","092 88","092 98","092 108","092 117","092 127","092 137","103 128","103 119","103 111","102 103","102 94","102 84","102 74","102 64","102 54","101 44","101 34","111 38","111 48","111 58","111 68","112 78","112 88","112 98","112 107","112 117","113 127","113 137","126 132","126 122","125 112","125 102","124 93","124 83","123 73","123 63","122 53","122 44","44 49 A","042 68","041 77","039 96","037 115","036 125","024 120","025 111","026 102","028 92","029 83","030 74","031 65","033 55","034 36","035 37","044 49","054 56","053 66","052 75","051 85","050 95","050 104","049 114","048 124","047 133","046 143","082 57","082 67","082 77"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv"],[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],["2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["1949-03-01T09:30:00Z","1949-03-01T21:12:00Z","1949-03-02T03:54:00Z","1949-03-02T10:42:00Z","1949-03-02T17:06:00Z","1949-03-03T00:36:00Z","1949-03-04T05:06:00Z","1949-03-04T11:54:00Z","1949-03-04T17:42:00Z","1949-03-04T23:54:00Z","1949-03-05T06:12:00Z","1949-03-05T11:48:00Z","1949-03-05T18:00:00Z","1949-03-05T23:30:00Z","1949-03-06T05:18:00Z","1949-03-06T10:30:00Z","1949-03-07T00:00:00Z","1949-03-07T05:24:00Z","1949-03-08T05:18:00Z","1949-03-14T00:00:00Z","1949-03-14T06:36:00Z","1949-03-14T20:30:00Z","1949-03-15T02:24:00Z","1949-03-15T03:06:00Z","1949-03-15T09:48:00Z","1949-03-15T16:06:00Z","1949-03-15T21:54:00Z","1949-02-28T22:42:00Z","1949-03-01T07:00:00Z","1949-03-01T13:36:00Z","1949-03-01T20:12:00Z","1949-03-02T02:24:00Z","1949-03-02T09:06:00Z","1949-03-02T16:18:00Z","1949-03-02T23:54:00Z","1949-03-03T06:12:00Z","1949-03-03T12:30:00Z","1949-03-03T19:06:00Z","1949-03-04T12:12:00Z","1949-03-04T19:24:00Z","1949-03-05T00:48:00Z","1949-03-05T06:54:00Z","1949-03-05T12:36:00Z","1949-03-05T18:54:00Z","1949-03-06T01:36:00Z","1949-03-06T08:00:00Z","1949-03-06T14:30:00Z","1949-03-06T21:00:00Z","1949-03-07T03:06:00Z","1949-03-07T17:18:00Z","1949-03-07T23:42:00Z","1949-03-08T06:06:00Z","1949-03-08T12:36:00Z","1949-03-08T18:36:00Z","1949-03-09T00:30:00Z","1949-03-09T06:24:00Z","1949-03-09T12:42:00Z","1949-03-09T18:18:00Z","1949-03-10T00:30:00Z","1949-03-10T05:12:00Z","1949-03-10T23:48:00Z","1949-03-11T04:42:00Z","1949-03-11T11:06:00Z","1949-03-11T17:30:00Z","1949-03-11T23:06:00Z","1949-03-12T05:12:00Z","1949-03-12T11:24:00Z","1949-03-12T18:06:00Z","1949-03-13T01:42:00Z","1949-03-13T09:06:00Z","1949-03-28T06:06:00Z","1949-04-01T14:18:00Z","1949-04-02T00:30:00Z","1949-04-02T13:48:00Z","1949-04-03T00:36:00Z","1949-04-03T07:18:00Z","1949-04-03T22:48:00Z","1949-04-04T05:24:00Z","1949-04-04T11:18:00Z","1949-04-04T17:30:00Z","1949-04-04T22:24:00Z","1949-04-05T04:06:00Z","1949-04-05T10:42:00Z","1949-04-05T16:42:00Z","1949-04-05T21:42:00Z","1949-04-06T04:30:00Z","1949-04-06T16:48:00Z","1949-04-07T15:48:00Z","1949-04-07T20:30:00Z","1949-04-08T01:42:00Z","1949-04-08T07:48:00Z","1949-04-08T13:42:00Z","1949-04-08T18:00:00Z","1949-04-08T23:18:00Z","1949-04-09T05:42:00Z","1949-04-09T11:54:00Z","1949-04-09T17:12:00Z","1949-03-30T00:42:00Z","1949-03-31T01:24:00Z","1949-04-02T17:30:00Z"],["st60-ln55_hist","st80-ln55_hist","st80-ln55_hist","st100-ln50_hist","st100-ln50_hist","st120-ln50_hist","st140-ln60_hist","st140-ln60_hist","st110-ln60_hist","st110-ln60_hist","st110-ln60_hist","st100-ln60","st90-ln60","st80-ln60","st70-ln60","st60-ln63.3","st55-ln70","st70-ln73.3","st80-ln70","st110-ln80_hist","st110-ln80_hist","st110-ln80_hist","st100-ln80","st100-ln80","st90-ln83.3","st80-ln83.3","st70-ln83.3","st40-ln93.3","st50-ln93.3","st60-ln93.3","st70-ln93.3","st80-ln93.3","st90-ln93.3","st100-ln93.3","st110-ln93.3","st120-ln93.3","st120-ln90_hist","st140-ln90_hist","st120-ln100_hist","st120-ln100_hist","st120-ln100_hist","st100-ln100_hist","st100-ln100_hist","st80-ln100_hist","st80-ln100_hist","st60-ln100_hist","st60-ln100_hist","st40-ln100_hist","st40-ln100_hist","st40-ln110_hist","st40-ln110_hist","st60-ln110_hist","st60-ln110_hist","st80-ln110_hist","st80-ln110_hist","st100-ln110_hist","st100-ln110_hist","st120-ln110_hist","st120-ln110_hist","st140-ln110_hist","st140-ln130_hist","st120-ln130_hist","st120-ln120_hist","st100-ln120_hist","st100-ln120_hist","st80-ln120_hist","st80-ln120_hist","st60-ln120_hist","st60-ln120_hist","st40-ln120_hist","st40-ln40_hist","st60-ln40_hist","st80-ln40_hist","st100-ln40_hist","st120-ln40_hist","st120-ln40_hist","st120-ln20_hist","st120-ln30_hist","st100-ln30_hist","st100-ln30_hist","st80-ln30_hist","st80-ln30_hist","st60-ln30_hist","st60-ln30_hist","st40-ln30_hist","st40-ln40_hist","st40-ln40_hist","st60-ln55_hist","st60-ln55_hist","st80-ln55_hist","st80-ln55_hist","st100-ln50_hist","st100-ln50_hist","st120-ln50_hist","st120-ln50_hist","st140-ln50_hist","st140-ln50_hist","st55-ln83.3","st70-ln83.3","st80-ln83.3"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_id<\/th>\n      <th>cruise_key<\/th>\n      <th>cast_key<\/th>\n      <th>sta_key<\/th>\n      <th>sta_code<\/th>\n      <th>distance<\/th>\n      <th>lat_dec<\/th>\n      <th>lon_dec<\/th>\n      <th>rpt_line<\/th>\n      <th>st_line<\/th>\n      <th>ac_line<\/th>\n      <th>rpt_sta<\/th>\n      <th>st_station<\/th>\n      <th>ac_sta<\/th>\n      <th>bottom_depth_m<\/th>\n      <th>ship_name<\/th>\n      <th>ship_code<\/th>\n      <th>data_type<\/th>\n      <th>order_occ<\/th>\n      <th>event_num<\/th>\n      <th>cruz_leg<\/th>\n      <th>orig_sta_id<\/th>\n      <th>data_or<\/th>\n      <th>int_chl<\/th>\n      <th>int_c14<\/th>\n      <th>inc_str<\/th>\n      <th>inc_end<\/th>\n      <th>pst_lan<\/th>\n      <th>civil_t<\/th>\n      <th>_source_file<\/th>\n      <th>_source_row<\/th>\n      <th>_ingested_at<\/th>\n      <th>_source_uuid<\/th>\n      <th>datetime_utc<\/th>\n      <th>grid_key<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,5,6,7,8,9,10,11,12,13,14,18,19,23,24,30]},{"name":"cast_id","targets":0},{"name":"cruise_key","targets":1},{"name":"cast_key","targets":2},{"name":"sta_key","targets":3},{"name":"sta_code","targets":4},{"name":"distance","targets":5},{"name":"lat_dec","targets":6},{"name":"lon_dec","targets":7},{"name":"rpt_line","targets":8},{"name":"st_line","targets":9},{"name":"ac_line","targets":10},{"name":"rpt_sta","targets":11},{"name":"st_station","targets":12},{"name":"ac_sta","targets":13},{"name":"bottom_depth_m","targets":14},{"name":"ship_name","targets":15},{"name":"ship_code","targets":16},{"name":"data_type","targets":17},{"name":"order_occ","targets":18},{"name":"event_num","targets":19},{"name":"cruz_leg","targets":20},{"name":"orig_sta_id","targets":21},{"name":"data_or","targets":22},{"name":"int_chl","targets":23},{"name":"int_c14","targets":24},{"name":"inc_str","targets":25},{"name":"inc_end","targets":26},{"name":"pst_lan","targets":27},{"name":"civil_t","targets":28},{"name":"_source_file","targets":29},{"name":"_source_row","targets":30},{"name":"_ingested_at","targets":31},{"name":"_source_uuid","targets":32},{"name":"datetime_utc","targets":33},{"name":"grid_key","targets":34}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="datatables html-widget html-fill-item" id="htmlwidget-a6397fe4f1e887bc8f61" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a6397fe4f1e887bc8f61">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35545\" data-max=\"35644\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-373.994\" data-max=\"-0.419\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"29.84492\" data-max=\"34.45137\" data-scale=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-123.99703\" data-max=\"-117.28398\" data-scale=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"80\" data-max=\"93.4\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"80\" data-max=\"93.4\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"80\" data-max=\"93.4\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"26.4\" data-max=\"120\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"26.4\" data-max=\"120\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"26.4\" data-max=\"120\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"15\" data-max=\"4332\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"57\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"70\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4.9\" data-max=\"199\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35546\" data-max=\"35645\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1610773533000\" data-max=\"1620938237000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>casts — last 100 of 35,644 rows<\/caption>","data":[[35545,35546,35547,35548,35549,35550,35551,35552,35553,35554,35555,35556,35557,35558,35559,35560,35561,35562,35563,35564,35565,35566,35567,35568,35569,35570,35571,35572,35573,35574,35575,35576,35577,35578,35579,35580,35581,35582,35583,35584,35585,35586,35587,35588,35589,35590,35591,35592,35593,35594,35595,35596,35597,35598,35599,35600,35601,35602,35603,35604,35605,35606,35607,35608,35609,35610,35611,35612,35613,35614,35615,35616,35617,35618,35619,35620,35621,35622,35623,35624,35625,35626,35627,35628,35629,35630,35631,35632,35633,35634,35635,35636,35637,35638,35639,35640,35641,35642,35643,35644],["2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-01-16-C-33RL","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S","2021-05-04-C-325S"],["20-2101RL-MX-025-03:49-08180469","20-2101RL-MX-026-22:54-08330394","20-2101RL-MX-027-00:09-08330406","20-2101RL-MX-027-02:08-08330420","20-2101RL-MX-024-22:13-08330510","20-2101RL-MX-024-18:12-08330550","20-2101RL-MX-030-07:33-08330600","20-2101RL-MX-030-01:52-08330700","20-2101RL-MX-029-20:03-08330800","20-2101RL-MX-029-14:43-08330900","20-2101RL-MX-029-09:12-08331000","20-2101RL-MX-027-15:57-08540358","20-2101RL-MX-023-12:42-08670330","20-2101RL-MX-023-14:56-08670350","20-2101RL-MX-023-19:23-08670400","20-2101RL-MX-023-23:12-08670450","20-2101RL-MX-024-02:57-08670500","20-2101RL-MX-024-06:14-08670550","20-2101RL-MX-024-10:29-08670600","20-2101RL-MX-028-08:06-08670700","20-2101RL-MX-028-14:56-08670800","20-2101RL-MX-028-20:50-08670900","20-2101RL-MX-029-03:11-08671000","20-2101RL-MX-023-11:37-08680325","20-2101RL-MX-023-06:53-08850301","20-2101RL-MX-023-02:33-09000277","20-2101RL-MX-023-03:22-09000280","20-2101RL-MX-022-21:16-09000300","20-2101RL-MX-022-16:55-09000350","20-2101RL-MX-022-13:50-09000370","20-2101RL-MX-022-08:12-09000450","20-2101RL-MX-022-02:40-09000530","20-2101RL-MX-021-21:40-09000600","20-2101RL-MX-021-13:36-09000700","20-2101RL-MX-021-06:55-09000800","20-2101RL-MX-020-23:56-09000900","20-2101RL-MX-020-15:58-09001000","20-2101RL-MX-019-21:31-09001100","20-2101RL-MX-019-12:38-09001200","20-2101RL-MX-016-11:22-09170264","20-2101RL-MX-016-05:05-09330267","20-2101RL-MX-016-14:33-09330280","20-2101RL-MX-016-19:46-09330300","20-2101RL-MX-016-23:10-09330350","20-2101RL-MX-017-03:15-09330400","20-2101RL-MX-017-07:10-09330450","20-2101RL-MX-017-10:56-09330500","20-2101RL-MX-017-14:57-09330550","20-2101RL-MX-017-18:50-09330600","20-2101RL-MX-018-00:49-09330700","20-2101RL-MX-018-06:39-09330800","20-2101RL-MX-018-12:06-09330900","20-2101RL-MX-018-18:19-09331000","20-2101RL-MX-019-00:14-09331100","20-2101RL-MX-019-05:52-09331200","20-2101RL-MX-016-07:46-09340264","20-21055S-MX-133-00:23-08000510","20-21055S-MX-132-20:35-08000550","20-21055S-MX-132-16:36-08000600","20-21055S-MX-132-11:02-08000700","20-21055S-MX-132-05:25-08000800","20-21055S-MX-131-23:31-08000900","20-21055S-MX-131-17:42-08001000","20-21055S-MX-133-04:19-08180469","20-21055S-MX-133-09:18-08330406","20-21055S-MX-133-10:58-08330420","20-21055S-MX-133-17:39-08330510","20-21055S-MX-133-20:37-08330550","20-21055S-MX-129-15:49-08670330","20-21055S-MX-129-18:06-08670350","20-21055S-MX-129-22:47-08670400","20-21055S-MX-130-02:31-08670450","20-21055S-MX-130-06:09-08670500","20-21055S-MX-130-09:20-08670550","20-21055S-MX-130-13:20-08670600","20-21055S-MX-130-21:37-08670700","20-21055S-MX-129-07:09-09000280","20-21055S-MX-129-04:18-09000300","20-21055S-MX-129-00:33-09000350","20-21055S-MX-128-21:06-09000370","20-21055S-MX-128-16:08-09000450","20-21055S-MX-128-10:01-09000530","20-21055S-MX-128-03:52-09000600","20-21055S-MX-127-20:24-09000700","20-21055S-MX-127-14:23-09000800","20-21055S-MX-127-07:34-09000900","20-21055S-MX-127-01:37-09001000","20-21055S-MX-124-18:17-09330267","20-21055S-MX-124-21:02-09330280","20-21055S-MX-124-23:28-09330300","20-21055S-MX-125-03:09-09330350","20-21055S-MX-125-06:56-09330400","20-21055S-MX-125-10:30-09330450","20-21055S-MX-125-14:26-09330500","20-21055S-MX-125-18:14-09330550","20-21055S-MX-125-22:02-09330600","20-21055S-MX-126-03:43-09330700","20-21055S-MX-126-09:09-09330800","20-21055S-MX-126-14:32-09330900","20-21055S-MX-126-20:05-09331000"],["081.8 046.9","083.3 039.4","083.3 040.6","083.3 042.0","083.3 051.0","083.3 055.0","083.3 060.0","083.3 070.0","083.3 080.0","083.3 090.0","083.3 100.0","085.4 035.8","086.7 033.0","086.7 035.0","086.7 040.0","086.7 045.0","086.7 050.0","086.7 055.0","086.7 060.0","086.7 070.0","086.7 080.0","086.7 090.0","086.7 100.0","086.8 032.5","088.5 030.1","090.0 027.7","090.0 028.0","090.0 030.0","090.0 035.0","090.0 037.0","090.0 045.0","090.0 053.0","090.0 060.0","090.0 070.0","090.0 080.0","090.0 090.0","090.0 100.0","090.0 110.0","090.0 120.0","091.7 026.4","093.3 026.7","093.3 028.0","093.3 030.0","093.3 035.0","093.3 040.0","093.3 045.0","093.3 050.0","093.3 055.0","093.3 060.0","093.3 070.0","093.3 080.0","093.3 090.0","093.3 100.0","093.3 110.0","093.3 120.0","093.4 026.4","080.0 051.0","080.0 055.0","080.0 060.0","080.0 070.0","080.0 080.0","080.0 090.0","080.0 100.0","081.8 046.9","083.3 040.6","083.3 042.0","083.3 051.0","083.3 055.0","086.7 033.0","086.7 035.0","086.7 040.0","086.7 045.0","086.7 050.0","086.7 055.0","086.7 060.0","086.7 070.0","090.0 028.0","090.0 030.0","090.0 035.0","090.0 037.0","090.0 045.0","090.0 053.0","090.0 060.0","090.0 070.0","090.0 080.0","090.0 090.0","090.0 100.0","093.3 026.7","093.3 028.0","093.3 030.0","093.3 035.0","093.3 040.0","093.3 045.0","093.3 050.0","093.3 055.0","093.3 060.0","093.3 070.0","093.3 080.0","093.3 090.0","093.3 100.0"],["ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST","ST"],[-15.025,-1.652,-5.753,-11.445,-47.259,-63.282,-83.07299999999999,-122.972,-162.529,-202.452,-242.673,-0.864,-3.394,-11.369,-31.245,-51.064,-71.23399999999999,-91.087,-111.067,-149.617,-190.786,-229.987,-270.368,-1.926,-3.132,-0.419,-1.406,-9.227,-29.435,-37.532,-69.119,-101.138,-129.259,-168.55,-208.869,-248.639,-288.022,-328.646,-368.211,-1.661,-2.284,-7.241,-14.998,-34.825,-54.964,-75.14,-94.768,-114.942,-134.434,-174.754,-214.442,-254.586,-294.153,-334.226,-373.994,-2.03,-2.63,-18.424,-38.473,-78.274,-118.844,-158.123,-198.214,-14.652,-5.933,-11.385,-47.25,-63.418,-3.36,-11.066,-30.924,-51.385,-71.384,-91.399,-110.985,-150.717,-1.437,-9.518000000000001,-29.26,-37.486,-69.15600000000001,-101.217,-129.555,-169.034,-208.646,-248.869,-288.526,-2.23,-7.409,-15.209,-35.101,-55.124,-74.977,-94.998,-114.857,-134.591,-174.357,-214.705,-254.377,-294.297],[34.26978,34.25708,34.2223,34.17443,33.87018,33.74488,33.57747,33.24223,32.90873,32.58237,32.24402,34.01542,33.88783,33.82557,33.65443,33.49172,33.31938,33.15527,32.98767,32.66487,32.3197,31.99093,31.65817,33.88683,33.65528,33.49117,33.4841,33.4177,33.24923,33.17907,32.91502,32.64903,32.41308,32.08938,31.75108,31.418,31.09348,30.74392,30.41127,33.2394,32.95398,32.91113,32.8479,32.68103,32.51062,32.34548,32.17977,32.0135,31.84187,31.5126,31.17847,30.84167,30.5117,30.17573,29.84492,32.94658,34.45137,34.3249,34.15008,33.81613,33.47673,33.14918,32.81178,34.27558,34.22398,34.18142,33.87863,33.74207,33.88877,33.82632,33.65827,33.49012,33.31778,33.1514,32.9883,32.66203,33.48618,33.41537,33.25273,33.18407,32.91702,32.64777,32.40977,32.08038,31.75127,31.41483,31.08388,32.9532,32.9105,32.84803,32.6814,32.51407,32.3495,32.17938,32.01338,31.8463,31.51513,31.17682,30.84638,30.5135],[-120.03412,-119.3364,-119.4078,-119.50687,-120.1265,-120.41073,-120.75218,-121.44013,-122.11872,-122.8083,-123.49357,-118.84167,-118.48917,-118.63077,-118.97192,-119.31698,-119.66273,-120.00628,-120.34963,-121.01067,-121.71362,-122.38037,-123.06887,-118.43988,-118.08487,-117.74968,-117.7685,-117.90298,-118.25207,-118.38988,-118.93323,-119.48353,-119.96382,-120.63698,-121.32088,-121.99342,-122.66078,-123.33613,-123.99703,-117.46332,-117.3066,-117.39132,-117.52592,-117.86517,-118.20842,-118.55558,-118.88912,-119.23417,-119.55917,-120.24778,-120.91607,-121.59043,-122.25413,-122.92268,-123.58568,-117.28398,-120.52332,-120.80522,-121.1497,-121.84102,-122.54358,-123.22187,-123.90932,-120.0299,-119.41328,-119.51042,-120.13233,-120.41192,-118.48908,-118.62428,-118.96717,-119.3233,-119.66507,-120.01077,-120.3482,-121.03402,-117.77067,-117.90807,-118.25047,-118.39232,-118.9355,-119.48447,-119.96828,-120.64172,-121.31592,-121.99643,-122.66543,-117.30428,-117.39482,-117.53093,-117.8718,-118.21453,-118.55467,-118.89412,-119.23213,-119.5659,-120.24052,-120.9209,-121.58903,-122.25867],[81.8,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,85.40000000000001,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.8,88.5,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91.7,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.40000000000001,80,80,80,80,80,80,80,81.8,83.3,83.3,83.3,83.3,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,90,90,90,90,90,90,90,90,90,90,90,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3],[81.8,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,85.40000000000001,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.8,88.5,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91.7,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.40000000000001,80,80,80,80,80,80,80,81.8,83.3,83.3,83.3,83.3,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,90,90,90,90,90,90,90,90,90,90,90,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3],[81.8,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,83.3,85.40000000000001,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.8,88.59999999999999,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91.7,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.40000000000001,80,80,80,80,80,80,80,81.8,83.3,83.3,83.3,83.3,86.7,86.7,86.7,86.7,86.7,86.7,86.7,86.7,90,90,90,90,90,90,90,90,90,90,90,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3,93.3],[46.9,39.4,40.6,42,51,55,60,70,80,90,100,35.8,33,35,40,45,50,55,60,70,80,90,100,32.5,30.1,27.7,28,30,35,37,45,53,60,70,80,90,100,110,120,26.4,26.7,28,30,35,40,45,50,55,60,70,80,90,100,110,120,26.4,51,55,60,70,80,90,100,46.9,40.6,42,51,55,33,35,40,45,50,55,60,70,28,30,35,37,45,53,60,70,80,90,100,26.7,28,30,35,40,45,50,55,60,70,80,90,100],[46.9,39.4,40.6,42,51,55,60,70,80,90,100,35.8,33,35,40,45,50,55,60,70,80,90,100,32.5,30.1,27.7,28,30,35,37,45,53,60,70,80,90,100,110,120,26.4,26.7,28,30,35,40,45,50,55,60,70,80,90,100,110,120,26.4,51,55,60,70,80,90,100,46.9,40.6,42,51,55,33,35,40,45,50,55,60,70,28,30,35,37,45,53,60,70,80,90,100,26.7,28,30,35,40,45,50,55,60,70,80,90,100],[47,39.6,40.6,42,51,55,60,70,79.90000000000001,89.90000000000001,100,35.9,33,35,40,45,50,55,60,69.7,80,89.8,100,32.5,30.3,27.7,28,30,35,37.1,45,53,60.1,69.90000000000001,80.09999999999999,90,99.90000000000001,110.1,120,26.4,26.7,28,29.9,34.9,40,45,49.9,55,59.9,70,80,90,100,110,120,26.5,51,55,60,70,80.2,90,100.1,46.9,40.6,42,51,55.1,33,34.9,39.9,45,50.1,55.1,60,70,28,30,35,37.1,45,53.1,60.2,70.09999999999999,80,90.09999999999999,100,26.7,28,30,35,40,45,50,55,59.9,69.90000000000001,80,90,100],[583,15,28,153,100,975,1380,3833,4212,4292,4184,35,54,663,744,1673,74,1226,729,3813,4071,4104,4132,20,19,33,63,617,364,1193,1719,1335,847,3853,3721,3887,4006,4044,4253,21,58,641,846,645,1692,1371,1480,1606,2030,3965,3861,4118,4221,3658,4103,20,72,754,2197,3622,3992,4217,4332,580,34,115,97,968,57,637,781,1545,77,1211,723,3766,68,610,322,1184,1699,1325,864,3812,3644,3840,3972,65,624,850,624,1652,1341,1480,1591,1833,3920,3818,4080,4140],["REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","REUBEN LASKER","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA","BELL M. SHIMADA"],["33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","33UD","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322","3322"],["MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX","MX"],[43,45,46,47,42,41,57,56,55,54,53,48,34,35,36,37,38,39,40,49,50,51,52,33,32,30,31,29,28,27,26,25,24,23,22,21,20,19,18,3,1,4,5,6,7,8,9,10,11,12,13,14,15,16,17,2,39,38,37,36,35,34,33,40,41,42,43,44,25,26,27,28,29,30,31,32,24,23,22,21,20,19,18,17,16,15,14,1,2,3,4,5,6,7,8,9,10,11,12,13],[53,55,57,59,52,51,70,69,68,67,66,61,44,45,46,47,48,49,50,62,62,64,65,43,42,40,41,39,38,37,36,35,34,33,32,29,28,27,26,5,3,6,7,8,9,10,11,12,13,14,16,16,22,23,25,4,45,44,43,42,41,40,39,46,47,48,49,50,31,32,33,34,35,36,37,38,28,27,26,25,24,23,22,21,20,19,18,2,3,4,5,6,7,8,9,10,13,15,16,17],["1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0","1.0"],["81.8 46.9","83.3 39.4","83.3 40.6","83.3 42.0","83.3 51.0","83.3 55.0","83.3 60.0","83.3 70.0","83.3 80.0","83.3 90.0","83.3 100.0","85.4 35.8","86.7 33.0","86.7 35.0","86.7 40.0","86.7 45.0","86.7 50.0","86.7 55.0","86.7 60.0","86.7 70.0","86.7 80.0","86.7 90.0","86.7 100.0","86.8 32.5","88.5 30.1","90.0 27.7","90.0 28.0","90.0 30.0","90.0 35.0","90.0 37.0","90.0 45.0","90.0 53.0","90.0 60.0","90.0 70.0","90.0 80.0","90.0 90.0","90.0 100.0","90.0 110.0","90.0 120.0","91.7 26.4","93.3 26.7","93.3 28.0","93.3 30.0","93.3 35.0","93.3 40.0","93.3 45.0","93.3 50.0","93.3 55.0","93.3 60.0","93.3 70.0","93.3 80.0","93.3 90.0","93.3 100.0","93.3 110.0","93.3 120.0","93.4 26.4","80.0 51.0","80.0 55.0","80.0 60.0","80.0 70.0","80.0 80.0","80.0 90.0","80.0 100.0","81.8 46.9","83.3 40.6","83.3 42.0","83.3 51.0","83.3 55.0","86.7 33.0","86.7 35.0","86.7 40.0","86.7 45.0","86.7 50.0","86.7 55.0","86.7 60.0","86.7 70.0","90.0 28.0","90.0 30.0","90.0 35.0","90.0 37.0","90.0 45.0","90.0 53.0","90.0 60.0","90.0 70.0","90.0 80.0","90.0 90.0","90.0 100.0","93.3 26.7","93.3 28.0","93.3 30.0","93.3 35.0","93.3 40.0","93.3 45.0","93.3 50.0","93.3 55.0","93.3 60.0","93.3 70.0","93.3 80.0","93.3 90.0","93.3 100.0"],["3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101","3101"],[84.90000000000001,7.7,4.9,54.5,51.4,46.9,28.7,50.7,41.9,33.7,47.7,24.7,64.7,27,83.7,69.7,51.9,33.6,39.2,40.3,25,51.4,41.4,39.4,26,26,73.59999999999999,39.6,33.2,22.7,44.3,34.6,31.6,30.4,31.2,21.1,29.7,27.8,26.1,18.8,54.6,33.9,35,30.9,33.8,20.7,27.1,22.4,20.7,30.2,34.1,25.8,27.2,26.5,34.9,24.6,162.8,78.90000000000001,49.5,40.2,31,34.5,39.1,86.2,50.3,48.2,65.59999999999999,136.4,93.8,52.2,79,66.7,96.3,42.5,30.2,35.5,199,90.40000000000001,50.5,55.7,43.1,173.1,115.1,45.8,42.6,39.2,28.2,91.90000000000001,29.4,101.7,31.3,31.3,38.5,61.7,60.8,63.8,43.4,31.9,28.7,29.6],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv"],[35546,35547,35548,35549,35550,35551,35552,35553,35554,35555,35556,35557,35558,35559,35560,35561,35562,35563,35564,35565,35566,35567,35568,35569,35570,35571,35572,35573,35574,35575,35576,35577,35578,35579,35580,35581,35582,35583,35584,35585,35586,35587,35588,35589,35590,35591,35592,35593,35594,35595,35596,35597,35598,35599,35600,35601,35602,35603,35604,35605,35606,35607,35608,35609,35610,35611,35612,35613,35614,35615,35616,35617,35618,35619,35620,35621,35622,35623,35624,35625,35626,35627,35628,35629,35630,35631,35632,35633,35634,35635,35636,35637,35638,35639,35640,35641,35642,35643,35644,35645],["2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["2021-01-25T03:49:45Z","2021-01-26T22:54:21Z","2021-01-27T00:09:49Z","2021-01-27T02:08:33Z","2021-01-24T22:13:37Z","2021-01-24T18:12:35Z","2021-01-30T07:33:32Z","2021-01-30T01:52:32Z","2021-01-29T20:03:06Z","2021-01-29T14:43:47Z","2021-01-29T09:12:42Z","2021-01-27T15:57:25Z","2021-01-23T12:42:39Z","2021-01-23T14:56:09Z","2021-01-23T19:23:30Z","2021-01-23T23:12:38Z","2021-01-24T02:57:36Z","2021-01-24T06:14:10Z","2021-01-24T10:29:18Z","2021-01-28T08:06:59Z","2021-01-28T14:56:17Z","2021-01-28T20:50:09Z","2021-01-29T03:11:02Z","2021-01-23T11:37:28Z","2021-01-23T06:53:45Z","2021-01-23T02:33:56Z","2021-01-23T03:22:09Z","2021-01-22T21:16:37Z","2021-01-22T16:55:54Z","2021-01-22T13:50:16Z","2021-01-22T08:12:57Z","2021-01-22T02:40:44Z","2021-01-21T21:40:30Z","2021-01-21T13:36:17Z","2021-01-21T06:55:21Z","2021-01-20T23:56:50Z","2021-01-20T15:58:36Z","2021-01-19T21:31:43Z","2021-01-19T12:38:54Z","2021-01-16T11:22:29Z","2021-01-16T05:05:33Z","2021-01-16T14:33:08Z","2021-01-16T19:46:29Z","2021-01-16T23:10:47Z","2021-01-17T03:15:52Z","2021-01-17T07:10:26Z","2021-01-17T10:56:39Z","2021-01-17T14:57:53Z","2021-01-17T18:50:18Z","2021-01-18T00:49:45Z","2021-01-18T06:39:37Z","2021-01-18T12:06:31Z","2021-01-18T18:19:43Z","2021-01-19T00:14:28Z","2021-01-19T05:52:02Z","2021-01-16T07:46:52Z","2021-05-13T00:23:36Z","2021-05-12T20:35:24Z","2021-05-12T16:36:01Z","2021-05-12T11:02:07Z","2021-05-12T05:25:29Z","2021-05-11T23:31:18Z","2021-05-11T17:42:00Z","2021-05-13T04:19:37Z","2021-05-13T09:18:25Z","2021-05-13T10:58:14Z","2021-05-13T17:39:00Z","2021-05-13T20:37:17Z","2021-05-09T15:49:44Z","2021-05-09T18:06:06Z","2021-05-09T22:47:31Z","2021-05-10T02:31:54Z","2021-05-10T06:09:56Z","2021-05-10T09:20:04Z","2021-05-10T13:20:48Z","2021-05-10T21:37:27Z","2021-05-09T07:09:23Z","2021-05-09T04:18:09Z","2021-05-09T00:33:21Z","2021-05-08T21:06:53Z","2021-05-08T16:08:08Z","2021-05-08T10:01:12Z","2021-05-08T03:52:37Z","2021-05-07T20:24:22Z","2021-05-07T14:23:59Z","2021-05-07T07:34:26Z","2021-05-07T01:37:03Z","2021-05-04T18:17:58Z","2021-05-04T21:02:38Z","2021-05-04T23:28:01Z","2021-05-05T03:09:43Z","2021-05-05T06:56:03Z","2021-05-05T10:30:14Z","2021-05-05T14:26:51Z","2021-05-05T18:14:51Z","2021-05-05T22:02:07Z","2021-05-06T03:43:31Z","2021-05-06T09:09:56Z","2021-05-06T14:32:54Z","2021-05-06T20:05:35Z"],["st45-ln83.3","st40-ln83.3","st40-ln83.3","st40-ln83.3","st50-ln83.3","st55-ln83.3","st60-ln83.3","st70-ln83.3","st80-ln83.3","st90-ln83.3","st100-ln83.3","st35-ln86.7","st35-ln86.7","st35-ln86.7","st40-ln86.7","st45-ln86.7","st50-ln86.7","st55-ln86.7","st60-ln86.7","st70-ln86.7","st80-ln86.7","st90-ln86.7","st100-ln86.7","st30-ln86.7","st30-ln90","st30-ln90","st30-ln90","st30-ln90","st35-ln90","st35-ln90","st45-ln90","st55-ln90","st60-ln90","st70-ln90","st80-ln90","st90-ln90","st100-ln90","st110-ln90","st120-ln90","st25-ln93.3","st25-ln93.3","st30-ln93.3","st30-ln93.3","st35-ln93.3","st40-ln93.3","st45-ln93.3","st50-ln93.3","st55-ln93.3","st60-ln93.3","st70-ln93.3","st80-ln93.3","st90-ln93.3","st100-ln93.3","st110-ln93.3","st120-ln93.3","st25-ln93.3","st50-ln80","st55-ln80","st60-ln80","st70-ln80","st80-ln80","st90-ln80","st100-ln80","st45-ln83.3","st40-ln83.3","st40-ln83.3","st50-ln83.3","st55-ln83.3","st35-ln86.7","st35-ln86.7","st40-ln86.7","st45-ln86.7","st50-ln86.7","st55-ln86.7","st60-ln86.7","st70-ln86.7","st30-ln90","st30-ln90","st35-ln90","st35-ln90","st45-ln90","st55-ln90","st60-ln90","st70-ln90","st80-ln90","st90-ln90","st100-ln90","st25-ln93.3","st30-ln93.3","st30-ln93.3","st35-ln93.3","st40-ln93.3","st45-ln93.3","st50-ln93.3","st55-ln93.3","st60-ln93.3","st70-ln93.3","st80-ln93.3","st90-ln93.3","st100-ln93.3"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_id<\/th>\n      <th>cruise_key<\/th>\n      <th>cast_key<\/th>\n      <th>sta_key<\/th>\n      <th>sta_code<\/th>\n      <th>distance<\/th>\n      <th>lat_dec<\/th>\n      <th>lon_dec<\/th>\n      <th>rpt_line<\/th>\n      <th>st_line<\/th>\n      <th>ac_line<\/th>\n      <th>rpt_sta<\/th>\n      <th>st_station<\/th>\n      <th>ac_sta<\/th>\n      <th>bottom_depth_m<\/th>\n      <th>ship_name<\/th>\n      <th>ship_code<\/th>\n      <th>data_type<\/th>\n      <th>order_occ<\/th>\n      <th>event_num<\/th>\n      <th>cruz_leg<\/th>\n      <th>orig_sta_id<\/th>\n      <th>data_or<\/th>\n      <th>int_chl<\/th>\n      <th>int_c14<\/th>\n      <th>inc_str<\/th>\n      <th>inc_end<\/th>\n      <th>pst_lan<\/th>\n      <th>civil_t<\/th>\n      <th>_source_file<\/th>\n      <th>_source_row<\/th>\n      <th>_ingested_at<\/th>\n      <th>_source_uuid<\/th>\n      <th>datetime_utc<\/th>\n      <th>grid_key<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,5,6,7,8,9,10,11,12,13,14,18,19,23,24,30]},{"name":"cast_id","targets":0},{"name":"cruise_key","targets":1},{"name":"cast_key","targets":2},{"name":"sta_key","targets":3},{"name":"sta_code","targets":4},{"name":"distance","targets":5},{"name":"lat_dec","targets":6},{"name":"lon_dec","targets":7},{"name":"rpt_line","targets":8},{"name":"st_line","targets":9},{"name":"ac_line","targets":10},{"name":"rpt_sta","targets":11},{"name":"st_station","targets":12},{"name":"ac_sta","targets":13},{"name":"bottom_depth_m","targets":14},{"name":"ship_name","targets":15},{"name":"ship_code","targets":16},{"name":"data_type","targets":17},{"name":"order_occ","targets":18},{"name":"event_num","targets":19},{"name":"cruz_leg","targets":20},{"name":"orig_sta_id","targets":21},{"name":"data_or","targets":22},{"name":"int_chl","targets":23},{"name":"int_c14","targets":24},{"name":"inc_str","targets":25},{"name":"inc_end","targets":26},{"name":"pst_lan","targets":27},{"name":"civil_t","targets":28},{"name":"_source_file","targets":29},{"name":"_source_row","targets":30},{"name":"_ingested_at","targets":31},{"name":"_source_uuid","targets":32},{"name":"datetime_utc","targets":33},{"name":"grid_key","targets":34}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</section>
<section id="bottle-895371-rows" class="level3" data-number="19.2">
<h3 data-number="19.2" class="anchored" data-anchor-id="bottle-895371-rows"><span class="header-section-number">19.2</span> <code>bottle</code> (895,371 rows)</h3>
<div class="datatables html-widget html-fill-item" id="htmlwidget-4c758d403201c74156f2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4c758d403201c74156f2">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1203\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1770323326529.89\" data-max=\"1770323326529.89\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>bottle — first 100 of 895,371 rows<\/caption>","data":[[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],["054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","054.0 056.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","052.0 075.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","051.0 085.0","050.0 095.0","050.0 095.0","050.0 095.0","050.0 095.0","050.0 095.0","050.0 095.0","050.0 095.0","050.0 095.0"],["19-4903CR-HY-060-0930-05400560-0000A-3","19-4903CR-HY-060-0930-05400560-0008A-3","19-4903CR-HY-060-0930-05400560-0010A-7","19-4903CR-HY-060-0930-05400560-0019A-3","19-4903CR-HY-060-0930-05400560-0020A-7","19-4903CR-HY-060-0930-05400560-0030A-7","19-4903CR-HY-060-0930-05400560-0039A-3","19-4903CR-HY-060-0930-05400560-0050A-7","19-4903CR-HY-060-0930-05400560-0058A-3","19-4903CR-HY-060-0930-05400560-0075A-7","19-4903CR-HY-060-0930-05400560-0078A-3","19-4903CR-HY-060-0930-05400560-0100A-7","19-4903CR-HY-060-0930-05400560-0117A-3","19-4903CR-HY-060-0930-05400560-0125A-7","19-4903CR-HY-060-0930-05400560-0150A-7","19-4903CR-HY-060-0930-05400560-0152A-3","19-4903CR-HY-060-0930-05400560-0200A-7","19-4903CR-HY-060-0930-05400560-0221A-3","19-4903CR-HY-060-0930-05400560-0250A-7","19-4903CR-HY-060-0930-05400560-0285A-3","19-4903CR-HY-060-0930-05400560-0300A-7","19-4903CR-HY-060-0930-05400560-0373A-3","19-4903CR-HY-060-0930-05400560-0400A-7","19-4903CR-HY-060-0930-05400560-0500A-7","19-4903CR-HY-060-0930-05400560-0598A-3","19-4903CR-HY-060-0930-05400560-0600A-7","19-4903CR-HY-060-0930-05400560-0700A-7","19-4903CR-HY-060-0930-05400560-0800A-7","19-4903CR-HY-060-0930-05400560-0896A-3","19-4903CR-HY-060-2112-05200750-0000B-3","19-4903CR-HY-060-2112-05200750-0010A-3","19-4903CR-HY-060-2112-05200750-0020A-7","19-4903CR-HY-060-2112-05200750-0024A-3","19-4903CR-HY-060-2112-05200750-0030A-7","19-4903CR-HY-060-2112-05200750-0047A-3","19-4903CR-HY-060-2112-05200750-0050A-7","19-4903CR-HY-060-2112-05200750-0071A-3","19-4903CR-HY-060-2112-05200750-0075A-7","19-4903CR-HY-060-2112-05200750-0094A-3","19-4903CR-HY-060-2112-05200750-0100A-7","19-4903CR-HY-060-2112-05200750-0125A-7","19-4903CR-HY-060-2112-05200750-0140A-3","19-4903CR-HY-060-2112-05200750-0150A-7","19-4903CR-HY-060-2112-05200750-0189A-3","19-4903CR-HY-060-2112-05200750-0200A-7","19-4903CR-HY-060-2112-05200750-0250A-7","19-4903CR-HY-060-2112-05200750-0282A-3","19-4903CR-HY-060-2112-05200750-0300A-7","19-4903CR-HY-060-2112-05200750-0379A-3","19-4903CR-HY-060-2112-05200750-0400A-7","19-4903CR-HY-060-2112-05200750-0500A-7","19-4903CR-HY-060-2112-05200750-0565A-3","19-4903CR-HY-060-2112-05200750-0600A-7","19-4903CR-HY-060-2112-05200750-0700A-7","19-4903CR-HY-060-2112-05200750-0800A-7","19-4903CR-HY-060-2112-05200750-0840A-3","19-4903CR-HY-060-2112-05200750-0900A-7","19-4903CR-HY-060-2112-05200750-1000A-7","19-4903CR-HY-060-2112-05200750-1100A-7","19-4903CR-HY-060-2112-05200750-1200A-7","19-4903CR-HY-060-2112-05200750-1203A-3","19-4903CR-HY-061-0354-05100850-0000B-3","19-4903CR-HY-061-0354-05100850-0010A-3","19-4903CR-HY-061-0354-05100850-0020A-7","19-4903CR-HY-061-0354-05100850-0022A-3","19-4903CR-HY-061-0354-05100850-0030A-7","19-4903CR-HY-061-0354-05100850-0038A-3","19-4903CR-HY-061-0354-05100850-0049A-3","19-4903CR-HY-061-0354-05100850-0050A-7","19-4903CR-HY-061-0354-05100850-0055A-3","19-4903CR-HY-061-0354-05100850-0073A-3","19-4903CR-HY-061-0354-05100850-0075A-7","19-4903CR-HY-061-0354-05100850-0099A-3","19-4903CR-HY-061-0354-05100850-0100A-7","19-4903CR-HY-061-0354-05100850-0125A-7","19-4903CR-HY-061-0354-05100850-0150A-7","19-4903CR-HY-061-0354-05100850-0191A-3","19-4903CR-HY-061-0354-05100850-0200A-7","19-4903CR-HY-061-0354-05100850-0250A-7","19-4903CR-HY-061-0354-05100850-0290A-3","19-4903CR-HY-061-0354-05100850-0300A-7","19-4903CR-HY-061-0354-05100850-0400A-7","19-4903CR-HY-061-0354-05100850-0488A-3","19-4903CR-HY-061-0354-05100850-0500A-7","19-4903CR-HY-061-0354-05100850-0600A-7","19-4903CR-HY-061-0354-05100850-0700A-7","19-4903CR-HY-061-0354-05100850-0789A-3","19-4903CR-HY-061-0354-05100850-0800A-7","19-4903CR-HY-061-0354-05100850-0900A-7","19-4903CR-HY-061-0354-05100850-1000A-7","19-4903CR-HY-061-0354-05100850-1100A-7","19-4903CR-HY-061-0354-05100850-1134A-3","19-4903CR-HY-061-1042-05000950-0000B-3","19-4903CR-HY-061-1042-05000950-0008A-3","19-4903CR-HY-061-1042-05000950-0010A-7","19-4903CR-HY-061-1042-05000950-0019A-3","19-4903CR-HY-061-1042-05000950-0020A-7","19-4903CR-HY-061-1042-05000950-0030A-7","19-4903CR-HY-061-1042-05000950-0040A-3","19-4903CR-HY-061-1042-05000950-0050A-7"],[0,8,10,19,20,30,39,50,58,75,78,100,117,125,150,152,200,221,250,285,300,373,400,500,598,600,700,800,896,0,10,20,24,30,47,50,71,75,94,100,125,140,150,189,200,250,282,300,379,400,500,565,600,700,800,840,900,1000,1100,1200,1203,0,10,20,22,30,38,49,50,55,73,75,99,100,125,150,191,200,250,290,300,400,488,500,600,700,789,800,900,1000,1100,1134,0,8,10,19,20,30,40,50],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["3.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","7.0","7.0","3.0","3.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","7.0","7.0","3.0","7.0","7.0","7.0","7.0","3.0","3.0","3.0","7.0","3.0","7.0","3.0","3.0","7.0","3.0","3.0","7.0","3.0","7.0","7.0","7.0","3.0","7.0","7.0","3.0","7.0","7.0","3.0","7.0","7.0","7.0","3.0","7.0","7.0","7.0","7.0","3.0","3.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0"],[9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv"],[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],["2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_id<\/th>\n      <th>bottle_id<\/th>\n      <th>sta_key<\/th>\n      <th>depth_key<\/th>\n      <th>depth_m<\/th>\n      <th>btl_num<\/th>\n      <th>rec_ind<\/th>\n      <th>depth_qual<\/th>\n      <th>inc_tim<\/th>\n      <th>_source_file<\/th>\n      <th>_source_row<\/th>\n      <th>_ingested_at<\/th>\n      <th>_source_uuid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,4,5,7,10]},{"name":"cast_id","targets":0},{"name":"bottle_id","targets":1},{"name":"sta_key","targets":2},{"name":"depth_key","targets":3},{"name":"depth_m","targets":4},{"name":"btl_num","targets":5},{"name":"rec_ind","targets":6},{"name":"depth_qual","targets":7},{"name":"inc_tim","targets":8},{"name":"_source_file","targets":9},{"name":"_source_row","targets":10},{"name":"_ingested_at","targets":11},{"name":"_source_uuid","targets":12}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="datatables html-widget html-fill-item" id="htmlwidget-cce5022bd0c5e360a6fa" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cce5022bd0c5e360a6fa">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35640\" data-max=\"35644\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"895299\" data-max=\"895398\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"518\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"12\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"3\" data-max=\"7\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"895273\" data-max=\"895372\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1770323326529.89\" data-max=\"1770323326529.89\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>bottle — last 100 of 895,371 rows<\/caption>","data":[[35640,35640,35640,35640,35640,35640,35640,35640,35640,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35641,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35642,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644],[895299,895300,895301,895302,895303,895304,895305,895306,895307,895308,895309,895310,895311,895312,895313,895314,895315,895316,895317,895318,895319,895320,895321,895322,895323,895324,895325,895326,895327,895328,895329,895330,895331,895332,895333,895334,895335,895336,895337,895338,895339,895340,895341,895342,895343,895344,895345,895346,895347,895348,895349,895350,895351,895352,895353,895354,895355,895356,895357,895358,895359,895360,895361,895362,895363,895364,895365,895366,895367,895368,895369,895370,895371,895372,895373,895374,895375,895376,895377,895378,895379,895380,895381,895382,895383,895384,895385,895386,895387,895388,895389,895390,895391,895392,895393,895394,895395,895396,895397,895398],["093.3 060.0","093.3 060.0","093.3 060.0","093.3 060.0","093.3 060.0","093.3 060.0","093.3 060.0","093.3 060.0","093.3 060.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 070.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 080.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 090.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0","093.3 100.0"],["20-21055S-MX-125-2202-09330600-0199A-3","20-21055S-MX-125-2202-09330600-0200A-7","20-21055S-MX-125-2202-09330600-0250A-7","20-21055S-MX-125-2202-09330600-0273A-3","20-21055S-MX-125-2202-09330600-0300A-7","20-21055S-MX-125-2202-09330600-0378A-3","20-21055S-MX-125-2202-09330600-0400A-7","20-21055S-MX-125-2202-09330600-0500A-7","20-21055S-MX-125-2202-09330600-0516A-3","20-21055S-MX-126-0343-09330700-0000A-7","20-21055S-MX-126-0343-09330700-0003A-3","20-21055S-MX-126-0343-09330700-0010A-3","20-21055S-MX-126-0343-09330700-0020A-7","20-21055S-MX-126-0343-09330700-0030A-3","20-21055S-MX-126-0343-09330700-0050A-7","20-21055S-MX-126-0343-09330700-0051A-3","20-21055S-MX-126-0343-09330700-0071A-3","20-21055S-MX-126-0343-09330700-0075A-7","20-21055S-MX-126-0343-09330700-0100A-7","20-21055S-MX-126-0343-09330700-0101A-3","20-21055S-MX-126-0343-09330700-0125A-7","20-21055S-MX-126-0343-09330700-0150A-7","20-21055S-MX-126-0343-09330700-0151A-3","20-21055S-MX-126-0343-09330700-0200A-3","20-21055S-MX-126-0343-09330700-0250A-7","20-21055S-MX-126-0343-09330700-0271A-3","20-21055S-MX-126-0343-09330700-0300A-7","20-21055S-MX-126-0343-09330700-0381A-3","20-21055S-MX-126-0343-09330700-0400A-7","20-21055S-MX-126-0343-09330700-0500A-7","20-21055S-MX-126-0343-09330700-0514A-3","20-21055S-MX-126-0909-09330800-0000A-7","20-21055S-MX-126-0909-09330800-0003A-3","20-21055S-MX-126-0909-09330800-0010A-7","20-21055S-MX-126-0909-09330800-0010B-6","20-21055S-MX-126-0909-09330800-0020B-7","20-21055S-MX-126-0909-09330800-0030A-3","20-21055S-MX-126-0909-09330800-0030B-6","20-21055S-MX-126-0909-09330800-0050A-3","20-21055S-MX-126-0909-09330800-0070A-3","20-21055S-MX-126-0909-09330800-0075A-7","20-21055S-MX-126-0909-09330800-0100A-7","20-21055S-MX-126-0909-09330800-0101A-3","20-21055S-MX-126-0909-09330800-0125A-7","20-21055S-MX-126-0909-09330800-0150A-3","20-21055S-MX-126-0909-09330800-0200A-7","20-21055S-MX-126-0909-09330800-0203A-3","20-21055S-MX-126-0909-09330800-0250A-7","20-21055S-MX-126-0909-09330800-0270A-3","20-21055S-MX-126-0909-09330800-0300A-7","20-21055S-MX-126-0909-09330800-0380A-3","20-21055S-MX-126-0909-09330800-0400A-7","20-21055S-MX-126-0909-09330800-0500A-7","20-21055S-MX-126-0909-09330800-0512A-3","20-21055S-MX-126-1432-09330900-0000A-7","20-21055S-MX-126-1432-09330900-0003A-3","20-21055S-MX-126-1432-09330900-0010A-7","20-21055S-MX-126-1432-09330900-0011A-3","20-21055S-MX-126-1432-09330900-0020A-7","20-21055S-MX-126-1432-09330900-0030A-7","20-21055S-MX-126-1432-09330900-0032A-3","20-21055S-MX-126-1432-09330900-0050A-7","20-21055S-MX-126-1432-09330900-0052A-3","20-21055S-MX-126-1432-09330900-0071A-3","20-21055S-MX-126-1432-09330900-0075A-7","20-21055S-MX-126-1432-09330900-0100A-3","20-21055S-MX-126-1432-09330900-0125A-7","20-21055S-MX-126-1432-09330900-0150A-7","20-21055S-MX-126-1432-09330900-0151A-3","20-21055S-MX-126-1432-09330900-0200A-7","20-21055S-MX-126-1432-09330900-0201A-3","20-21055S-MX-126-1432-09330900-0250A-7","20-21055S-MX-126-1432-09330900-0271A-3","20-21055S-MX-126-1432-09330900-0300A-7","20-21055S-MX-126-1432-09330900-0381A-3","20-21055S-MX-126-1432-09330900-0400A-7","20-21055S-MX-126-1432-09330900-0500A-7","20-21055S-MX-126-1432-09330900-0518A-3","20-21055S-MX-126-2005-09331000-0000A-7","20-21055S-MX-126-2005-09331000-0003A-3","20-21055S-MX-126-2005-09331000-0010A-3","20-21055S-MX-126-2005-09331000-0010B-6","20-21055S-MX-126-2005-09331000-0020B-7","20-21055S-MX-126-2005-09331000-0030A-3","20-21055S-MX-126-2005-09331000-0050A-7","20-21055S-MX-126-2005-09331000-0051A-3","20-21055S-MX-126-2005-09331000-0069A-3","20-21055S-MX-126-2005-09331000-0075A-7","20-21055S-MX-126-2005-09331000-0100A-3","20-21055S-MX-126-2005-09331000-0125A-7","20-21055S-MX-126-2005-09331000-0150A-7","20-21055S-MX-126-2005-09331000-0151A-3","20-21055S-MX-126-2005-09331000-0200A-3","20-21055S-MX-126-2005-09331000-0250A-7","20-21055S-MX-126-2005-09331000-0300A-7","20-21055S-MX-126-2005-09331000-0304A-3","20-21055S-MX-126-2005-09331000-0379A-3","20-21055S-MX-126-2005-09331000-0400A-7","20-21055S-MX-126-2005-09331000-0500A-7","20-21055S-MX-126-2005-09331000-0516A-3"],[199,200,250,273,300,378,400,500,516,0,3,10,20,30,50,51,71,75,100,101,125,150,151,200,250,271,300,381,400,500,514,0,3,10,10,20,30,30,50,70,75,100,101,125,150,200,203,250,270,300,380,400,500,512,0,3,10,11,20,30,32,50,52,71,75,100,125,150,151,200,201,250,271,300,381,400,500,518,0,3,10,10,20,30,50,51,69,75,100,125,150,151,200,250,300,304,379,400,500,516],[4,null,null,3,null,2,null,null,1,null,11,10,null,9,null,8,7,null,null,6,null,null,5,4,null,3,null,2,null,null,1,null,12,null,11,null,9,10,8,7,null,null,6,null,5,null,4,null,3,null,2,null,null,1,null,11,null,10,null,null,9,null,8,7,null,6,null,null,5,null,4,null,3,null,2,null,null,1,null,12,10,11,null,9,null,8,7,null,6,null,null,5,4,null,null,3,2,null,null,1],["3.0","7.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","3.0","7.0","3.0","7.0","3.0","3.0","7.0","7.0","3.0","7.0","7.0","3.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","6.0","7.0","3.0","6.0","3.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","3.0","7.0","7.0","3.0","7.0","3.0","3.0","6.0","7.0","3.0","7.0","3.0","3.0","7.0","3.0","7.0","7.0","3.0","3.0","7.0","7.0","3.0","3.0","7.0","7.0","3.0"],[3,7,7,3,7,3,7,7,3,7,3,3,7,3,7,3,3,7,7,3,7,7,3,3,7,3,7,3,7,7,3,7,3,7,6,7,3,6,3,3,7,7,3,7,3,7,3,7,3,7,3,7,7,3,7,3,7,3,7,7,3,7,3,3,7,3,7,7,3,7,3,7,3,7,3,7,7,3,7,3,3,6,7,3,7,3,3,7,3,7,7,3,3,7,7,3,3,7,7,3],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Bottle.csv"],[895273,895274,895275,895276,895277,895278,895279,895280,895281,895282,895283,895284,895285,895286,895287,895288,895289,895290,895291,895292,895293,895294,895295,895296,895297,895298,895299,895300,895301,895302,895303,895304,895305,895306,895307,895308,895309,895310,895311,895312,895313,895314,895315,895316,895317,895318,895319,895320,895321,895322,895323,895324,895325,895326,895327,895328,895329,895330,895331,895332,895333,895334,895335,895336,895337,895338,895339,895340,895341,895342,895343,895344,895345,895346,895347,895348,895349,895350,895351,895352,895353,895354,895355,895356,895357,895358,895359,895360,895361,895362,895363,895364,895365,895366,895367,895368,895369,895370,895371,895372],["2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z","2026-02-05T20:28:46Z"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_id<\/th>\n      <th>bottle_id<\/th>\n      <th>sta_key<\/th>\n      <th>depth_key<\/th>\n      <th>depth_m<\/th>\n      <th>btl_num<\/th>\n      <th>rec_ind<\/th>\n      <th>depth_qual<\/th>\n      <th>inc_tim<\/th>\n      <th>_source_file<\/th>\n      <th>_source_row<\/th>\n      <th>_ingested_at<\/th>\n      <th>_source_uuid<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,4,5,7,10]},{"name":"cast_id","targets":0},{"name":"bottle_id","targets":1},{"name":"sta_key","targets":2},{"name":"depth_key","targets":3},{"name":"depth_m","targets":4},{"name":"btl_num","targets":5},{"name":"rec_ind","targets":6},{"name":"depth_qual","targets":7},{"name":"inc_tim","targets":8},{"name":"_source_file","targets":9},{"name":"_source_row","targets":10},{"name":"_ingested_at","targets":11},{"name":"_source_uuid","targets":12}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</section>
<section id="bottle_measurement-11135600-rows" class="level3" data-number="19.3">
<h3 data-number="19.3" class="anchored" data-anchor-id="bottle_measurement-11135600-rows"><span class="header-section-number">19.3</span> <code>bottle_measurement</code> (11,135,600 rows)</h3>
<div class="datatables html-widget html-fill-item" id="htmlwidget-cb331f5a770fba1639c8" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-cb331f5a770fba1639c8">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"234.1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>bottle_measurement — first 100 of 11,135,600 rows<\/caption>","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,13,14,14,14,14,14,14,14,15,15],["r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height","r_salinity_sva","r_temperature","salinity","sigma_theta","temperature","r_depth","r_dynamic_height"],[0,0,233,10.5,33.44,25.649,10.5,8,0.01,232.5,10.46,33.44,25.656,10.46,10,0.02,232.8,10.46,33.437,25.654,10.46,19,0.04,234.1,10.45,33.42,25.643,10.45,20,0.04,234,10.45,33.421,25.643,10.45,30,0.07000000000000001,233.5,10.45,33.431,25.651,10.45,39,0.09,233,10.45,33.44,25.658,10.45,50,0.11,231,10.23,33.424,25.682,10.24,58,0.13,228.5,10.05,33.42,25.71,10.06,75,0.17,220.1,9.85,33.494,25.801,9.859999999999999,78,0.18,218.6,9.82,33.51,25.819,9.83,101,0.22,211.2,9.66,33.58,25.9,9.67,118,0.26,204.5,9.49,33.64,25.975,9.5,126,0.27,198.2,9.31,33.689,26.043,9.32,151,0.32],[null,null,null,null,2,null,1,null,null,null,null,2,null,2,null,null,null,null,3,null,2,null,null,null,null,2,null,2,null,null,null,null,3,null,2,null,null,null,null,3,null,2,null,null,null,null,2,null,2,null,null,null,null,3,null,2,null,null,null,null,2,null,2,null,null,null,null,3,null,2,null,null,null,null,2,null,2,null,null,null,null,3,null,2,null,null,null,null,2,null,2,null,null,null,null,3,null,2,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bottle_measurement_id<\/th>\n      <th>bottle_id<\/th>\n      <th>measurement_type<\/th>\n      <th>measurement_value<\/th>\n      <th>measurement_prec<\/th>\n      <th>measurement_qual<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,3,4]},{"name":"bottle_measurement_id","targets":0},{"name":"bottle_id","targets":1},{"name":"measurement_type","targets":2},{"name":"measurement_value","targets":3},{"name":"measurement_prec","targets":4},{"name":"measurement_qual","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="datatables html-widget html-fill-item" id="htmlwidget-3ce0ffa3fc445d583d74" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3ce0ffa3fc445d583d74">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"11135501\" data-max=\"11135600\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"895392\" data-max=\"895398\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"520\" data-scale=\"5\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"5\" data-max=\"34\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>bottle_measurement — last 100 of 11,135,600 rows<\/caption>","data":[[11135501,11135502,11135503,11135504,11135505,11135506,11135507,11135508,11135509,11135510,11135511,11135512,11135513,11135514,11135515,11135516,11135517,11135518,11135519,11135520,11135521,11135522,11135523,11135524,11135525,11135526,11135527,11135528,11135529,11135530,11135531,11135532,11135533,11135534,11135535,11135536,11135537,11135538,11135539,11135540,11135541,11135542,11135543,11135544,11135545,11135546,11135547,11135548,11135549,11135550,11135551,11135552,11135553,11135554,11135555,11135556,11135557,11135558,11135559,11135560,11135561,11135562,11135563,11135564,11135565,11135566,11135567,11135568,11135569,11135570,11135571,11135572,11135573,11135574,11135575,11135576,11135577,11135578,11135579,11135580,11135581,11135582,11135583,11135584,11135585,11135586,11135587,11135588,11135589,11135590,11135591,11135592,11135593,11135594,11135595,11135596,11135597,11135598,11135599,11135600],[895392,895392,895392,895392,895392,895392,895392,895392,895393,895393,895393,895393,895393,895393,895393,895393,895393,895393,895393,895393,895393,895393,895393,895394,895394,895394,895394,895394,895394,895394,895394,895394,895394,895394,895394,895394,895394,895394,895395,895395,895395,895395,895395,895395,895395,895395,895395,895395,895395,895395,895395,895395,895395,895396,895396,895396,895396,895396,895396,895396,895396,895396,895396,895396,895396,895396,895396,895396,895397,895397,895397,895397,895397,895397,895397,895397,895397,895397,895397,895397,895397,895397,895397,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398,895398],["r_ammonium","r_depth","r_oxygen_umol_kg","r_temperature","salinity","sigma_theta","silicate","temperature","ammonia","nitrate","nitrite","oxygen_ml_l","oxygen_saturation","oxygen_umol_kg","phosphate","r_ammonium","r_depth","r_oxygen_umol_kg","r_temperature","salinity","sigma_theta","silicate","temperature","ammonia","nitrate","nitrite","oxygen_ml_l","oxygen_saturation","oxygen_umol_kg","phosphate","r_ammonium","r_depth","r_oxygen_umol_kg","r_temperature","salinity","sigma_theta","silicate","temperature","ammonia","nitrate","nitrite","oxygen_ml_l","oxygen_saturation","oxygen_umol_kg","phosphate","r_ammonium","r_depth","r_oxygen_umol_kg","r_temperature","salinity","sigma_theta","silicate","temperature","ammonia","nitrate","nitrite","oxygen_ml_l","oxygen_saturation","oxygen_umol_kg","phosphate","r_ammonium","r_depth","r_oxygen_umol_kg","r_temperature","salinity","sigma_theta","silicate","temperature","ammonia","nitrate","nitrite","oxygen_ml_l","oxygen_saturation","oxygen_umol_kg","phosphate","r_ammonium","r_depth","r_oxygen_umol_kg","r_temperature","salinity","sigma_theta","silicate","temperature","ammonia","nitrate","nitrite","oxygen_ml_l","oxygen_saturation","oxygen_umol_kg","phosphate","r_ammonium","r_depth","r_dynamic_height","r_oxygen_umol_kg","r_salinity_sva","r_temperature","salinity","sigma_theta","silicate","temperature"],[0,252,92.40000000000001,7.91,26.55545,26.55545,41.62,7.933,0,33.9,0,1.581,23.41,68.77,2.58,0,302,68.77,7.31,26.668,26.668,49.52,7.331,0,34.14,0,1.526,22.59,66.38,2.6,0,306,66.38,7.29,26.6716,26.6716,50.15,7.303,0,38.17,0,0.843,12.28,36.66,2.9,0,382,36.66,6.57,26.82726,26.82726,62.95,6.606,0,38.7,0,0.733,10.64,31.88,2.94,0,403,31.88,6.42,26.86069,26.86069,65.52,6.42,0,41.2,0,0.393,5.63,17.09,3.13,0,504,17.09,5.84,27.01054,27.01054,77.78,5.877,0,41.6,0,0.392,5.61,17.05,3.16,0,520,1.026,17.05,111.2,5.78,27.01281,27.01281,79.73999999999999,5.822],[null,null,null,null,31,null,null,34,null,null,null,null,null,null,null,null,null,null,null,23,null,null,34,null,null,null,null,null,null,null,null,null,null,null,22,null,null,34,null,null,null,null,null,null,null,null,null,null,null,12,null,null,34,null,null,null,null,null,null,null,null,null,null,null,10,null,null,34,null,null,null,null,null,null,null,null,null,null,null,5,null,null,34,null,null,null,null,null,null,null,null,null,null,null,null,null,5,null,null,34],[null,null,null,null,"92.0","6.0",null,"2.0","4.0",null,"8.0","6.0","6.0",null,null,null,null,null,null,"68.0","6.0",null,"1.0","4.0",null,"8.0","6.0","6.0",null,null,null,null,null,null,"66.0","6.0",null,"1.0","4.0",null,"8.0","6.0","6.0",null,null,null,null,null,null,"36.0","6.0",null,"0.0","4.0",null,"8.0","6.0","6.0",null,null,null,null,null,null,"31.0","6.0",null,"0.0","4.0",null,"8.0","6.0","6.0",null,null,null,null,null,null,"17.0","6.0",null,"0.0","4.0",null,"8.0",null,null,null,null,null,null,null,null,null,null,"17.0",null,null,"0.0"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>bottle_measurement_id<\/th>\n      <th>bottle_id<\/th>\n      <th>measurement_type<\/th>\n      <th>measurement_value<\/th>\n      <th>measurement_prec<\/th>\n      <th>measurement_qual<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,3,4]},{"name":"bottle_measurement_id","targets":0},{"name":"bottle_id","targets":1},{"name":"measurement_type","targets":2},{"name":"measurement_value","targets":3},{"name":"measurement_prec","targets":4},{"name":"measurement_qual","targets":5}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</section>
<section id="cast_condition-235513-rows" class="level3" data-number="19.4">
<h3 data-number="19.4" class="anchored" data-anchor-id="cast_condition-235513-rows"><span class="header-section-number">19.4</span> <code>cast_condition</code> (235,513 rows)</h3>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ceb56bb3370a12ba17b6" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ceb56bb3370a12ba17b6">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"35\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"29\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>cast_condition — first 100 of 235,513 rows<\/caption>","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],[1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10,11,11,11,12,12,12,13,13,13,14,14,14,15,15,15,16,16,16,17,17,17,18,18,18,19,19,20,20,20,21,21,21,22,22,22,23,23,23,24,24,25,25,25,26,26,27,27,28,28,28,29,29,29,30,30,30,31,31,31,32,32,32,33,33,33,34,34,34,35,35],["weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_speed","weather_code","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction","wind_speed","weather_code","wind_direction"],[2,23,18,4,16,5,6,23,5,2,18,8,7,27,13,1,25,13,6,23,13,1,25,18,1,29,18,9,27,18,1,27,18,1,29,18,1,27,13,1,27,8,1,27,5,1,18,5,1,29,5,4,29,8,1,29,1,11,8,1,23,8,2,11,8,2,20,8,1,5,2,23,5,1,8,1,5,1,0,0,0,27,5,2,27,2,2,27,2,2,17,2,9,17,13,1,18,5,1,24]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_condition_id<\/th>\n      <th>cast_id<\/th>\n      <th>condition_type<\/th>\n      <th>condition_value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,3]},{"name":"cast_condition_id","targets":0},{"name":"cast_id","targets":1},{"name":"condition_type","targets":2},{"name":"condition_value","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="datatables html-widget html-fill-item" id="htmlwidget-92420bcf103cd5e07058" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-92420bcf103cd5e07058">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"235414\" data-max=\"235513\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"35634\" data-max=\"35644\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"1017.8\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>cast_condition — last 100 of 235,513 rows<\/caption>","data":[[235414,235415,235416,235417,235418,235419,235420,235421,235422,235423,235424,235425,235426,235427,235428,235429,235430,235431,235432,235433,235434,235435,235436,235437,235438,235439,235440,235441,235442,235443,235444,235445,235446,235447,235448,235449,235450,235451,235452,235453,235454,235455,235456,235457,235458,235459,235460,235461,235462,235463,235464,235465,235466,235467,235468,235469,235470,235471,235472,235473,235474,235475,235476,235477,235478,235479,235480,235481,235482,235483,235484,235485,235486,235487,235488,235489,235490,235491,235492,235493,235494,235495,235496,235497,235498,235499,235500,235501,235502,235503,235504,235505,235506,235507,235508,235509,235510,235511,235512,235513],[35634,35634,35634,35634,35634,35634,35634,35635,35635,35635,35635,35635,35635,35635,35635,35636,35636,35636,35636,35636,35637,35637,35637,35637,35637,35638,35638,35638,35638,35638,35638,35638,35638,35638,35638,35638,35638,35638,35639,35639,35639,35639,35639,35639,35639,35639,35639,35639,35639,35639,35639,35640,35640,35640,35640,35640,35640,35640,35640,35640,35640,35640,35640,35640,35641,35641,35641,35641,35641,35642,35642,35642,35642,35642,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35643,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644,35644],["wave_direction","wave_height","wave_period","weather_code","wet_air_temp","wind_direction","wind_speed","barometric_pressure","dry_air_temp","wave_direction","wave_height","wave_period","wet_air_temp","wind_direction","wind_speed","barometric_pressure","dry_air_temp","wet_air_temp","wind_direction","wind_speed","barometric_pressure","dry_air_temp","wet_air_temp","wind_direction","wind_speed","barometric_pressure","cloud_amount","cloud_type","dry_air_temp","secchi_depth","visibility","wave_direction","wave_height","wave_period","weather_code","wet_air_temp","wind_direction","wind_speed","barometric_pressure","cloud_amount","cloud_type","dry_air_temp","secchi_depth","visibility","wave_direction","wave_height","wave_period","weather_code","wet_air_temp","wind_direction","wind_speed","barometric_pressure","cloud_amount","cloud_type","dry_air_temp","secchi_depth","visibility","wave_direction","wave_height","wave_period","weather_code","wet_air_temp","wind_direction","wind_speed","barometric_pressure","dry_air_temp","wet_air_temp","wind_direction","wind_speed","barometric_pressure","dry_air_temp","wet_air_temp","wind_direction","wind_speed","barometric_pressure","cloud_amount","cloud_type","dry_air_temp","secchi_depth","visibility","wave_direction","wave_height","wave_period","weather_code","wet_air_temp","wind_direction","wind_speed","barometric_pressure","cloud_amount","cloud_type","dry_air_temp","secchi_depth","visibility","wave_direction","wave_height","wave_period","weather_code","wet_air_temp","wind_direction","wind_speed"],[30,1,7,1,15.2,21,5,1012.9,18.5,22,2,8,15.6,25,7,1014.2,15.6,14.7,13,2,1013.4,15.6,14.7,17,1,1014.5,8,7,14.6,8,6,21,3,8,2,12.7,33,5,1015.6,8,7,13.8,15,6,13,3,8,2,12.7,18,5,1015.8,8,6,14.2,16,7,28,2,8,2,12.8,21,3,1015.4,13.6,12.5,30,7,1016.9,12.7,11.8,35,6,1017.6,8,6,13.1,12,6,30,3,8,2,11.9,29,7,1017.8,8,7,13,15,7,32,2,5,1,11.9,28,6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_condition_id<\/th>\n      <th>cast_id<\/th>\n      <th>condition_type<\/th>\n      <th>condition_value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,1,3]},{"name":"cast_condition_id","targets":0},{"name":"cast_id","targets":1},{"name":"condition_type","targets":2},{"name":"condition_value","targets":3}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</section>
<section id="measurement_type-47-rows" class="level3" data-number="19.5">
<h3 data-number="19.5" class="anchored" data-anchor-id="measurement_type-47-rows"><span class="header-section-number">19.5</span> <code>measurement_type</code> (47 rows)</h3>
<div class="datatables html-widget html-fill-item" id="htmlwidget-b2fa24b3279bfcdf2b42" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b2fa24b3279bfcdf2b42">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>measurement_type — all 47 rows<\/caption>","data":[["temperature","salinity","oxygen_ml_l","sigma_theta","oxygen_saturation","oxygen_umol_kg","chlorophyll_a","phaeopigment","phosphate","silicate","nitrite","nitrate","ammonia","c14_rep1","c14_rep2","c14_dark","c14_mean","light_pct","r_depth","r_temperature","r_salinity_sva","r_dynamic_height","r_ammonium","r_oxygen_umol_kg","dic_rep1","dic_rep2","alkalinity_rep1","alkalinity_rep2","ph_rep1","ph_rep2","wave_direction","wave_height","wave_period","wind_direction","wind_speed","barometric_pressure","dry_air_temp","wet_air_temp","weather_code","cloud_type","cloud_amount","visibility","secchi_depth","water_color","stage","size","tally"],["bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","cast","cast","cast","cast","cast","cast","cast","cast","cast","cast","cast","cast","cast","cast","ichthyo","ichthyo","ichthyo"],["Water temperature (QC'd)","Salinity - Practical Salinity Scale 1978 (QC'd)","Dissolved oxygen (QC'd)","Potential density (Sigma Theta)","Oxygen percent saturation","Dissolved oxygen (QC'd)","Chlorophyll-a measured fluorometrically","Phaeopigment measured fluorometrically","Phosphate concentration","Silicate concentration","Nitrite concentration","Nitrate concentration","Ammonia concentration (QC'd)","14C assimilation replicate 1","14C assimilation replicate 2","14C assimilation dark/control bottle","Mean 14C assimilation of replicates 1 and 2","Light intensity of incubation tubes","Reported depth from pressure (pre-QC)","Reported potential temperature (pre-QC)","Reported Specific Volume Anomaly (pre-QC); WARNING: different parameter/scale than salinity PSS-78","Reported dynamic height (no QC'd counterpart)","Reported ammonium concentration (pre-QC)","Reported oxygen (pre-QC)","Dissolved inorganic carbon replicate 1","Dissolved inorganic carbon replicate 2","Total alkalinity replicate 1","Total alkalinity replicate 2","pH replicate 1","pH replicate 2","Wave direction (abbreviated 360 degree azimuth)","Wave height","Wave period","Wind direction (abbreviated 360 degree azimuth)","Wind speed","Barometric pressure","Dry air temperature from sling psychrometer","Wet air temperature from sling psychrometer","WMO weather code (WMO 4501)","WMO cloud type code (WMO 0500)","Cloud amount in oktas (WMO 2700)","WMO visibility code (WMO 4300)","Secchi disk depth","Water color on Forel-Ule scale","Egg or larva developmental stage","Larva size measurement","Specimen count"],["degC","PSS-78","ml/L","kg/m3","%","umol/kg","ug/L","ug/L","umol/L","umol/L","umol/L","umol/L","umol/L","mgC/m3/hld","mgC/m3/hld","mgC/m3/hld","mgC/m3/hld","%","m","degC","10^-8 m3/kg","dyn m","umol/L","umol/kg","umol/kg","umol/kg","umol/kg","umol/kg","pH","pH","degrees","feet","seconds","degrees","knots","millibars","degC","degC",null,null,"oktas",null,"meters","Forel-Ule",null,"mm",null],["t_deg_c","salnty","o2ml_l","s_theta","o2sat","oxy_umol_kg","chlor_a","phaeop","po4u_m","si_o3u_m","no2u_m","no3u_m","nh3u_m","c14as1","c14as2","dark_as","mean_as","light_p","r_depth","r_temp","r_sal","r_dynht","r_nuts","r_oxy_umol_kg","dic1","dic2","ta1","ta2","p_h1","p_h2","wave_dir","wave_ht","wave_prd","wind_dir","wind_spd","barometer","dry_t","wet_t","wea","cloud_typ","cloud_amt","visibility","secchi","forel_u",null,null,null],["bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","bottle","casts","casts","casts","casts","casts","casts","casts","casts","casts","casts","casts","casts","casts","casts","ichthyo","ichthyo","ichthyo"],["ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_calcofi.org_bottle-database","ingest_swfsc.noaa.gov_calcofi-db","ingest_swfsc.noaa.gov_calcofi-db","ingest_swfsc.noaa.gov_calcofi-db"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>measurement_type<\/th>\n      <th>dataset<\/th>\n      <th>description<\/th>\n      <th>units<\/th>\n      <th>_source_column<\/th>\n      <th>_source_table<\/th>\n      <th>_source_workflow<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"name":"measurement_type","targets":0},{"name":"dataset","targets":1},{"name":"description","targets":2},{"name":"units","targets":3},{"name":"_source_column","targets":4},{"name":"_source_table","targets":5},{"name":"_source_workflow","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># casts_derived is a VIEW, preview separately</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT * FROM casts_derived LIMIT 100"</span>) <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption  =</span> <span class="st">"casts_derived — first 100 rows (VIEW)"</span>,</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">filter   =</span> <span class="st">"top"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-74036abff32b7d852378" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-74036abff32b7d852378">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"100\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-444.63\" data-max=\"-48.54\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"23.916666\" data-max=\"42.658333\" data-scale=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-133.083334\" data-max=\"-115.3\" data-scale=\"6\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"24\" data-max=\"126\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"24\" data-max=\"126\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"23.9\" data-max=\"125.9\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"146\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"146\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"34\" data-max=\"145.8\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"101\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"time\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-657595080000\" data-max=\"-654158880000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"59\" data-max=\"99\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"17957\" data-max=\"17997\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"23\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"58.5000000000001\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"115\" data-max=\"133\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"57.9999600000002\" data-scale=\"15\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\" disabled=\"\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","caption":"<caption>casts_derived — first 100 rows (VIEW)<\/caption>","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],["1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31CR","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31HO","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-01-C-31NS","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31CR","1949-03-28-C-31HO","1949-03-28-C-31HO","1949-03-28-C-31HO"],["19-4903CR-HY-060-0930-05400560","19-4903CR-HY-060-2112-05200750","19-4903CR-HY-061-0354-05100850","19-4903CR-HY-061-1042-05000950","19-4903CR-HY-061-1706-05001040","19-4903CR-HY-062-0036-04901140","19-4903CR-HY-063-0506-05671460","19-4903CR-HY-063-1154-05671360","19-4903CR-HY-063-1742-05801270","19-4903CR-HY-063-2354-05901170","19-4903CR-HY-064-0612-05901070","19-4903CR-HY-064-1148-06000970","19-4903CR-HY-064-1800-06100870","19-4903CR-HY-064-2330-06100780","19-4903CR-HY-065-0518-06200680","19-4903CR-HY-065-1030-06330580","19-4903CR-HY-066-0000-07200560","19-4903CR-HY-066-0524-07100660","19-4903CR-HY-067-0518-07100760","19-4903HO-HY-073-0073-08101170","19-4903HO-HY-073-0636-08101270","19-4903HO-HY-073-2030-08101070","19-4903HO-HY-074-0224-08100970","19-4903HO-HY-074-0306-08200970","19-4903HO-HY-074-0948-08200870","19-4903HO-HY-074-1606-08200770","19-4903HO-HY-074-2154-08200670","19-4903NS-HY-059-2242-09200390","19-4903NS-HY-060-0700-09200480","19-4903NS-HY-060-1336-09200580","19-4903NS-HY-060-2012-09200680","19-4903NS-HY-061-0224-09200780","19-4903NS-HY-061-0906-09200880","19-4903NS-HY-061-1618-09200980","19-4903NS-HY-061-2354-09201080","19-4903NS-HY-062-0612-09201170","19-4903NS-HY-062-1230-09201270","19-4903NS-HY-062-1906-09201370","19-4903NS-HY-063-1212-10331280","19-4903NS-HY-063-1924-10331190","19-4903NS-HY-064-0048-10331110","19-4903NS-HY-064-0654-10201030","19-4903NS-HY-064-1236-10200940","19-4903NS-HY-064-1854-10200840","19-4903NS-HY-065-0136-10200740","19-4903NS-HY-065-0800-10200640","19-4903NS-HY-065-1430-10200540","19-4903NS-HY-065-2100-10100440","19-4903NS-HY-066-0306-10100340","19-4903NS-HY-066-1718-11100380","19-4903NS-HY-066-2342-11100480","19-4903NS-HY-067-0606-11100580","19-4903NS-HY-067-1236-11100680","19-4903NS-HY-067-1836-11200780","19-4903NS-HY-068-0030-11200880","19-4903NS-HY-068-0624-11200980","19-4903NS-HY-068-1242-11201070","19-4903NS-HY-068-1818-11201170","19-4903NS-HY-069-0030-11331270","19-4903NS-HY-069-0512-11331370","19-4903NS-HY-069-2348-12601320","19-4903NS-HY-070-0442-12601220","19-4903NS-HY-070-1106-12501120","19-4903NS-HY-070-1730-12501020","19-4903NS-HY-070-2306-12400930","19-4903NS-HY-071-0512-12400830","19-4903NS-HY-071-1124-12330730","19-4903NS-HY-071-1806-12330630","19-4903NS-HY-072-0142-12200530","19-4903NS-HY-072-0906-12200440","19-4904CR-HY-087-0606-04400485","19-4904CR-HY-091-1418-04200680","19-4904CR-HY-092-0030-04100770","19-4904CR-HY-092-1348-03900960","19-4904CR-HY-093-0036-03671150","19-4904CR-HY-093-0718-03601250","19-4904CR-HY-093-2248-02401200","19-4904CR-HY-094-0524-02501110","19-4904CR-HY-094-1118-02601020","19-4904CR-HY-094-1730-02800920","19-4904CR-HY-094-2224-02900830","19-4904CR-HY-095-0406-03000740","19-4904CR-HY-095-1042-03100650","19-4904CR-HY-095-1642-03330550","19-4904CR-HY-095-2142-03400460","19-4904CR-HY-096-0430-03500370","19-4904CR-HY-096-1648-04400490","19-4904CR-HY-097-1548-05400560","19-4904CR-HY-097-2030-05330660","19-4904CR-HY-098-0142-05200750","19-4904CR-HY-098-0748-05100850","19-4904CR-HY-098-1342-05000950","19-4904CR-HY-098-1800-05001040","19-4904CR-HY-098-2318-04901140","19-4904CR-HY-099-0542-04801240","19-4904CR-HY-099-1154-04671330","19-4904CR-HY-099-1712-04601430","19-4904HO-HY-089-0042-08200570","19-4904HO-HY-090-0124-08200670","19-4904HO-HY-092-1730-08200770"],["054.0 056.0","052.0 075.0","051.0 085.0","050.0 095.0","050.0 104.0","049.0 114.0","056.7 146.0","056.7 136.0","058.0 127.0","059.0 117.0","059.0 107.0","060.0 097.0","061.0 087.0","061.0 078.0","062.0 068.0","063.3 058.0","072.0 056.0","071.0 066.0","071.0 076.0","081.0 117.0","081.0 127.0","081.0 107.0","081.0 097.0","082.0 097.0","082.0 087.0","082.0 077.0","082.0 067.0","092.0 039.0","092.0 048.0","092.0 058.0","092.0 068.0","092.0 078.0","092.0 088.0","092.0 098.0","092.0 108.0","092.0 117.0","092.0 127.0","092.0 137.0","103.3 128.0","103.3 119.0","103.3 111.0","102.0 103.0","102.0 094.0","102.0 084.0","102.0 074.0","102.0 064.0","102.0 054.0","101.0 044.0","101.0 034.0","111.0 038.0","111.0 048.0","111.0 058.0","111.0 068.0","112.0 078.0","112.0 088.0","112.0 098.0","112.0 107.0","112.0 117.0","113.3 127.0","113.3 137.0","126.0 132.0","126.0 122.0","125.0 112.0","125.0 102.0","124.0 093.0","124.0 083.0","123.3 073.0","123.3 063.0","122.0 053.0","122.0 044.0","044.0 048.5","042.0 068.0","041.0 077.0","039.0 096.0","036.7 115.0","036.0 125.0","024.0 120.0","025.0 111.0","026.0 102.0","028.0 092.0","029.0 083.0","030.0 074.0","031.0 065.0","033.3 055.0","034.0 046.0","035.0 037.0","044.0 049.0","054.0 056.0","053.3 066.0","052.0 075.0","051.0 085.0","050.0 095.0","050.0 104.0","049.0 114.0","048.0 124.0","046.7 133.0","046.0 143.0","082.0 057.0","082.0 067.0","082.0 077.0"],["NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST","NST"],[null,null,null,null,null,null,null,null,null,null,null,-190.33,-151.22,null,null,null,null,null,null,-292.3,null,null,null,-187.06,-173.59,-127.69,null,-48.54,-89.33,null,null,null,null,null,null,-365.31,null,-444.63,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,-127.69],[38.833333,38.583333,38.475,38.333333,38.233333,37.833333,35.366666,35.433333,35.833333,36.066666,36.283333,36.475,36.691666,36.85,37.075,37.25,35.816666,35.393333,35.066666,32.083333,31.783333,32.366666,32.666666,32.833333,32.95,33.25,33.55,32.666666,32.35,32.05,31.708333,31.433333,31.116666,30.841666,30.5,30.183333,29.75,29.541666,27.8,28.283333,28.533333,28.85,29.116666,29.483333,29.866666,30.25,30.675,31.008333,31.366666,29.383333,29.2,28.783333,28.341666,28.058333,27.716666,27.333333,26.95,26.616666,26.25,26,23.916666,24.083333,24.616666,25.133333,25.433333,25.85,26.266666,26.616666,27.083333,27.5,40.833333,40.55,40.2,39.966666,39.783333,39.75,41.866666,41.975,42.066666,42.158333,42.266666,42.416666,42.466666,42.5,42.566666,42.658333,40.7,38.833333,38.616666,38.466666,38.25,38.05,37.866666,37.766666,37.533333,37.333333,37.166666,33.833333,33.533333,33.25],[-124.083333,-125.8,-126.666666,-127.516666,-128.366666,-129.05,-130.216666,-129.45,-128.7,-127.916666,-127.1,-126.316666,-125.533333,-124.8,-123.966666,-123.233333,-121.833333,-122.558333,-123.333333,-124.916666,-125.633333,-124.216666,-123.5,-123.666666,-122.8,-122.083333,-121.35,-118.166666,-118.883333,-119.516666,-120.266666,-120.883333,-121.566666,-122.183333,-122.85,-123.616666,-124.275,-124.95,-122.866666,-122.383333,-121.841666,-121.316666,-120.8,-120.216666,-119.5,-118.833333,-118.508333,-117.5,-116.925,-116,-116.766666,-117.35,-118.05,-118.691666,-119.275,-119.866666,-120.575,-121.05,-121.75,-122.166666,-120.333333,-119.883333,-119.35,-118.85,-118.166666,-117.616666,-117.05,-116.616666,-115.908333,-115.3,-124.833333,-126.4,-127.633333,-129.183333,-130.7,-131.6,-133.083333,-132.116666,-131.233333,-130.25,-129.466666,-128.566666,-127.616666,-126.6,-125.883333,-125.066666,-124.75,-124.083333,-124.963333,-125.8,-126.783333,-127.533333,-128.2,-128.85,-129.8,-130.666666,-131.333333,-120.666666,-121.366666,-122.083333],[54,52,51,50,50,49,56.7,56.7,58,59,59,60,61,61,62,63.3,72,71,71,81,81,81,81,82,82,82,82,92,92,92,92,92,92,92,92,92,92,92,103.3,103.3,103.3,102,102,102,102,102,102,101,101,111,111,111,111,112,112,112,112,112,113.3,113.3,126,126,125,125,124,124,123.3,123.3,122,122,44,42,41,39,36.7,36,24,25,26,28,29,30,31,33.3,34,35,44,54,53.3,52,51,50,50,49,48,46.7,46,82,82,82],[54,52,51,50,50,49,56.7,56.7,58,59,59,60,61,61,62,63,72,71,71,81,81,81,81,82,82,82,82,92,92,92,92,92,92,92,92,92,92,92,103,103,103,102,102,102,102,102,102,101,101,111,111,111,111,112,112,112,112,112,113,113,126,126,125,125,124,124,123,123,122,122,44,42,41,39,36.7,36,24,25,26,28,29,30,31,33,34,35,44,54,53,52,51,50,50,49,48,46.7,46,82,82,82],[53.8,51.5,50.3,49.2,48,48.4,56.5,57.7,57.5,58.1,58.8,59.5,60.1,60.9,61.6,62.3,71.40000000000001,71.7,71.5,81,80.8,81.3,81.5,80.40000000000001,81.7,81.90000000000001,82.2,92.7,92.59999999999999,92.5,92.40000000000001,92.3,92.2,92.09999999999999,92.09999999999999,91.8,92.2,91.7,103.5,102.5,102.6,102.4,102.4,102.1,102,101.8,100.7,101.4,101.1,111.8,110.9,111.4,111.8,111.6,111.7,112.1,112.2,112.5,112.5,112.7,125.6,125.9,124.8,123.8,124,123.5,122.9,122.4,122,121.5,43.6,41.9,41,39.1,37,35.5,23.9,25.2,26.4,27.8,28.8,29.8,31.3,33.1,34.1,35.2,44.4,53.8,53,52,51,50.4,49.9,49.1,48.2,47.4,46.8,82.40000000000001,82.2,81.90000000000001],[56,75,85,95,104,114,146,136,127,117,107,97,87,78,68,58,56,66,76,117,127,107,97,97.3,87,77,67,39,48,58,68,78,88,98,108,117,127,137,128,119,111,103,94,84,74,64,54,44,34,38,48,58,68,78,88,98,107,117,127,137,132,122,112,102,93,83,73,63,53,44,48.5,68,77,96,115,125,120,111,102,92,83,74,65,55,46,37,49,56,66,75,85,95,104,114,124,133,143,57,67,77],[56,75,85,95,104,114,146,136,127,117,107,97,87,78,68,58,56,66,76,117,127,107,97,97,87,77,67,39,48,58,68,78,88,98,108,117,127,137,128,119,111,103,94,84,74,64,54,44,34,38,48,58,68,78,88,98,107,117,127,137,132,122,112,102,93,83,73,63,53,44,48.5,68,77,96,115,125,120,111,102,92,83,74,65,55,46,37,49,56,66,75,85,95,104,114,124,133,143,57,67,77],[55.8,75.09999999999999,84.7,94.3,103.7,113.7,145.8,137.4,126.4,116.5,106.3,96.7,86.90000000000001,78.09999999999999,67.8,58.8,54.9,65.7,76.40000000000001,116.7,126.9,106.9,96.8,97.3,87,76.90000000000001,66.7,38.4,48.6,57.9,68.7,77.7,87.7,96.59999999999999,106.7,117.6,128.4,137.5,128.3,119,110.9,102.5,94.59999999999999,85.2,74.2,63.7,56.9,43.1,34,38,48.1,57.9,69.2,78.8,88.09999999999999,97.8,108.9,117,127.9,134.7,130,123.4,113,103.1,92.8,83.2,73.40000000000001,65.7,54,43.8,48.5,66.09999999999999,80.90000000000001,98,114.3,123.3,120.1,110.1,101.1,91,82.7,72.90000000000001,63.5,53.4,46,37.4,48.6,55.8,66.3,76,87.59999999999999,96.7,104.9,112.3,123.7,134.1,142.1,57.1,67,76.90000000000001],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","HORIZON","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","MV N.B. SCOFIELD","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","CREST","HORIZON","HORIZON","HORIZON"],["31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31HO","31HO","31HO","31HO","31HO","31HO","31HO","31HO","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31NS","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31CR","31HO","31HO","31HO"],["HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY","HY"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["054 56","052 75","051 85","050 95","050 104","049 114","057 146","057 136","058 127","059 117","059 107","060 97","061 87","061 78","062 68","063 58","072 56","071 66","071 76","081 117","081 127","081 107","081 97","082 57","082 87","082 77","082 67","092 39","092 48","092 58","092 68","092 78","092 88","092 98","092 108","092 117","092 127","092 137","103 128","103 119","103 111","102 103","102 94","102 84","102 74","102 64","102 54","101 44","101 34","111 38","111 48","111 58","111 68","112 78","112 88","112 98","112 107","112 117","113 127","113 137","126 132","126 122","125 112","125 102","124 93","124 83","123 73","123 63","122 53","122 44","44 49 A","042 68","041 77","039 96","037 115","036 125","024 120","025 111","026 102","028 92","029 83","030 74","031 65","033 55","034 36","035 37","044 49","054 56","053 66","052 75","051 85","050 95","050 104","049 114","048 124","047 133","046 143","082 57","082 67","082 77"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv","gs://calcofi-files-public/archive/2026-02-05_142506/calcofi.org/bottle-database/194903-202105_Cast.csv"],[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101],["2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z","2026-02-05T20:28:48Z"],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],["1949-03-01T09:30:00Z","1949-03-01T21:12:00Z","1949-03-02T03:54:00Z","1949-03-02T10:42:00Z","1949-03-02T17:06:00Z","1949-03-03T00:36:00Z","1949-03-04T05:06:00Z","1949-03-04T11:54:00Z","1949-03-04T17:42:00Z","1949-03-04T23:54:00Z","1949-03-05T06:12:00Z","1949-03-05T11:48:00Z","1949-03-05T18:00:00Z","1949-03-05T23:30:00Z","1949-03-06T05:18:00Z","1949-03-06T10:30:00Z","1949-03-07T00:00:00Z","1949-03-07T05:24:00Z","1949-03-08T05:18:00Z","1949-03-14T00:00:00Z","1949-03-14T06:36:00Z","1949-03-14T20:30:00Z","1949-03-15T02:24:00Z","1949-03-15T03:06:00Z","1949-03-15T09:48:00Z","1949-03-15T16:06:00Z","1949-03-15T21:54:00Z","1949-02-28T22:42:00Z","1949-03-01T07:00:00Z","1949-03-01T13:36:00Z","1949-03-01T20:12:00Z","1949-03-02T02:24:00Z","1949-03-02T09:06:00Z","1949-03-02T16:18:00Z","1949-03-02T23:54:00Z","1949-03-03T06:12:00Z","1949-03-03T12:30:00Z","1949-03-03T19:06:00Z","1949-03-04T12:12:00Z","1949-03-04T19:24:00Z","1949-03-05T00:48:00Z","1949-03-05T06:54:00Z","1949-03-05T12:36:00Z","1949-03-05T18:54:00Z","1949-03-06T01:36:00Z","1949-03-06T08:00:00Z","1949-03-06T14:30:00Z","1949-03-06T21:00:00Z","1949-03-07T03:06:00Z","1949-03-07T17:18:00Z","1949-03-07T23:42:00Z","1949-03-08T06:06:00Z","1949-03-08T12:36:00Z","1949-03-08T18:36:00Z","1949-03-09T00:30:00Z","1949-03-09T06:24:00Z","1949-03-09T12:42:00Z","1949-03-09T18:18:00Z","1949-03-10T00:30:00Z","1949-03-10T05:12:00Z","1949-03-10T23:48:00Z","1949-03-11T04:42:00Z","1949-03-11T11:06:00Z","1949-03-11T17:30:00Z","1949-03-11T23:06:00Z","1949-03-12T05:12:00Z","1949-03-12T11:24:00Z","1949-03-12T18:06:00Z","1949-03-13T01:42:00Z","1949-03-13T09:06:00Z","1949-03-28T06:06:00Z","1949-04-01T14:18:00Z","1949-04-02T00:30:00Z","1949-04-02T13:48:00Z","1949-04-03T00:36:00Z","1949-04-03T07:18:00Z","1949-04-03T22:48:00Z","1949-04-04T05:24:00Z","1949-04-04T11:18:00Z","1949-04-04T17:30:00Z","1949-04-04T22:24:00Z","1949-04-05T04:06:00Z","1949-04-05T10:42:00Z","1949-04-05T16:42:00Z","1949-04-05T21:42:00Z","1949-04-06T04:30:00Z","1949-04-06T16:48:00Z","1949-04-07T15:48:00Z","1949-04-07T20:30:00Z","1949-04-08T01:42:00Z","1949-04-08T07:48:00Z","1949-04-08T13:42:00Z","1949-04-08T18:00:00Z","1949-04-08T23:18:00Z","1949-04-09T05:42:00Z","1949-04-09T11:54:00Z","1949-04-09T17:12:00Z","1949-03-30T00:42:00Z","1949-03-31T01:24:00Z","1949-04-02T17:30:00Z"],["AAAAAAAAAAAAAAAAAQAAAF1r71NVBV/Au9bep6pqQ0A=","AAAAAAAAAAAAAAAAAQAAADMzMzMzc1/Au9bep6pKQ0A=","AAAAAAAAAAAAAAAAAQAAALvW3qeqql/AzczMzMw8Q0A=","AAAAAAAAAAAAAAAAAQAAACE9RQ4R4V/Au9bep6oqQ0A=","AAAAAAAAAAAAAAAAAQAAAMTRVbq7C2DA7gkS290dQ0A=","AAAAAAAAAAAAAAAAAQAAAJqZmZmZIWDAu9bep6rqQkA=","AAAAAAAAAAAAAAAAAQAAAPcEie3uRmDAD0dX6e6uQUA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmLmDAh6OrdHe3QUA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmFmDAu9bep6rqQUA=","AAAAAAAAAAAAAAAAAQAAALvW3qeq+l/AqODwgogIQkA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmxl/AVHB4QUQkQkA=","AAAAAAAAAAAAAAAAAQAAAFRweEFElF/AzczMzMw8QkA=","AAAAAAAAAAAAAAAAAQAAACo4vCAiYl/AqODwgohYQkA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzM1/AzczMzMxsQkA=","AAAAAAAAAAAAAAAAAQAAAO4JEtvd/V7AmpmZmZmJQkA=","AAAAAAAAAAAAAAAAAQAAAPcEie3uzl7AAAAAAACgQkA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVdV7AqODwgojoQUA=","AAAAAAAAAAAAAAAAAQAAAMTRVbq7o17AArhZvFiyQUA=","AAAAAAAAAAAAAAAAAQAAAF1r71NV1V7AqODwgoiIQUA=","AAAAAAAAAAAAAAAAAQAAALvW3qeqOl/Au9bep6oKQEA=","AAAAAAAAAAAAAAAAAQAAAJCeIoeIaF/AqODwgojIP0A=","AAAAAAAAAAAAAAAAAQAAAO4JEtvdDV/AD0dX6e4uQEA=","AAAAAAAAAAAAAAAAAQAAAAAAAAAA4F7Ada29T1VVQEA=","AAAAAAAAAAAAAAAAAQAAALvW3qeq6l7Au9bep6pqQEA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzs17AmpmZmZl5QEA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVhV7AAAAAAACgQEA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmVl7AZmZmZmbGQEA=","AAAAAAAAAAAAAAAAAQAAALvW3qeqil3Ada29T1VVQEA=","AAAAAAAAAAAAAAAAAQAAAJCeIoeIuF3AzczMzMwsQEA=","AAAAAAAAAAAAAAAAAQAAACE9RQ4R4V3AZmZmZmYGQEA=","AAAAAAAAAAAAAAAAAQAAACE9RQ4REV7Ada29T1W1P0A=","AAAAAAAAAAAAAAAAAQAAAJCeIoeIOF7AD0dX6e5uP0A=","AAAAAAAAAAAAAAAAAQAAAFRweEFEZF7AHY6u0t0dP0A=","AAAAAAAAAAAAAAAAAQAAAMTRVbq7i17AtydIbHfXPkA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmtl7AAAAAAACAPkA=","AAAAAAAAAAAAAAAAAQAAAIejq3R3517AD0dX6e4uPkA=","AAAAAAAAAAAAAAAAAQAAAJqZmZmZEV/AAAAAAADAPUA=","AAAAAAAAAAAAAAAAAQAAAM3MzMzMPF/A6lp7n6qKPUA=","AAAAAAAAAAAAAAAAAQAAAIejq3R3t17AzczMzMzMO0A=","AAAAAAAAAAAAAAAAAQAAAJCeIoeImF7AqODwgohIPEA=","AAAAAAAAAAAAAAAAAQAAAO4JEtvddV7AqODwgoiIPEA=","AAAAAAAAAAAAAAAAAQAAAFRweEFEVF7AmpmZmZnZPEA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzM17AHY6u0t0dPUA=","AAAAAAAAAAAAAAAAAQAAAO4JEtvdDV7A2xMktrt7PUA=","AAAAAAAAAAAAAAAAAQAAAAAAAAAA4F3AHY6u0t3dPUA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVtV3AAAAAAABAPkA=","AAAAAAAAAAAAAAAAAQAAAJCeIoeIoF3AzczMzMysPkA=","AAAAAAAAAAAAAAAAAQAAAAAAAAAAYF3AQnqKHCICP0A=","AAAAAAAAAAAAAAAAAQAAADMzMzMzO13AHY6u0t1dP0A=","AAAAAAAAAAAAAAAAAQAAAAAAAAAAAF3AQnqKHCJiPUA=","AAAAAAAAAAAAAAAAAQAAACE9RQ4RMV3AMzMzMzMzPUA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmVl3AqODwgojIPEA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzg13AtydIbHdXPEA=","AAAAAAAAAAAAAAAAAQAAAFRweEFErF3AD0dX6e4OPEA=","AAAAAAAAAAAAAAAAAQAAAJqZmZmZ0V3AtydIbHe3O0A=","AAAAAAAAAAAAAAAAAQAAAIejq3R3913Ada29T1VVO0A=","AAAAAAAAAAAAAAAAAQAAAM3MzMzMJF7AMzMzMzPzOkA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzQ17AHY6u0t2dOkA=","AAAAAAAAAAAAAAAAAQAAAAAAAAAAcF7AAAAAAABAOkA=","AAAAAAAAAAAAAAAAAQAAALvW3qeqil7AAAAAAAAAOkA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVFV7A6lp7n6rqN0A=","AAAAAAAAAAAAAAAAAQAAAJCeIoeI+F3Ada29T1UVOEA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZm1l3AHY6u0t2dOEA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmtl3AQnqKHCIiOUA=","AAAAAAAAAAAAAAAAAQAAALvW3qeqil3AD0dX6e5uOUA=","AAAAAAAAAAAAAAAAAQAAAIejq3R3Z13AmpmZmZnZOUA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzQ13AhPQUOUREOkA=","AAAAAAAAAAAAAAAAAQAAAIejq3R3J13AHY6u0t2dOkA=","AAAAAAAAAAAAAAAAAQAAACo4vCAi+lzAda29T1UVO0A=","AAAAAAAAAAAAAAAAAQAAADMzMzMz01zAAAAAAACAO0A=","AAAAAAAAAAAAAAAAAQAAAF1r71NVNV/Au9bep6pqREA=","AAAAAAAAAAAAAAAAAQAAAJqZmZmZmV/AZmZmZmZGREA=","AAAAAAAAAAAAAAAAAQAAAJCeIoeI6F/AmpmZmZkZREA=","AAAAAAAAAAAAAAAAAQAAAOLoKt3dJWDA2xMktrv7Q0A=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmVmDAVHB4QUTkQ0A=","AAAAAAAAAAAAAAAAAQAAADMzMzMzc2DAAAAAAADgQ0A=","AAAAAAAAAAAAAAAAAQAAAK+196mqomDAD0dX6e7uREA=","AAAAAAAAAAAAAAAAAQAAAMTRVbq7g2DAzczMzMz8REA=","AAAAAAAAAAAAAAAAAQAAAHuCxHZ3Z2DAqODwgogIRUA=","AAAAAAAAAAAAAAAAAQAAAAAAAAAASGDAVHB4QUQURUA=","AAAAAAAAAAAAAAAAAQAAAPcEie3uLmDAQnqKHCIiRUA=","AAAAAAAAAAAAAAAAAQAAACo4vCAiEmDAda29T1U1RUA=","AAAAAAAAAAAAAAAAAQAAAIejq3R351/A2xMktrs7RUA=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmpl/AAAAAAABARUA=","AAAAAAAAAAAAAAAAAQAAAJCeIoeIeF/AqODwgohIRUA=","AAAAAAAAAAAAAAAAAQAAAFRweEFERF/AVHB4QURURUA=","AAAAAAAAAAAAAAAAAQAAAAAAAAAAMF/AmpmZmZlZREA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVBV/Au9bep6pqQ0A=","AAAAAAAAAAAAAAAAAQAAABaKdD+nPV/AD0dX6e5OQ0A=","AAAAAAAAAAAAAAAAAQAAADMzMzMzc1/A2xMktrs7Q0A=","AAAAAAAAAAAAAAAAAQAAACo4vCAisl/AAAAAAAAgQ0A=","AAAAAAAAAAAAAAAAAQAAACo4vCAi4l/AZmZmZmYGQ0A=","AAAAAAAAAAAAAAAAAQAAAGZmZmZmBmDAD0dX6e7uQkA=","AAAAAAAAAAAAAAAAAQAAADMzMzMzG2DAQnqKHCLiQkA=","AAAAAAAAAAAAAAAAAQAAAJqZmZmZOWDAVHB4QUTEQkA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVVWDAu9bep6qqQkA=","AAAAAAAAAAAAAAAAAQAAAK+196mqamDAda29T1WVQkA=","AAAAAAAAAAAAAAAAAQAAALvW3qeqKl7Au9bep6rqQEA=","AAAAAAAAAAAAAAAAAQAAAIejq3R3V17AVHB4QUTEQEA=","AAAAAAAAAAAAAAAAAQAAAF1r71NVhV7AAAAAAACgQEA="],["st60-ln55_hist","st80-ln55_hist","st80-ln55_hist","st100-ln50_hist","st100-ln50_hist","st120-ln50_hist","st140-ln60_hist","st140-ln60_hist","st110-ln60_hist","st110-ln60_hist","st110-ln60_hist","st100-ln60","st90-ln60","st80-ln60","st70-ln60","st60-ln63.3","st55-ln70","st70-ln73.3","st80-ln70","st110-ln80_hist","st110-ln80_hist","st110-ln80_hist","st100-ln80","st100-ln80","st90-ln83.3","st80-ln83.3","st70-ln83.3","st40-ln93.3","st50-ln93.3","st60-ln93.3","st70-ln93.3","st80-ln93.3","st90-ln93.3","st100-ln93.3","st110-ln93.3","st120-ln93.3","st120-ln90_hist","st140-ln90_hist","st120-ln100_hist","st120-ln100_hist","st120-ln100_hist","st100-ln100_hist","st100-ln100_hist","st80-ln100_hist","st80-ln100_hist","st60-ln100_hist","st60-ln100_hist","st40-ln100_hist","st40-ln100_hist","st40-ln110_hist","st40-ln110_hist","st60-ln110_hist","st60-ln110_hist","st80-ln110_hist","st80-ln110_hist","st100-ln110_hist","st100-ln110_hist","st120-ln110_hist","st120-ln110_hist","st140-ln110_hist","st140-ln130_hist","st120-ln130_hist","st120-ln120_hist","st100-ln120_hist","st100-ln120_hist","st80-ln120_hist","st80-ln120_hist","st60-ln120_hist","st60-ln120_hist","st40-ln120_hist","st40-ln40_hist","st60-ln40_hist","st80-ln40_hist","st100-ln40_hist","st120-ln40_hist","st120-ln40_hist","st120-ln20_hist","st120-ln30_hist","st100-ln30_hist","st100-ln30_hist","st80-ln30_hist","st80-ln30_hist","st60-ln30_hist","st60-ln30_hist","st40-ln30_hist","st40-ln40_hist","st40-ln40_hist","st60-ln55_hist","st60-ln55_hist","st80-ln55_hist","st80-ln55_hist","st100-ln50_hist","st100-ln50_hist","st120-ln50_hist","st120-ln50_hist","st140-ln50_hist","st140-ln50_hist","st55-ln83.3","st70-ln83.3","st80-ln83.3"],[1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949,1949],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,3,3,4],[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2],[60,60,61,61,61,62,63,63,63,63,64,64,64,64,65,65,66,66,67,73,73,73,74,74,74,74,74,59,60,60,60,61,61,61,61,62,62,62,63,63,64,64,64,64,65,65,65,65,66,66,66,67,67,67,68,68,68,68,69,69,69,70,70,70,70,71,71,71,72,72,87,91,92,92,93,93,93,94,94,94,94,95,95,95,95,96,96,97,97,98,98,98,98,98,99,99,99,89,90,92],[17958,17958,17959,17959,17959,17960,17961,17961,17961,17961,17962,17962,17962,17962,17963,17963,17964,17964,17965,17971,17971,17971,17972,17972,17972,17972,17972,17957,17958,17958,17958,17959,17959,17959,17959,17960,17960,17960,17961,17961,17962,17962,17962,17962,17963,17963,17963,17963,17964,17964,17964,17965,17965,17965,17966,17966,17966,17966,17967,17967,17967,17968,17968,17968,17968,17969,17969,17969,17970,17970,17985,17989,17990,17990,17991,17991,17991,17992,17992,17992,17992,17993,17993,17993,17993,17994,17994,17995,17995,17996,17996,17996,17996,17996,17997,17997,17997,17987,17988,17990],[38,38,38,38,38,37,35,35,35,36,36,36,36,36,37,37,35,35,35,32,31,32,32,32,32,33,33,32,32,32,31,31,31,30,30,30,29,29,27,28,28,28,29,29,29,30,30,31,31,29,29,28,28,28,27,27,26,26,26,26,23,24,24,25,25,25,26,26,27,27,40,40,40,39,39,39,41,41,42,42,42,42,42,42,42,42,40,38,38,38,38,38,37,37,37,37,37,33,33,33],[49.99998000000019,34.99998000000019,28.50000000000009,19.99998000000019,13.99998000000011,49.99998000000019,21.99996000000013,25.99997999999985,49.99998000000019,3.999959999999874,16.99997999999994,28.50000000000009,41.49995999999987,51.00000000000009,4.500000000000171,15,48.99995999999987,23.5999799999999,3.999959999999874,4.999980000000193,46.99997999999994,21.99996000000013,39.99995999999996,49.99998000000019,57.00000000000017,15,32.99999999999983,39.99995999999996,21.00000000000009,2.999999999999829,42.49997999999998,25.99998000000006,6.999959999999916,50.49996,30,10.99998000000006,45,32.49995999999996,48.00000000000004,16.99997999999994,31.99997999999994,51.00000000000009,6.999959999999916,28.99997999999989,51.99995999999992,15,40.50000000000004,0.4999800000000221,21.99995999999992,22.99998000000002,11.99999999999996,46.99997999999994,20.49996,3.499980000000065,42.99996,19.99997999999998,56.99999999999996,36.99995999999992,15,0,54.99995999999996,4.999979999999979,36.99995999999992,7.999980000000022,25.99998000000006,51.00000000000009,15.99996000000004,36.99995999999992,4.999979999999979,30,49.99998000000019,32.99999999999983,12.00000000000017,57.99995999999979,46.99997999999994,45,51.99996000000013,58.50000000000009,3.999959999999874,9.499979999999937,15.99996000000004,24.99995999999996,27.99995999999979,30,33.99995999999987,39.49997999999994,42.00000000000017,49.99998000000019,36.99996000000013,27.99995999999979,15,2.999999999999829,51.99996000000013,45.99996000000004,31.99997999999994,19.99998000000019,9.999959999999959,49.99998000000019,31.99997999999994,15],["N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],[124,125,126,127,128,129,130,129,128,127,127,126,125,124,123,123,121,122,123,124,125,124,123,123,122,122,121,118,118,119,120,120,121,122,122,123,124,124,122,122,121,121,120,120,119,118,118,117,116,116,116,117,118,118,119,119,120,121,121,122,120,119,119,118,118,117,117,116,115,115,124,126,127,129,130,131,133,132,131,130,129,128,127,126,125,125,124,124,124,125,126,127,128,128,129,130,131,120,121,122],[4.999979999999766,47.99999999999983,39.99996000000039,30.99996000000004,21.99996000000056,3.000000000000682,12.99996000000021,26.99999999999932,41.99999999999932,54.99996000000039,5.999999999999659,18.99995999999987,31.99997999999994,47.99999999999983,57.99996000000021,13.99998000000011,49.99997999999977,33.49998000000028,19.99997999999977,54.99996000000039,37.9999799999996,12.99996000000021,30,39.99996000000039,47.99999999999983,4.999979999999766,20.99999999999966,9.999960000000385,52.9999799999996,30.99996000000004,15.99996000000004,52.9999799999996,33.99995999999987,10.99998000000028,50.99999999999966,36.9999599999997,16.50000000000034,57.00000000000017,51.9999599999997,22.9999799999996,50.49996000000021,18.99995999999987,47.99999999999983,12.99996000000021,30,49.99997999999977,30.4999799999996,30,55.49999999999983,0,45.99996000000004,20.99999999999966,2.999999999999829,41.49995999999987,16.50000000000034,51.9999599999997,34.50000000000017,2.999999999999829,45,9.999960000000385,19.99997999999977,52.9999799999996,20.99999999999966,50.99999999999966,9.999960000000385,36.9999599999997,2.999999999999829,36.9999599999997,54.49997999999994,17.99999999999983,49.99997999999977,24.00000000000034,37.9999799999996,10.99998000000028,41.99999999999932,35.99999999999966,4.999980000000619,6.999960000000556,13.99997999999925,15,27.99996000000021,33.99995999999987,36.9999599999997,35.99999999999966,52.9999799999996,3.999959999999874,45,4.999979999999766,57.79998000000035,47.99999999999983,46.99997999999994,31.99997999999994,11.99999999999932,50.99999999999966,48.00000000000068,39.99995999999953,19.99998000000062,39.99996000000039,21.9999599999997,4.999979999999766],["W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W","W"],["194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194902","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194903","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194904","194903","194903","194904"],["05400560","05200750","05100850","05000950","05001040","04901140","05671460","05671360","05801270","05901170","05901070","06000970","06100870","06100780","06200680","06330580","07200560","07100660","07100760","08101170","08101270","08101070","08100970","08200970","08200870","08200770","08200670","09200390","09200480","09200580","09200680","09200780","09200880","09200980","09201080","09201170","09201270","09201370","10331280","10331190","10331110","10201030","10200940","10200840","10200740","10200640","10200540","10100440","10100340","11100380","11100480","11100580","11100680","11200780","11200880","11200980","11201070","11201170","11331270","11331370","12601320","12601220","12501120","12501020","12400930","12400830","12330730","12330630","12200530","12200440","04400485","04200680","04100770","03900960","03671150","03601250","02401200","02501110","02601020","02800920","02900830","03000740","03100650","03330550","03400460","03500370","04400490","05400560","05330660","05200750","05100850","05000950","05001040","04901140","04801240","04671330","04601430","08200570","08200670","08200770"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>cast_id<\/th>\n      <th>cruise_key<\/th>\n      <th>cast_key<\/th>\n      <th>sta_key<\/th>\n      <th>sta_code<\/th>\n      <th>distance<\/th>\n      <th>lat_dec<\/th>\n      <th>lon_dec<\/th>\n      <th>rpt_line<\/th>\n      <th>st_line<\/th>\n      <th>ac_line<\/th>\n      <th>rpt_sta<\/th>\n      <th>st_station<\/th>\n      <th>ac_sta<\/th>\n      <th>bottom_depth_m<\/th>\n      <th>ship_name<\/th>\n      <th>ship_code<\/th>\n      <th>data_type<\/th>\n      <th>order_occ<\/th>\n      <th>event_num<\/th>\n      <th>cruz_leg<\/th>\n      <th>orig_sta_id<\/th>\n      <th>data_or<\/th>\n      <th>int_chl<\/th>\n      <th>int_c14<\/th>\n      <th>inc_str<\/th>\n      <th>inc_end<\/th>\n      <th>pst_lan<\/th>\n      <th>civil_t<\/th>\n      <th>_source_file<\/th>\n      <th>_source_row<\/th>\n      <th>_ingested_at<\/th>\n      <th>_source_uuid<\/th>\n      <th>datetime_utc<\/th>\n      <th>geom<\/th>\n      <th>grid_key<\/th>\n      <th>year<\/th>\n      <th>month<\/th>\n      <th>quarter<\/th>\n      <th>julian_day<\/th>\n      <th>julian_date<\/th>\n      <th>lat_deg<\/th>\n      <th>lat_min<\/th>\n      <th>lat_hem<\/th>\n      <th>lon_deg<\/th>\n      <th>lon_min<\/th>\n      <th>lon_hem<\/th>\n      <th>cruise<\/th>\n      <th>db_sta_key<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[0,5,6,7,8,9,10,11,12,13,14,18,19,23,24,30,36,37,38,39,40,41,42,44,45]},{"name":"cast_id","targets":0},{"name":"cruise_key","targets":1},{"name":"cast_key","targets":2},{"name":"sta_key","targets":3},{"name":"sta_code","targets":4},{"name":"distance","targets":5},{"name":"lat_dec","targets":6},{"name":"lon_dec","targets":7},{"name":"rpt_line","targets":8},{"name":"st_line","targets":9},{"name":"ac_line","targets":10},{"name":"rpt_sta","targets":11},{"name":"st_station","targets":12},{"name":"ac_sta","targets":13},{"name":"bottom_depth_m","targets":14},{"name":"ship_name","targets":15},{"name":"ship_code","targets":16},{"name":"data_type","targets":17},{"name":"order_occ","targets":18},{"name":"event_num","targets":19},{"name":"cruz_leg","targets":20},{"name":"orig_sta_id","targets":21},{"name":"data_or","targets":22},{"name":"int_chl","targets":23},{"name":"int_c14","targets":24},{"name":"inc_str","targets":25},{"name":"inc_end","targets":26},{"name":"pst_lan","targets":27},{"name":"civil_t","targets":28},{"name":"_source_file","targets":29},{"name":"_source_row","targets":30},{"name":"_ingested_at","targets":31},{"name":"_source_uuid","targets":32},{"name":"datetime_utc","targets":33},{"name":"geom","targets":34},{"name":"grid_key","targets":35},{"name":"year","targets":36},{"name":"month","targets":37},{"name":"quarter","targets":38},{"name":"julian_day","targets":39},{"name":"julian_date","targets":40},{"name":"lat_deg","targets":41},{"name":"lat_min","targets":42},{"name":"lat_hem","targets":43},{"name":"lon_deg","targets":44},{"name":"lon_min","targets":45},{"name":"lon_hem","targets":46},{"name":"cruise","targets":47},{"name":"db_sta_key","targets":48}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="write-parquet-outputs" class="level2" data-number="20">
<h2 data-number="20" class="anchored" data-anchor-id="write-parquet-outputs"><span class="header-section-number">20</span> Write Parquet Outputs</h2>
<p>Export tables to parquet files for downstream use.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write parquet files with manifest</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>parquet_stats <span class="ot">&lt;-</span> <span class="fu">write_parquet_outputs</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">con              =</span> con,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir       =</span> dir_parquet,</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">tables           =</span> <span class="fu">setdiff</span>(<span class="fu">db_tables</span>(con), <span class="st">"grid"</span>),  <span class="co"># grid canonical from swfsc</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip_provenance =</span> F)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>parquet_stats <span class="sc">|&gt;</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">basename</span>(path)) <span class="sc">|&gt;</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>path) <span class="sc">|&gt;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Parquet export statistics"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-3dba3c14bc459d497b49" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3dba3c14bc459d497b49">{"x":{"filter":"none","vertical":false,"caption":"<caption>Parquet export statistics<\/caption>","data":[["1","2","3","4","5"],["bottle","bottle_measurement","cast_condition","casts","measurement_type"],[895371,11135600,235513,35644,47],[14474032,89136956,1592606,2132590,3651],["bottle.parquet","bottle_measurement.parquet","cast_condition.parquet","casts.parquet","measurement_type.parquet"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>table<\/th>\n      <th>rows<\/th>\n      <th>file_size<\/th>\n      <th>file<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,3]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"table","targets":1},{"name":"rows","targets":2},{"name":"file_size","targets":3},{"name":"file","targets":4}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="write-metadata" class="level2" data-number="21">
<h2 data-number="21" class="anchored" data-anchor-id="write-metadata"><span class="header-section-number">21</span> Write Metadata</h2>
<p>Build <code>metadata.json</code> sidecar file documenting all tables and columns in parquet outputs. DuckDB <code>COMMENT ON</code> does not propagate to parquet, so this provides the metadata externally.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>metadata_path <span class="ot">&lt;-</span> <span class="fu">build_metadata_json</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">con                  =</span> con,</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_tbls_rd            =</span> d<span class="sc">$</span>d_tbls_rd,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_flds_rd            =</span> d<span class="sc">$</span>d_flds_rd,</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">metadata_derived_csv =</span> <span class="fu">here</span>(</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"metadata/calcofi.org/bottle-database/metadata_derived.csv"</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir           =</span> dir_parquet,</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">tables               =</span> <span class="fu">db_tables</span>(con),</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">set_comments         =</span> <span class="cn">TRUE</span>,</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">provider             =</span> provider,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset              =</span> dataset,</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">workflow_url         =</span> <span class="fu">glue</span>(</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://calcofi.io/workflows/"</span>,</span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ingest_calcofi.org_bottle-database.html"</span>))</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a><span class="co"># show metadata summary</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(metadata_path)</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">table   =</span> <span class="fu">names</span>(metadata<span class="sc">$</span>tables),</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_cols  =</span> <span class="fu">map_int</span>(</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(metadata<span class="sc">$</span>tables),</span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">grepl</span>(<span class="fu">glue</span>(<span class="st">"^{.x}</span><span class="sc">\\</span><span class="st">."</span>), <span class="fu">names</span>(metadata<span class="sc">$</span>columns)))),</span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_long =</span> <span class="fu">map_chr</span>(metadata<span class="sc">$</span>tables, <span class="sc">~</span>.x<span class="sc">$</span>name_long)) <span class="sc">|&gt;</span></span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Table metadata summary"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-fc3d10e9d08fd51da39a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-fc3d10e9d08fd51da39a">{"x":{"filter":"none","vertical":false,"caption":"<caption>Table metadata summary<\/caption>","data":[["1","2","3","4","5","6"],["bottle","bottle_measurement","cast_condition","casts","grid","measurement_type"],[13,6,4,36,10,7],["Bottle","Bottle Measurement","Cast Condition","Casts","Grid","Measurement Type"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>table<\/th>\n      <th>n_cols<\/th>\n      <th>name_long<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"scrollX":true,"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"table","targets":1},{"name":"n_cols","targets":2},{"name":"name_long","targets":3}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row","selectable":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>listviewer<span class="sc">::</span><span class="fu">jsonedit</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(metadata_path, <span class="at">simplifyVector =</span> <span class="cn">FALSE</span>),</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"view"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="jsonedit html-widget html-fill-item" id="htmlwidget-f965404b3aa0743592ff" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f965404b3aa0743592ff">{"x":{"data":{"schema_version":"1.0","created_at":"2026-02-05T14:28:56-0600","provider":"calcofi.org","dataset":"bottle-database","workflow":"https://calcofi.io/workflows/ingest_calcofi.org_bottle-database.html","tables":{"bottle":{"name_long":"Bottle","description_md":"water sample identity and context at specific depths; measurements pivoted to bottle_measurement"},"bottle_measurement":{"name_long":"Bottle Measurement","description_md":"long-format measurement values pivoted from bottle table"},"cast_condition":{"name_long":"Cast Condition","description_md":"long-format environmental/meteorological conditions pivoted from casts table"},"casts":{"name_long":"Casts","description_md":"station-level cast metadata including location and integrated measurements; environmental conditions pivoted to cast_condition"},"grid":{"name_long":"Grid","description_md":"CalCOFI survey grid polygons and centroids"},"measurement_type":{"name_long":"Measurement Type","description_md":"reference table for measurement/condition type codes with units and descriptions"}},"columns":{"bottle.cast_id":{"name_long":"Cast Id","units":[],"description_md":"Cast Count - All CalCOFI casts ever conducted, consecutively numbered"},"bottle.bottle_id":{"name_long":"Bottle Id","units":[],"description_md":"Bottle Count - All CalCOFI bottles ever sampled, consecutively numbered"},"bottle.sta_key":{"name_long":"Sta Key","units":[],"description_md":"Line and Station [Line] [Station]"},"bottle.depth_key":{"name_long":"Depth Key","units":[],"description_md":"Uses the Cast_ID prefix but adds three additional variables: [Depth][Bottle]-[Rec_Ind]"},"bottle.depth_m":{"name_long":"Depth M","units":"meters","description_md":"Bottle depth in meters"},"bottle.btl_num":{"name_long":"Btl Num","units":[],"description_md":"Niskin bottle sample was collected from"},"bottle.rec_ind":{"name_long":"Rec Ind","units":[],"description_md":"Record Indicator (quality code that applies to the whole bottle, instead of just to a specific parameter)"},"bottle.depth_qual":{"name_long":"Depth Quality","description_md":"pressure/depth quality code (renamed from p_qual)"},"bottle.inc_tim":{"name_long":"Inc Tim","units":[],"description_md":"Elapsed incubation time of the primary productivity experiment"},"bottle._source_file":{"name_long":" Source File","units":[],"description_md":""},"bottle._source_row":{"name_long":" Source Row","units":[],"description_md":""},"bottle._ingested_at":{"name_long":" Ingested At","units":[],"description_md":""},"bottle._source_uuid":{"name_long":" Source Uuid","units":[],"description_md":""},"bottle_measurement.bottle_measurement_id":{"name_long":"Bottle Measurement ID","description_md":"PK: auto-increment integer assigned via ROW_NUMBER(ORDER BY bottle_id, measurement_type)"},"bottle_measurement.bottle_id":{"name_long":"Bottle ID","description_md":"FK to bottle.bottle_id"},"bottle_measurement.measurement_type":{"name_long":"Measurement Type","description_md":"measurement type key (FK to measurement_type.measurement_type)"},"bottle_measurement.measurement_value":{"name_long":"Measurement Value","description_md":"numeric measurement value"},"bottle_measurement.measurement_prec":{"name_long":"Measurement Precision","description_md":"replicate precision (nullable)"},"bottle_measurement.measurement_qual":{"name_long":"Measurement Quality","description_md":"quality code (nullable)"},"cast_condition.cast_condition_id":{"name_long":"Cast Condition ID","description_md":"PK: auto-increment integer assigned via ROW_NUMBER(ORDER BY cast_id, condition_type)"},"cast_condition.cast_id":{"name_long":"Cast ID","description_md":"FK to casts.cast_id"},"cast_condition.condition_type":{"name_long":"Condition Type","description_md":"condition type key (FK to measurement_type.measurement_type)"},"cast_condition.condition_value":{"name_long":"Condition Value","description_md":"numeric condition value"},"casts.cast_id":{"name_long":"Cast Id","units":[],"description_md":"Cast Count - All CalCOFI casts ever conducted, consecutively numbered"},"casts.cruise_key":{"name_long":"Cruise Key","units":[],"description_md":"Cruise identifier [Year]-[Month]-[Day]-C-[Ship Code]"},"casts.cast_key":{"name_long":"Cast Key","units":[],"description_md":"Cast Identifier [Century] - [YY][MM][ShipCode] - [CastType][Julian Day] - [CastTime]-[Line][Sta]"},"casts.sta_key":{"name_long":"Sta Key","units":[],"description_md":"Line and Station"},"casts.sta_code":{"name_long":"Sta Code","units":[],"description_md":"Station Designation (See Station_ID and 0-St_Code for codes)"},"casts.distance":{"name_long":"Distance","units":"nautical miles","description_md":"Nautical miles from coast intercept, calculated from estimated latitude and longitude"},"casts.lat_dec":{"name_long":"Lat Dec","units":"decimal degrees","description_md":"Observed Latitude in decimal degrees"},"casts.lon_dec":{"name_long":"Lon Dec","units":"decimal degrees","description_md":"Observed Longitude in decimal degrees"},"casts.rpt_line":{"name_long":"Rpt Line","units":[],"description_md":"Reported Line Number"},"casts.st_line":{"name_long":"St Line","units":[],"description_md":"Nearest Standard Line"},"casts.ac_line":{"name_long":"Ac Line","units":[],"description_md":"Calculated actual line from observed latitude and longitude"},"casts.rpt_sta":{"name_long":"Rpt Sta","units":[],"description_md":"Reported Station Number"},"casts.st_station":{"name_long":"St Station","units":[],"description_md":"Nearest Standard Station Number"},"casts.ac_sta":{"name_long":"Ac Sta","units":[],"description_md":"Calculated actual station from observed lat and long"},"casts.bottom_depth_m":{"name_long":"Bottom Depth M","units":"meters","description_md":"Bottom depth in meters"},"casts.ship_name":{"name_long":"Ship Name","units":[],"description_md":"Ship's Name"},"casts.ship_code":{"name_long":"Ship Code","units":[],"description_md":"Ship's NODC Code"},"casts.data_type":{"name_long":"Data Type","units":[],"description_md":"Data Type"},"casts.order_occ":{"name_long":"Order Occ","units":[],"description_md":"Order station was occupied (within each cruise)"},"casts.event_num":{"name_long":"Event Num","units":[],"description_md":"Event number; includes all research operations within each cruise (e.g. nets, CTD)"},"casts.cruz_leg":{"name_long":"Cruz Leg","units":[],"description_md":"Leg of cruise, if multiple legs"},"casts.orig_sta_id":{"name_long":"Orig Sta Id","units":[],"description_md":"IEH Reported Station ID"},"casts.data_or":{"name_long":"Data Or","units":[],"description_md":"Data Origin"},"casts.int_chl":{"name_long":"Int Chl","units":"milligrams chl per square meter per half light day","description_md":"Integrated Chlorophyll per half light day"},"casts.int_c14":{"name_long":"Int C14","units":"milligrams C per square meter per half light day","description_md":"Integrated Primary Productivity per half light day"},"casts.inc_str":{"name_long":"Inc Str","units":[],"description_md":"Incubation Start Time (PST)"},"casts.inc_end":{"name_long":"Inc End","units":[],"description_md":"Incubation End Time (PST)"},"casts.pst_lan":{"name_long":"Pst Lan","units":[],"description_md":"Time of Local Apparent Noon (PST)"},"casts.civil_t":{"name_long":"Civil T","units":[],"description_md":"Time of Civil Twilight (PST)"},"casts._source_file":{"name_long":" Source File","units":[],"description_md":""},"casts._source_row":{"name_long":" Source Row","units":[],"description_md":""},"casts._ingested_at":{"name_long":" Ingested At","units":[],"description_md":""},"casts._source_uuid":{"name_long":" Source Uuid","units":[],"description_md":""},"casts.datetime_utc":{"name_long":"Datetime UTC","description_md":"UTC timestamp consolidated from date + time columns"},"casts.geom":{"name_long":"Geometry","description_md":"point geometry (WGS84) from lat_dec and lon_dec"},"casts.grid_key":{"name_long":"Grid Key","description_md":"CalCOFI grid cell identifier from spatial join"},"grid.grid_key":{"name_long":"Grid Key","description_md":"Natural primary key (e.g. st60-ln80 or st60-ln80_hist for historical)"},"grid.station":{"name_long":"Station","description_md":"Offshore component of CalCOFI coordinate system"},"grid.line":{"name_long":"Line","description_md":"Alongshore component of CalCOFI coordinate system"},"grid.shore":{"name_long":"Shore","description_md":"Shore classification (nearshore, offshore, etc.)"},"grid.pattern":{"name_long":"Pattern","description_md":"Station pattern: 'standard' or 'historical'"},"grid.spacing":{"name_long":"Spacing","description_md":"Station spacing in nautical miles"},"grid.zone":{"name_long":"Zone","description_md":"Combined shore-pattern zone label"},"grid.area_km2":{"name_long":"Area","units":"km^2","description_md":"Grid cell area"},"grid.geom":{"name_long":"Geometry","description_md":"Polygon geometry (WGS84 EPSG:4326) of grid cell"},"grid.geom_ctr":{"name_long":"Geometry Center","description_md":"Point geometry (WGS84 EPSG:4326) of grid cell centroid"},"measurement_type.measurement_type":{"name_long":"Measurement Type","description_md":"PK: measurement or condition type code"},"measurement_type.dataset":{"name_long":"Dataset","description_md":"source dataset (bottle cast or ichthyo)"},"measurement_type.description":{"name_long":"Description","description_md":"human-readable description"},"measurement_type.units":{"name_long":"Units","description_md":"measurement units"},"measurement_type._source_column":{"name_long":"Source Column","description_md":"original column name in wide-format table"},"measurement_type._source_table":{"name_long":"Source Table","description_md":"wide-format DuckDB table the measurement was pivoted from (e.g. bottle, casts, ichthyo)"},"measurement_type._source_workflow":{"name_long":"Source Workflow","description_md":"QMD workflow that produces this measurement type"}}},"options":{"mode":"view","modes":["text","tree","table"]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="upload-to-gcs-archive" class="level2" data-number="22">
<h2 data-number="22" class="anchored" data-anchor-id="upload-to-gcs-archive"><span class="header-section-number">22</span> Upload to GCS Archive</h2>
<p>Upload parquet files, manifest, and metadata sidecar to <code>gs://calcofi-db/ingest/{provider}_{dataset}/</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>gcs_ingest_prefix <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"ingest/{provider}_{dataset}"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>gcs_bucket        <span class="ot">&lt;-</span> <span class="st">"calcofi-db"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># list local files to upload (parquet + json sidecars)</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>local_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(dir_parquet, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># upload each file</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(local_files, <span class="cf">function</span>(f) {</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  gcs_path <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"gs://{gcs_bucket}/{gcs_ingest_prefix}/{basename(f)}"</span>)</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">put_gcs_file</span>(f, gcs_path)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Uploaded {basename(f)} -&gt; {gcs_path}"</span>))</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">Uploaded {length(local_files)} files to "</span>,</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gs://{gcs_bucket}/{gcs_ingest_prefix}/"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="cleanup" class="level2" data-number="23">
<h2 data-number="23" class="anchored" data-anchor-id="cleanup"><span class="header-section-number">23</span> Cleanup</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># close local wrangling database connection</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">close_duckdb</span>(con)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Local wrangling database connection closed"</span>)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="co"># note: parquet outputs are in data/parquet/calcofi.org_bottle-database/</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># these can be used to update the Working DuckLake in a separate workflow</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Parquet outputs written to: {dir_parquet}"</span>))</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"GCS outputs at: gs://{gcs_bucket}/{gcs_ingest_prefix}/"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="todo" class="level2" data-number="24">
<h2 data-number="24" class="anchored" data-anchor-id="todo"><span class="header-section-number">24</span> TODO</h2>
<ul class="task-list">
<li><p><label><input type="checkbox" checked="">Review column names and apply db naming conventions, per <span class="citation" data-cites="docs/db.qmd">@docs/db.qmd</span> and <span class="citation" data-cites="workflows/README_PLAN.qmd">@workflows/README_PLAN.qmd</span>: cast_cnt -&gt; cast_id, btl_cnt -&gt; bottle_id, sta_id -&gt; sta_key, etc.</label></p></li>
<li><p><label><input type="checkbox" checked="">Pivot longer casts/bottle tables for easier analysis. Created bottle_measurement (value/prec/qual) and cast_condition tables, plus measurement_type reference.</label></p></li>
<li><p><label><input type="checkbox" checked="">Consolidate casts temporal columns (date+time -&gt; datetime_utc), drop 16 derivable columns, create casts_derived VIEW.</label></p></li>
<li><p><label><input type="checkbox">Link possible fields to <span class="citation" data-cites="workflows/ingest_swfsc.noaa.gov_calcofi-db.qmd">@workflows/ingest_swfsc.noaa.gov_calcofi-db.qmd</span>. Flag mismatches.</label></p></li>
<li><p><label><input type="checkbox">Cruise bridge: derive cruise_key from bottle cruise (YYYYMM) + ship_code to match swfsc cruise_key (YYMMKK). Deferred — needs ship_key lookup.</label></p></li>
<li><p><label><input type="checkbox">Validate casts.ship_code -&gt; ship.ship_nodc FK after integration with swfsc data.</label></p></li>
<li><p><label><input type="checkbox">Review documentation for more comment descriptions at <a href="https://calcofi.com/index.php?option=com_content&amp;view=category&amp;id=73&amp;Itemid=993">Data &gt; Data Formats | CalCOFI.org</a></label></p></li>
</ul>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Session Info
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>─ Session info ───────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.5.2 (2025-10-31)
 os       macOS Sequoia 15.7.1
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Mexico_City
 date     2026-02-05
 pandoc   3.8.3 @ /opt/homebrew/bin/ (via rmarkdown)
 quarto   1.8.25 @ /usr/local/bin/quarto

─ Packages ───────────────────────────────────────────────────────────────────
 !  package            * version    date (UTC) lib source
    abind                1.4-8      2024-09-12 [1] CRAN (R 4.5.0)
    arrow                22.0.0.1   2025-12-23 [1] CRAN (R 4.5.2)
    assertthat           0.2.1      2019-03-21 [1] CRAN (R 4.5.0)
    backports            1.5.0      2024-05-23 [1] CRAN (R 4.5.0)
    base64enc            0.1-6      2026-02-02 [1] CRAN (R 4.5.2)
    bit                  4.6.0      2025-03-06 [1] CRAN (R 4.5.0)
    bit64                4.6.0-1    2025-01-16 [1] CRAN (R 4.5.0)
    blob                 1.3.0      2026-01-14 [1] CRAN (R 4.5.2)
    broom                1.0.10     2025-09-13 [1] CRAN (R 4.5.0)
    bslib                0.10.0     2026-01-26 [1] CRAN (R 4.5.2)
    cachem               1.1.0      2024-05-16 [1] CRAN (R 4.5.0)
 VP calcofi4db         * 2.2.1      2026-02-04 [?] load_all() (on disk 2.1.0)
 VP calcofi4r          * 1.1.1      2025-10-02 [?] Github (CalCOFI/calcofi4r@dbe213f) (on disk 0.8.1)
    chromote             0.5.1      2025-04-24 [1] CRAN (R 4.5.0)
    class                7.3-23     2025-01-01 [1] CRAN (R 4.5.2)
    classInt             0.4-11     2025-01-08 [1] CRAN (R 4.5.0)
    cli                  3.6.5      2025-04-23 [1] CRAN (R 4.5.0)
    codetools            0.2-20     2024-03-31 [1] CRAN (R 4.5.2)
    crayon               1.5.3      2024-06-20 [1] CRAN (R 4.5.0)
    crosstalk            1.2.2      2025-08-26 [1] CRAN (R 4.5.0)
    curl                 7.0.0      2025-08-19 [1] CRAN (R 4.5.0)
    data.table           1.18.0     2025-12-24 [1] CRAN (R 4.5.2)
    DBI                * 1.2.3      2024-06-02 [1] CRAN (R 4.5.0)
    dbplyr               2.5.1      2025-09-10 [1] CRAN (R 4.5.0)
    desc                 1.4.3      2023-12-10 [1] CRAN (R 4.5.0)
    devtools             2.4.6      2025-10-03 [1] CRAN (R 4.5.0)
    DiagrammeR           1.0.11     2024-02-02 [1] CRAN (R 4.5.0)
    DiagrammeRsvg        0.1        2016-02-04 [1] CRAN (R 4.5.0)
    digest               0.6.39     2025-11-19 [1] CRAN (R 4.5.2)
    dm                 * 1.0.12     2025-07-02 [1] CRAN (R 4.5.0)
    dplyr              * 1.2.0      2026-02-03 [1] CRAN (R 4.5.2)
    DT                 * 0.34.0     2025-09-02 [1] CRAN (R 4.5.0)
    duckdb               1.4.4      2026-01-28 [1] CRAN (R 4.5.2)
    dygraphs             1.1.1.6    2018-07-11 [1] CRAN (R 4.5.0)
    e1071                1.7-17     2025-12-18 [1] CRAN (R 4.5.2)
    ellipsis             0.3.2      2021-04-29 [1] CRAN (R 4.5.0)
    evaluate             1.0.5      2025-08-27 [1] CRAN (R 4.5.0)
    farver               2.1.2      2024-05-13 [1] CRAN (R 4.5.0)
    fastmap              1.2.0      2024-05-15 [1] CRAN (R 4.5.0)
    fs                 * 1.6.6      2025-04-12 [1] CRAN (R 4.5.0)
    fuzzyjoin            0.1.6.1    2025-07-10 [1] CRAN (R 4.5.0)
    gargle             * 1.6.1      2026-01-29 [1] CRAN (R 4.5.2)
    generics             0.1.4      2025-05-09 [1] CRAN (R 4.5.0)
    geojsonsf            2.0.5      2025-11-26 [1] CRAN (R 4.5.2)
    ggplot2              4.0.1      2025-11-14 [1] CRAN (R 4.5.2)
    glue               * 1.8.0      2024-09-30 [1] CRAN (R 4.5.0)
    googledrive        * 2.1.2      2025-09-10 [1] CRAN (R 4.5.0)
    gtable               0.3.6      2024-10-25 [1] CRAN (R 4.5.0)
    here               * 1.0.2      2025-09-15 [1] CRAN (R 4.5.0)
    highcharter          0.9.4      2022-01-03 [1] CRAN (R 4.5.0)
    hms                  1.1.4      2025-10-17 [1] CRAN (R 4.5.0)
    htmltools          * 0.5.9      2025-12-04 [1] CRAN (R 4.5.2)
    htmlwidgets          1.6.4      2023-12-06 [1] CRAN (R 4.5.0)
    httpuv               1.6.16     2025-04-16 [1] CRAN (R 4.5.0)
    httr                 1.4.7      2023-08-15 [1] CRAN (R 4.5.0)
    httr2                1.2.2      2025-12-08 [1] CRAN (R 4.5.2)
    igraph               2.2.1      2025-10-27 [1] CRAN (R 4.5.0)
    isoband              0.3.0      2025-12-07 [1] CRAN (R 4.5.2)
    janitor            * 2.2.1      2024-12-22 [1] CRAN (R 4.5.0)
    jquerylib            0.1.4      2021-04-26 [1] CRAN (R 4.5.0)
    jsonlite           * 2.0.0      2025-03-27 [1] CRAN (R 4.5.0)
    KernSmooth           2.23-26    2025-01-01 [1] CRAN (R 4.5.2)
    knitr              * 1.51       2025-12-20 [1] CRAN (R 4.5.2)
    later                1.4.5      2026-01-08 [1] CRAN (R 4.5.2)
    lattice              0.22-7     2025-04-02 [1] CRAN (R 4.5.2)
    lazyeval             0.2.2      2019-03-15 [1] CRAN (R 4.5.0)
    leafem               0.2.5      2025-08-28 [1] CRAN (R 4.5.0)
    leaflet              2.2.3      2025-09-04 [1] CRAN (R 4.5.0)
    librarian            1.8.1      2021-07-12 [1] CRAN (R 4.5.0)
    lifecycle            1.0.5      2026-01-08 [1] CRAN (R 4.5.2)
    listviewer         * 4.0.0      2023-09-30 [1] CRAN (R 4.5.0)
    litedown           * 0.8        2025-11-02 [1] CRAN (R 4.5.0)
    lubridate          * 1.9.4      2024-12-08 [1] CRAN (R 4.5.0)
    magrittr             2.0.4      2025-09-12 [1] CRAN (R 4.5.0)
    mapgl                0.4.4      2026-01-12 [1] CRAN (R 4.5.2)
    mapview            * 2.11.4     2025-09-08 [1] CRAN (R 4.5.0)
    markdown             2.0        2025-03-23 [1] CRAN (R 4.5.0)
    Matrix               1.7-4      2025-08-28 [1] CRAN (R 4.5.2)
    memoise              2.0.1      2021-11-26 [1] CRAN (R 4.5.0)
    mgcv                 1.9-3      2025-04-04 [1] CRAN (R 4.5.2)
    mime                 0.13       2025-03-17 [1] CRAN (R 4.5.0)
    nlme                 3.1-168    2025-03-31 [1] CRAN (R 4.5.2)
    otel                 0.2.0      2025-08-29 [1] CRAN (R 4.5.0)
    pillar               1.11.1     2025-09-17 [1] CRAN (R 4.5.0)
    pkgbuild             1.4.8      2025-05-26 [1] CRAN (R 4.5.0)
    pkgconfig            2.0.3      2019-09-22 [1] CRAN (R 4.5.0)
    pkgload              1.4.1      2025-09-23 [1] CRAN (R 4.5.0)
    plotly               4.11.0     2025-06-19 [1] CRAN (R 4.5.0)
    png                  0.1-8      2022-11-29 [1] CRAN (R 4.5.0)
    processx             3.8.6      2025-02-21 [1] CRAN (R 4.5.0)
    promises             1.5.0      2025-11-01 [1] CRAN (R 4.5.0)
    proxy                0.4-29     2025-12-29 [1] CRAN (R 4.5.2)
    ps                   1.9.1      2025-04-12 [1] CRAN (R 4.5.0)
    purrr              * 1.2.1      2026-01-09 [1] CRAN (R 4.5.2)
    quantmod             0.4.28     2025-06-19 [1] CRAN (R 4.5.0)
    R6                   2.6.1      2025-02-15 [1] CRAN (R 4.5.0)
    rappdirs             0.3.4      2026-01-17 [1] CRAN (R 4.5.2)
    raster               3.6-32     2025-03-28 [1] CRAN (R 4.5.0)
    RColorBrewer         1.1-3      2022-04-03 [1] CRAN (R 4.5.0)
    Rcpp                 1.1.1      2026-01-10 [1] CRAN (R 4.5.2)
    readr              * 2.1.6      2025-11-14 [1] CRAN (R 4.5.2)
    remotes              2.5.0      2024-03-17 [1] CRAN (R 4.5.0)
    rlang              * 1.1.7      2026-01-09 [1] CRAN (R 4.5.2)
    rlist                0.4.6.2    2021-09-03 [1] CRAN (R 4.5.0)
    rmarkdown            2.30       2025-09-28 [1] CRAN (R 4.5.0)
    rnaturalearth        1.1.0      2025-07-28 [1] CRAN (R 4.5.0)
    rnaturalearthhires   1.0.0.9000 2025-10-02 [1] Github (ropensci/rnaturalearthhires@e4736f6)
    RPostgres            1.4.8      2025-02-25 [1] CRAN (R 4.5.0)
    rprojroot            2.1.1      2025-08-26 [1] CRAN (R 4.5.0)
    rstudioapi           0.18.0     2026-01-16 [1] CRAN (R 4.5.2)
    S7                   0.2.1      2025-11-14 [1] CRAN (R 4.5.2)
    sass                 0.4.10     2025-04-11 [1] CRAN (R 4.5.0)
    satellite            1.0.6      2025-08-21 [1] CRAN (R 4.5.0)
    scales               1.4.0      2025-04-24 [1] CRAN (R 4.5.0)
    sessioninfo          1.2.3      2025-02-05 [1] CRAN (R 4.5.0)
    sf                 * 1.0-24     2026-01-13 [1] CRAN (R 4.5.2)
    shiny                1.11.1     2025-07-03 [1] CRAN (R 4.5.0)
    shinyWidgets         0.9.0      2025-02-21 [1] CRAN (R 4.5.0)
    snakecase            0.11.1     2023-08-27 [1] CRAN (R 4.5.0)
    sp                   2.2-0      2025-02-01 [1] CRAN (R 4.5.0)
    stars                0.6-8      2025-02-01 [1] CRAN (R 4.5.0)
    stringi              1.8.7      2025-03-27 [1] CRAN (R 4.5.0)
    stringr            * 1.6.0      2025-11-04 [1] CRAN (R 4.5.0)
    terra                1.8-93     2026-01-12 [1] CRAN (R 4.5.2)
    tibble             * 3.3.1      2026-01-11 [1] CRAN (R 4.5.2)
    tidyr              * 1.3.2      2025-12-19 [1] CRAN (R 4.5.2)
    tidyselect           1.2.1      2024-03-11 [1] CRAN (R 4.5.0)
    timechange           0.4.0      2026-01-29 [1] CRAN (R 4.5.2)
    TTR                  0.24.4     2023-11-28 [1] CRAN (R 4.5.0)
    tzdb                 0.5.0      2025-03-15 [1] CRAN (R 4.5.0)
    units              * 1.0-0      2025-10-09 [1] CRAN (R 4.5.0)
    usethis              3.2.1      2025-09-06 [1] CRAN (R 4.5.0)
    uuid                 1.2-2      2026-01-23 [1] CRAN (R 4.5.2)
    V8                   8.0.1      2025-10-10 [1] CRAN (R 4.5.0)
    vctrs                0.7.1      2026-01-23 [1] CRAN (R 4.5.2)
    viridisLite          0.4.2      2023-05-02 [1] CRAN (R 4.5.0)
    visNetwork           2.1.4      2025-09-04 [1] CRAN (R 4.5.0)
    vroom                1.7.0      2026-01-27 [1] CRAN (R 4.5.2)
    webshot2           * 0.1.2      2025-04-23 [1] CRAN (R 4.5.0)
    websocket            1.4.4      2025-04-10 [1] CRAN (R 4.5.0)
    withr                3.0.2      2024-10-28 [1] CRAN (R 4.5.0)
    xfun                 0.56       2026-01-18 [1] CRAN (R 4.5.2)
    xtable               1.8-4      2019-04-21 [1] CRAN (R 4.5.0)
    xts                  0.14.1     2024-10-15 [1] CRAN (R 4.5.0)
    yaml                 2.3.12     2025-12-10 [1] CRAN (R 4.5.2)
    zoo                  1.8-15     2025-12-15 [1] CRAN (R 4.5.2)

 [1] /Library/Frameworks/R.framework/Versions/4.5-arm64/Resources/library

 * ── Packages attached to the search path.
 V ── Loaded and on-disk version mismatch.
 P ── Loaded and on-disk path mismatch.

──────────────────────────────────────────────────────────────────────────────</code></pre>
</div>
</div>
</div>
</div>
</div>
<!-- -->

</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb58" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Ingest Bottle Database"</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>**Source**: <span class="co">[</span><span class="ot">Bottle Database | CalCOFI.org</span><span class="co">](https://calcofi.org/data/oceanographic-data/bottle-database/)</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Download: <span class="ot">&lt;https://calcofi.org/downloads/database/CalCOFI_Database_194903-202105_csv_16October2023.zip&gt;</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>**Goal**: Ingest bottle database from source CSV files into a local</span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>wrangling DuckDB, then export as parquet files for downstream use.</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>**Two source tables**:</span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`194903-202105_Cast.csv`</span> (61 fields) — station-level: cruise,</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  location, meteorology, integrated measurements</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`194903-202105_Bottle.csv`</span> (62 fields) — sample-level: depth,</span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  temperature, salinity, O₂, nutrients, pigments, C14, pH</span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>**Coverage**: 1949-03 to 2021-05 (72 years)</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a>**Join key**: <span class="in">`cast_id`</span> (in both tables; source column <span class="in">`Cst_Cnt`</span>)</span>
<span id="cb58-24"><a href="#cb58-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-25"><a href="#cb58-25" aria-hidden="true" tabindex="-1"></a>This workflow processes CalCOFI bottle database CSV files and outputs</span>
<span id="cb58-26"><a href="#cb58-26" aria-hidden="true" tabindex="-1"></a>parquet files. The workflow:</span>
<span id="cb58-27"><a href="#cb58-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-28"><a href="#cb58-28" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Reads CSV files from source directory (with GCS archive sync)</span>
<span id="cb58-29"><a href="#cb58-29" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Loads into local wrangling DuckDB with column renames</span>
<span id="cb58-30"><a href="#cb58-30" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Applies ship name/code corrections</span>
<span id="cb58-31"><a href="#cb58-31" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Consolidates temporal columns into <span class="in">`datetime_utc`</span>, drops derivable columns, creates <span class="in">`casts_derived`</span> VIEW</span>
<span id="cb58-32"><a href="#cb58-32" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Pivots bottle measurements into long-format <span class="in">`bottle_measurement`</span> table</span>
<span id="cb58-33"><a href="#cb58-33" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Pivots cast environmental conditions into <span class="in">`cast_condition`</span> table</span>
<span id="cb58-34"><a href="#cb58-34" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Loads <span class="in">`measurement_type`</span> reference table</span>
<span id="cb58-35"><a href="#cb58-35" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Validates primary keys and foreign key integrity</span>
<span id="cb58-36"><a href="#cb58-36" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Adds spatial geometry and grid assignments</span>
<span id="cb58-37"><a href="#cb58-37" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Exports to parquet files (for later integration into Working DuckLake)</span>
<span id="cb58-38"><a href="#cb58-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-41"><a href="#cb58-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-42"><a href="#cb58-42" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb58-43"><a href="#cb58-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-44"><a href="#cb58-44" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::install_local(here::here("../calcofi4db"), force = T)</span></span>
<span id="cb58-45"><a href="#cb58-45" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"../calcofi4db"</span>))</span>
<span id="cb58-46"><a href="#cb58-46" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"../calcofi4r"</span>))</span>
<span id="cb58-47"><a href="#cb58-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-48"><a href="#cb58-48" aria-hidden="true" tabindex="-1"></a>librarian<span class="sc">::</span><span class="fu">shelf</span>(</span>
<span id="cb58-49"><a href="#cb58-49" aria-hidden="true" tabindex="-1"></a>  CalCOFI<span class="sc">/</span>calcofi4db,</span>
<span id="cb58-50"><a href="#cb58-50" aria-hidden="true" tabindex="-1"></a>  CalCOFI<span class="sc">/</span>calcofi4r,</span>
<span id="cb58-51"><a href="#cb58-51" aria-hidden="true" tabindex="-1"></a>  DBI, dm, dplyr, DT, fs, glue, gargle, googledrive, here, htmltools,</span>
<span id="cb58-52"><a href="#cb58-52" aria-hidden="true" tabindex="-1"></a>  janitor, jsonlite, knitr, listviewer, litedown, lubridate, mapview,</span>
<span id="cb58-53"><a href="#cb58-53" aria-hidden="true" tabindex="-1"></a>  purrr, readr, rlang, sf, stringr, tibble, tidyr, units, webshot2,</span>
<span id="cb58-54"><a href="#cb58-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">quiet =</span> T)</span>
<span id="cb58-55"><a href="#cb58-55" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">readr.show_col_types =</span> F)</span>
<span id="cb58-56"><a href="#cb58-56" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">DT.options =</span> <span class="fu">list</span>(<span class="at">scrollX =</span> <span class="cn">TRUE</span>))</span>
<span id="cb58-57"><a href="#cb58-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-58"><a href="#cb58-58" aria-hidden="true" tabindex="-1"></a><span class="co"># define paths</span></span>
<span id="cb58-59"><a href="#cb58-59" aria-hidden="true" tabindex="-1"></a>provider     <span class="ot">&lt;-</span> <span class="st">"calcofi.org"</span></span>
<span id="cb58-60"><a href="#cb58-60" aria-hidden="true" tabindex="-1"></a>dataset      <span class="ot">&lt;-</span> <span class="st">"bottle-database"</span></span>
<span id="cb58-61"><a href="#cb58-61" aria-hidden="true" tabindex="-1"></a>dataset_name <span class="ot">&lt;-</span> <span class="st">"CalCOFI Bottle Database"</span></span>
<span id="cb58-62"><a href="#cb58-62" aria-hidden="true" tabindex="-1"></a>dir_data     <span class="ot">&lt;-</span> <span class="st">"~/My Drive/projects/calcofi/data-public"</span></span>
<span id="cb58-63"><a href="#cb58-63" aria-hidden="true" tabindex="-1"></a>subdir       <span class="ot">&lt;-</span> <span class="st">"CalCOFI_Database_194903-202105_csv_16October2023"</span></span>
<span id="cb58-64"><a href="#cb58-64" aria-hidden="true" tabindex="-1"></a>overwrite    <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb58-65"><a href="#cb58-65" aria-hidden="true" tabindex="-1"></a>dir_parquet  <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="fu">glue</span>(<span class="st">"data/parquet/{provider}_{dataset}"</span>))</span>
<span id="cb58-66"><a href="#cb58-66" aria-hidden="true" tabindex="-1"></a>db_path      <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="fu">glue</span>(<span class="st">"data/wrangling/{provider}_{dataset}.duckdb"</span>))</span>
<span id="cb58-67"><a href="#cb58-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-68"><a href="#cb58-68" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (overwrite){</span>
<span id="cb58-69"><a href="#cb58-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">file_exists</span>(db_path)) <span class="fu">file_delete</span>(db_path)</span>
<span id="cb58-70"><a href="#cb58-70" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dir_exists</span>(dir_parquet)) <span class="fu">dir_delete</span>(dir_parquet)</span>
<span id="cb58-71"><a href="#cb58-71" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-72"><a href="#cb58-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-73"><a href="#cb58-73" aria-hidden="true" tabindex="-1"></a><span class="fu">dir_create</span>(<span class="fu">dirname</span>(db_path))</span>
<span id="cb58-74"><a href="#cb58-74" aria-hidden="true" tabindex="-1"></a>con <span class="ot">&lt;-</span> <span class="fu">get_duckdb_con</span>(db_path)</span>
<span id="cb58-75"><a href="#cb58-75" aria-hidden="true" tabindex="-1"></a><span class="fu">load_duckdb_extension</span>(con, <span class="st">"spatial"</span>)</span>
<span id="cb58-76"><a href="#cb58-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-77"><a href="#cb58-77" aria-hidden="true" tabindex="-1"></a><span class="co"># load data using calcofi4db package</span></span>
<span id="cb58-78"><a href="#cb58-78" aria-hidden="true" tabindex="-1"></a><span class="co"># - reads from local Google Drive mount</span></span>
<span id="cb58-79"><a href="#cb58-79" aria-hidden="true" tabindex="-1"></a><span class="co"># - syncs to GCS archive if files changed (creates new timestamped archive)</span></span>
<span id="cb58-80"><a href="#cb58-80" aria-hidden="true" tabindex="-1"></a><span class="co"># - tracks GCS archive path for provenance</span></span>
<span id="cb58-81"><a href="#cb58-81" aria-hidden="true" tabindex="-1"></a>dir_dataset <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"{dir_data}/{provider}/{dataset}"</span>)</span>
<span id="cb58-82"><a href="#cb58-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-83"><a href="#cb58-83" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read_csv_files</span>(</span>
<span id="cb58-84"><a href="#cb58-84" aria-hidden="true" tabindex="-1"></a>  <span class="at">provider           =</span> provider,</span>
<span id="cb58-85"><a href="#cb58-85" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset            =</span> dataset,</span>
<span id="cb58-86"><a href="#cb58-86" aria-hidden="true" tabindex="-1"></a>  <span class="at">subdir             =</span> subdir,</span>
<span id="cb58-87"><a href="#cb58-87" aria-hidden="true" tabindex="-1"></a>  <span class="at">dir_data           =</span> dir_data,</span>
<span id="cb58-88"><a href="#cb58-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">sync_archive       =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-89"><a href="#cb58-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">metadata_dir       =</span> <span class="fu">here</span>(<span class="st">"metadata"</span>),</span>
<span id="cb58-90"><a href="#cb58-90" aria-hidden="true" tabindex="-1"></a>  <span class="at">field_descriptions =</span> <span class="fu">list</span>(</span>
<span id="cb58-91"><a href="#cb58-91" aria-hidden="true" tabindex="-1"></a>    <span class="st">"194903-202105_Cast"</span>   <span class="ot">=</span> <span class="fu">glue</span>(</span>
<span id="cb58-92"><a href="#cb58-92" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{dir_dataset}/Cast Field Descriptions.csv"</span>),</span>
<span id="cb58-93"><a href="#cb58-93" aria-hidden="true" tabindex="-1"></a>    <span class="st">"194903-202105_Bottle"</span> <span class="ot">=</span> <span class="fu">glue</span>(</span>
<span id="cb58-94"><a href="#cb58-94" aria-hidden="true" tabindex="-1"></a>      <span class="st">"{dir_dataset}/Bottle Field Descriptions - UTF-8.csv"</span>)))</span>
<span id="cb58-95"><a href="#cb58-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-96"><a href="#cb58-96" aria-hidden="true" tabindex="-1"></a><span class="co"># show source files summary</span></span>
<span id="cb58-97"><a href="#cb58-97" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Loaded {nrow(d$source_files)} tables from {d$paths$dir_csv}"</span>))</span>
<span id="cb58-98"><a href="#cb58-98" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total rows: {sum(d$source_files$nrow)}"</span>))</span>
<span id="cb58-99"><a href="#cb58-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-100"><a href="#cb58-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-101"><a href="#cb58-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check for any mismatched tables and fields</span></span>
<span id="cb58-102"><a href="#cb58-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-105"><a href="#cb58-105" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-106"><a href="#cb58-106" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data_integrity_check</span></span>
<span id="cb58-107"><a href="#cb58-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-108"><a href="#cb58-108" aria-hidden="true" tabindex="-1"></a><span class="co"># check data integrity</span></span>
<span id="cb58-109"><a href="#cb58-109" aria-hidden="true" tabindex="-1"></a><span class="co"># type_exceptions = "all": type mismatches (34) are expected since readr</span></span>
<span id="cb58-110"><a href="#cb58-110" aria-hidden="true" tabindex="-1"></a><span class="co"># infers types differently (e.g. quality codes as numeric, Time as hms);</span></span>
<span id="cb58-111"><a href="#cb58-111" aria-hidden="true" tabindex="-1"></a><span class="co"># these are resolved during ingestion via flds_redefine.csv type_new</span></span>
<span id="cb58-112"><a href="#cb58-112" aria-hidden="true" tabindex="-1"></a>integrity <span class="ot">&lt;-</span> <span class="fu">check_data_integrity</span>(</span>
<span id="cb58-113"><a href="#cb58-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">d               =</span> d,</span>
<span id="cb58-114"><a href="#cb58-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset_name    =</span> dataset_name,</span>
<span id="cb58-115"><a href="#cb58-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">type_exceptions =</span> <span class="st">"all"</span>)</span>
<span id="cb58-116"><a href="#cb58-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-117"><a href="#cb58-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-120"><a href="#cb58-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-121"><a href="#cb58-121" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: data_integrity_message</span></span>
<span id="cb58-122"><a href="#cb58-122" aria-hidden="true" tabindex="-1"></a><span class="co">#| output: asis</span></span>
<span id="cb58-123"><a href="#cb58-123" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb58-124"><a href="#cb58-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-125"><a href="#cb58-125" aria-hidden="true" tabindex="-1"></a><span class="co"># render the pass/fail message as markdown</span></span>
<span id="cb58-126"><a href="#cb58-126" aria-hidden="true" tabindex="-1"></a><span class="fu">render_integrity_message</span>(integrity)</span>
<span id="cb58-127"><a href="#cb58-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-128"><a href="#cb58-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-129"><a href="#cb58-129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Show Source Files</span></span>
<span id="cb58-130"><a href="#cb58-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-133"><a href="#cb58-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-134"><a href="#cb58-134" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: source-files</span></span>
<span id="cb58-135"><a href="#cb58-135" aria-hidden="true" tabindex="-1"></a><span class="fu">show_source_files</span>(d)</span>
<span id="cb58-136"><a href="#cb58-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-137"><a href="#cb58-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-138"><a href="#cb58-138" aria-hidden="true" tabindex="-1"></a><span class="fu">## Show CSV Tables and Fields to Ingest</span></span>
<span id="cb58-139"><a href="#cb58-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-142"><a href="#cb58-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-143"><a href="#cb58-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbls_in</span></span>
<span id="cb58-144"><a href="#cb58-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-145"><a href="#cb58-145" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>d_csv<span class="sc">$</span>tables <span class="sc">|&gt;</span></span>
<span id="cb58-146"><a href="#cb58-146" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Tables to ingest."</span>)</span>
<span id="cb58-147"><a href="#cb58-147" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-148"><a href="#cb58-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-151"><a href="#cb58-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-152"><a href="#cb58-152" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: flds_in</span></span>
<span id="cb58-153"><a href="#cb58-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-154"><a href="#cb58-154" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>d_csv<span class="sc">$</span>fields <span class="sc">|&gt;</span></span>
<span id="cb58-155"><a href="#cb58-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Fields to ingest."</span>)</span>
<span id="cb58-156"><a href="#cb58-156" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-157"><a href="#cb58-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-158"><a href="#cb58-158" aria-hidden="true" tabindex="-1"></a><span class="fu">## Show tables and fields redefined</span></span>
<span id="cb58-159"><a href="#cb58-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-162"><a href="#cb58-162" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-163"><a href="#cb58-163" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbls_rd</span></span>
<span id="cb58-164"><a href="#cb58-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-165"><a href="#cb58-165" aria-hidden="true" tabindex="-1"></a><span class="fu">show_tables_redefine</span>(d)</span>
<span id="cb58-166"><a href="#cb58-166" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-167"><a href="#cb58-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-170"><a href="#cb58-170" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-171"><a href="#cb58-171" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: flds_rd</span></span>
<span id="cb58-172"><a href="#cb58-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-173"><a href="#cb58-173" aria-hidden="true" tabindex="-1"></a><span class="fu">show_fields_redefine</span>(d)</span>
<span id="cb58-174"><a href="#cb58-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-175"><a href="#cb58-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-176"><a href="#cb58-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Tables into Database</span></span>
<span id="cb58-177"><a href="#cb58-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-180"><a href="#cb58-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-181"><a href="#cb58-181" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_tbls_to_db</span></span>
<span id="cb58-182"><a href="#cb58-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-183"><a href="#cb58-183" aria-hidden="true" tabindex="-1"></a><span class="co"># use ingest_dataset() which handles:</span></span>
<span id="cb58-184"><a href="#cb58-184" aria-hidden="true" tabindex="-1"></a><span class="co"># - transform_data() for applying redefinitions</span></span>
<span id="cb58-185"><a href="#cb58-185" aria-hidden="true" tabindex="-1"></a><span class="co"># - provenance tracking via gcs_path from read_csv_files()</span></span>
<span id="cb58-186"><a href="#cb58-186" aria-hidden="true" tabindex="-1"></a><span class="co"># - ingest_to_working() for each table</span></span>
<span id="cb58-187"><a href="#cb58-187" aria-hidden="true" tabindex="-1"></a>tbl_stats <span class="ot">&lt;-</span> <span class="fu">ingest_dataset</span>(</span>
<span id="cb58-188"><a href="#cb58-188" aria-hidden="true" tabindex="-1"></a>  <span class="at">con     =</span> con,</span>
<span id="cb58-189"><a href="#cb58-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">d       =</span> d,</span>
<span id="cb58-190"><a href="#cb58-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode    =</span> <span class="cf">if</span> (overwrite) <span class="st">"replace"</span> <span class="cf">else</span> <span class="st">"append"</span>,</span>
<span id="cb58-191"><a href="#cb58-191" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-192"><a href="#cb58-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-193"><a href="#cb58-193" aria-hidden="true" tabindex="-1"></a>tbl_stats <span class="sc">|&gt;</span></span>
<span id="cb58-194"><a href="#cb58-194" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">rownames =</span> <span class="cn">FALSE</span>, <span class="at">filter =</span> <span class="st">"top"</span>)</span>
<span id="cb58-195"><a href="#cb58-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-196"><a href="#cb58-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-197"><a href="#cb58-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## Apply Ship Corrections</span></span>
<span id="cb58-198"><a href="#cb58-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-199"><a href="#cb58-199" aria-hidden="true" tabindex="-1"></a>Apply known ship name/code corrections from <span class="in">`ship_renames.csv`</span>.</span>
<span id="cb58-200"><a href="#cb58-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-203"><a href="#cb58-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-204"><a href="#cb58-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: apply_ship_corrections</span></span>
<span id="cb58-205"><a href="#cb58-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-206"><a href="#cb58-206" aria-hidden="true" tabindex="-1"></a>ship_renames_csv <span class="ot">&lt;-</span> <span class="fu">here</span>(</span>
<span id="cb58-207"><a href="#cb58-207" aria-hidden="true" tabindex="-1"></a>  <span class="st">"metadata/calcofi.org/bottle-database/ship_renames.csv"</span>)</span>
<span id="cb58-208"><a href="#cb58-208" aria-hidden="true" tabindex="-1"></a>d_ship_renames <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(ship_renames_csv)</span>
<span id="cb58-209"><a href="#cb58-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-210"><a href="#cb58-210" aria-hidden="true" tabindex="-1"></a><span class="co"># apply each correction</span></span>
<span id="cb58-211"><a href="#cb58-211" aria-hidden="true" tabindex="-1"></a>n_updated_total <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb58-212"><a href="#cb58-212" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(<span class="fu">nrow</span>(d_ship_renames))) {</span>
<span id="cb58-213"><a href="#cb58-213" aria-hidden="true" tabindex="-1"></a>  old_name <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_name[i]</span>
<span id="cb58-214"><a href="#cb58-214" aria-hidden="true" tabindex="-1"></a>  old_code <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_code[i]</span>
<span id="cb58-215"><a href="#cb58-215" aria-hidden="true" tabindex="-1"></a>  new_name <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_name_new[i]</span>
<span id="cb58-216"><a href="#cb58-216" aria-hidden="true" tabindex="-1"></a>  new_code <span class="ot">&lt;-</span> d_ship_renames<span class="sc">$</span>csv_code_new[i]</span>
<span id="cb58-217"><a href="#cb58-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-218"><a href="#cb58-218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update where both name and code match old values</span></span>
<span id="cb58-219"><a href="#cb58-219" aria-hidden="true" tabindex="-1"></a>  n_updated <span class="ot">&lt;-</span> <span class="fu">dbExecute</span>(con, <span class="fu">glue_sql</span>(</span>
<span id="cb58-220"><a href="#cb58-220" aria-hidden="true" tabindex="-1"></a>    <span class="st">"UPDATE casts</span></span>
<span id="cb58-221"><a href="#cb58-221" aria-hidden="true" tabindex="-1"></a><span class="st">     SET ship_name = {new_name}, ship_code = {new_code}</span></span>
<span id="cb58-222"><a href="#cb58-222" aria-hidden="true" tabindex="-1"></a><span class="st">     WHERE ship_name = {old_name} AND ship_code = {old_code}"</span>,</span>
<span id="cb58-223"><a href="#cb58-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">.con =</span> con))</span>
<span id="cb58-224"><a href="#cb58-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-225"><a href="#cb58-225" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (n_updated <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb58-226"><a href="#cb58-226" aria-hidden="true" tabindex="-1"></a>    <span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb58-227"><a href="#cb58-227" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Updated {n_updated} casts: "</span>,</span>
<span id="cb58-228"><a href="#cb58-228" aria-hidden="true" tabindex="-1"></a>      <span class="st">"'{old_name}' [{old_code}] -&gt; '{new_name}' [{new_code}]"</span>))</span>
<span id="cb58-229"><a href="#cb58-229" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-230"><a href="#cb58-230" aria-hidden="true" tabindex="-1"></a>  n_updated_total <span class="ot">&lt;-</span> n_updated_total <span class="sc">+</span> n_updated</span>
<span id="cb58-231"><a href="#cb58-231" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-232"><a href="#cb58-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-233"><a href="#cb58-233" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Total casts updated: {n_updated_total}"</span>))</span>
<span id="cb58-234"><a href="#cb58-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-235"><a href="#cb58-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-236"><a href="#cb58-236" aria-hidden="true" tabindex="-1"></a><span class="fu">## Column Naming Rationale</span></span>
<span id="cb58-237"><a href="#cb58-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-238"><a href="#cb58-238" aria-hidden="true" tabindex="-1"></a>The column renames in <span class="in">`flds_redefine.csv`</span> follow these db conventions:</span>
<span id="cb58-239"><a href="#cb58-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-240"><a href="#cb58-240" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`*_id`** for integer primary/foreign keys (e.g. <span class="in">`Cst_Cnt`</span> → <span class="in">`cast_id`</span>, <span class="in">`Btl_Cnt`</span> → <span class="in">`bottle_id`</span>)</span>
<span id="cb58-241"><a href="#cb58-241" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`*_key`** for varchar natural/composite keys (e.g. <span class="in">`Cast_ID`</span> → <span class="in">`cast_key`</span>, <span class="in">`Cruise_ID`</span> → <span class="in">`cruise_key`</span>, <span class="in">`Sta_ID`</span> → <span class="in">`sta_key`</span>)</span>
<span id="cb58-242"><a href="#cb58-242" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**unit suffixes** for measurements (e.g. <span class="in">`Depthm`</span> → <span class="in">`depth_m`</span>)</span>
<span id="cb58-243"><a href="#cb58-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-244"><a href="#cb58-244" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ambiguous column pairs</span></span>
<span id="cb58-245"><a href="#cb58-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-246"><a href="#cb58-246" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Column pair <span class="pp">|</span> Why different <span class="pp">|</span></span>
<span id="cb58-247"><a href="#cb58-247" aria-hidden="true" tabindex="-1"></a><span class="pp">|------------|---------------|</span></span>
<span id="cb58-248"><a href="#cb58-248" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Cst_Cnt`</span> (→ <span class="in">`cast_id`</span>) vs <span class="in">`Cast_ID`</span> (→ <span class="in">`cast_key`</span>) <span class="pp">|</span> integer counter (1, 2, 3...) vs varchar composite (19-4903CR-HY-060-0930-05400560) <span class="pp">|</span></span>
<span id="cb58-249"><a href="#cb58-249" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Sta_ID`</span> (→ <span class="in">`sta_key`</span>) vs <span class="in">`DbSta_ID`</span> (→ <span class="in">`db_sta_key`</span>) <span class="pp">|</span> "054.0 056.0" (space-separated) vs "05400560" (compact, derivable) <span class="pp">|</span></span>
<span id="cb58-250"><a href="#cb58-250" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`Depth_ID`</span> (→ <span class="in">`depth_key`</span>) vs <span class="in">`Depthm`</span> (→ <span class="in">`depth_m`</span>) <span class="pp">|</span> varchar identifier vs numeric depth in meters <span class="pp">|</span></span>
<span id="cb58-251"><a href="#cb58-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-252"><a href="#cb58-252" aria-hidden="true" tabindex="-1"></a><span class="fu">### `R_*` = "Reported" (pre-QC) values</span></span>
<span id="cb58-253"><a href="#cb58-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-254"><a href="#cb58-254" aria-hidden="true" tabindex="-1"></a>The <span class="in">`R_*`</span> prefix means original instrument values before quality control.</span>
<span id="cb58-255"><a href="#cb58-255" aria-hidden="true" tabindex="-1"></a>**Critical**: <span class="in">`R_Sal`</span> (Specific Volume Anomaly, values ~233, units 10⁻⁸ m³/kg)</span>
<span id="cb58-256"><a href="#cb58-256" aria-hidden="true" tabindex="-1"></a>is a **completely different parameter/scale** than <span class="in">`Salnty`</span> (Practical Salinity</span>
<span id="cb58-257"><a href="#cb58-257" aria-hidden="true" tabindex="-1"></a>PSS-78, values ~33.44). These are pivoted as distinct measurement types</span>
<span id="cb58-258"><a href="#cb58-258" aria-hidden="true" tabindex="-1"></a>(<span class="in">`r_salinity_sva`</span> vs <span class="in">`salinity`</span>).</span>
<span id="cb58-259"><a href="#cb58-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-260"><a href="#cb58-260" aria-hidden="true" tabindex="-1"></a><span class="fu">## Consolidate Casts Columns</span></span>
<span id="cb58-261"><a href="#cb58-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-262"><a href="#cb58-262" aria-hidden="true" tabindex="-1"></a>Combine <span class="in">`date`</span> + <span class="in">`time`</span> into <span class="in">`datetime_utc`</span>, drop 16 derivable columns,</span>
<span id="cb58-263"><a href="#cb58-263" aria-hidden="true" tabindex="-1"></a>and create a <span class="in">`casts_derived`</span> convenience VIEW.</span>
<span id="cb58-264"><a href="#cb58-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-267"><a href="#cb58-267" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-268"><a href="#cb58-268" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: consolidate_casts</span></span>
<span id="cb58-269"><a href="#cb58-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-270"><a href="#cb58-270" aria-hidden="true" tabindex="-1"></a><span class="co"># -- create datetime_utc from date (DATE) + time (INTERVAL) ----</span></span>
<span id="cb58-271"><a href="#cb58-271" aria-hidden="true" tabindex="-1"></a><span class="co"># date is DATE type (e.g. 1949-03-01), time is INTERVAL (e.g. 09:30:00)</span></span>
<span id="cb58-272"><a href="#cb58-272" aria-hidden="true" tabindex="-1"></a><span class="co"># adding DATE + INTERVAL yields TIMESTAMP; 324 casts have NULL time</span></span>
<span id="cb58-273"><a href="#cb58-273" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"ALTER TABLE casts ADD COLUMN datetime_utc TIMESTAMP"</span>)</span>
<span id="cb58-274"><a href="#cb58-274" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"</span></span>
<span id="cb58-275"><a href="#cb58-275" aria-hidden="true" tabindex="-1"></a><span class="st">  UPDATE casts SET datetime_utc =</span></span>
<span id="cb58-276"><a href="#cb58-276" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE</span></span>
<span id="cb58-277"><a href="#cb58-277" aria-hidden="true" tabindex="-1"></a><span class="st">      WHEN </span><span class="sc">\"</span><span class="st">time</span><span class="sc">\"</span><span class="st"> IS NOT NULL</span></span>
<span id="cb58-278"><a href="#cb58-278" aria-hidden="true" tabindex="-1"></a><span class="st">      THEN CAST(</span><span class="sc">\"</span><span class="st">date</span><span class="sc">\"</span><span class="st"> AS TIMESTAMP) + </span><span class="sc">\"</span><span class="st">time</span><span class="sc">\"</span></span>
<span id="cb58-279"><a href="#cb58-279" aria-hidden="true" tabindex="-1"></a><span class="st">      ELSE CAST(</span><span class="sc">\"</span><span class="st">date</span><span class="sc">\"</span><span class="st"> AS TIMESTAMP)</span></span>
<span id="cb58-280"><a href="#cb58-280" aria-hidden="true" tabindex="-1"></a><span class="st">    END"</span>)</span>
<span id="cb58-281"><a href="#cb58-281" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb58-282"><a href="#cb58-282" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Created datetime_utc: {dbGetQuery(con, 'SELECT COUNT(*) FROM casts WHERE datetime_utc IS NOT NULL')[[1]]} non-null values"</span>))</span>
<span id="cb58-283"><a href="#cb58-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-284"><a href="#cb58-284" aria-hidden="true" tabindex="-1"></a><span class="co"># -- drop derivable columns ----</span></span>
<span id="cb58-285"><a href="#cb58-285" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb58-286"><a href="#cb58-286" aria-hidden="true" tabindex="-1"></a>  <span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"quarter"</span>, <span class="st">"julian_day"</span>, <span class="st">"julian_date"</span>,</span>
<span id="cb58-287"><a href="#cb58-287" aria-hidden="true" tabindex="-1"></a>  <span class="st">"time_zone"</span>,</span>
<span id="cb58-288"><a href="#cb58-288" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lat_deg"</span>, <span class="st">"lat_min"</span>, <span class="st">"lat_hem"</span>,</span>
<span id="cb58-289"><a href="#cb58-289" aria-hidden="true" tabindex="-1"></a>  <span class="st">"lon_deg"</span>, <span class="st">"lon_min"</span>, <span class="st">"lon_hem"</span>,</span>
<span id="cb58-290"><a href="#cb58-290" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cruise"</span>, <span class="st">"cruz_sta"</span>, <span class="st">"db_sta_key"</span>, <span class="st">"cruz_num"</span>)</span>
<span id="cb58-291"><a href="#cb58-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-292"><a href="#cb58-292" aria-hidden="true" tabindex="-1"></a><span class="co"># drop date and time (replaced by datetime_utc)</span></span>
<span id="cb58-293"><a href="#cb58-293" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(cols_to_drop, <span class="st">"date"</span>, <span class="st">"time"</span>)</span>
<span id="cb58-294"><a href="#cb58-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-295"><a href="#cb58-295" aria-hidden="true" tabindex="-1"></a>n_before <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb58-296"><a href="#cb58-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-297"><a href="#cb58-297" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cols_to_drop) {</span>
<span id="cb58-298"><a href="#cb58-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb58-299"><a href="#cb58-299" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(con, <span class="fu">glue</span>(<span class="st">'ALTER TABLE casts DROP COLUMN "{col}"'</span>)),</span>
<span id="cb58-300"><a href="#cb58-300" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">warning</span>(<span class="fu">glue</span>(<span class="st">"could not drop {col}: {e$message}"</span>)))</span>
<span id="cb58-301"><a href="#cb58-301" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-302"><a href="#cb58-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-303"><a href="#cb58-303" aria-hidden="true" tabindex="-1"></a>n_after <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb58-304"><a href="#cb58-304" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"casts columns: {n_before} -&gt; {n_after} (dropped {n_before - n_after})"</span>))</span>
<span id="cb58-305"><a href="#cb58-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-306"><a href="#cb58-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-307"><a href="#cb58-307" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pivot Bottle Measurements</span></span>
<span id="cb58-308"><a href="#cb58-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-309"><a href="#cb58-309" aria-hidden="true" tabindex="-1"></a>Pivot wide-format measurement columns from <span class="in">`bottle`</span> into long-format</span>
<span id="cb58-310"><a href="#cb58-310" aria-hidden="true" tabindex="-1"></a><span class="in">`bottle_measurement`</span> table. Each measurement type has a value, optional</span>
<span id="cb58-311"><a href="#cb58-311" aria-hidden="true" tabindex="-1"></a>precision, and optional quality code.</span>
<span id="cb58-312"><a href="#cb58-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-315"><a href="#cb58-315" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb58-316"><a href="#cb58-316" aria-hidden="true" tabindex="-1"></a>%%| label: pivot_bottle_meas_diagram</span>
<span id="cb58-317"><a href="#cb58-317" aria-hidden="true" tabindex="-1"></a>%%| fig-cap: <span class="ot">"</span><span class="st">Pivot wide bottle columns into long-format bottle_measurement table.</span><span class="ot">"</span></span>
<span id="cb58-318"><a href="#cb58-318" aria-hidden="true" tabindex="-1"></a>erDiagram</span>
<span id="cb58-319"><a href="#cb58-319" aria-hidden="true" tabindex="-1"></a>    bottle_BEFORE {</span>
<span id="cb58-320"><a href="#cb58-320" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> bottle_id PK</span>
<span id="cb58-321"><a href="#cb58-321" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> cast_id FK</span>
<span id="cb58-322"><a href="#cb58-322" aria-hidden="true" tabindex="-1"></a>        dbl depth_m</span>
<span id="cb58-323"><a href="#cb58-323" aria-hidden="true" tabindex="-1"></a>        dbl t_deg_c</span>
<span id="cb58-324"><a href="#cb58-324" aria-hidden="true" tabindex="-1"></a>        dbl t_prec</span>
<span id="cb58-325"><a href="#cb58-325" aria-hidden="true" tabindex="-1"></a>        str t_qual</span>
<span id="cb58-326"><a href="#cb58-326" aria-hidden="true" tabindex="-1"></a>        dbl salnty</span>
<span id="cb58-327"><a href="#cb58-327" aria-hidden="true" tabindex="-1"></a>        dbl s_prec</span>
<span id="cb58-328"><a href="#cb58-328" aria-hidden="true" tabindex="-1"></a>        str s_qual</span>
<span id="cb58-329"><a href="#cb58-329" aria-hidden="true" tabindex="-1"></a>        dbl o2ml_l</span>
<span id="cb58-330"><a href="#cb58-330" aria-hidden="true" tabindex="-1"></a>        str o_qual</span>
<span id="cb58-331"><a href="#cb58-331" aria-hidden="true" tabindex="-1"></a>        dbl chlor_a</span>
<span id="cb58-332"><a href="#cb58-332" aria-hidden="true" tabindex="-1"></a>        str chlqua</span>
<span id="cb58-333"><a href="#cb58-333" aria-hidden="true" tabindex="-1"></a>        dbl _etc <span class="ot">"</span><span class="st">... 30 measurement columns</span><span class="ot">"</span></span>
<span id="cb58-334"><a href="#cb58-334" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-335"><a href="#cb58-335" aria-hidden="true" tabindex="-1"></a>    bottle_AFTER {</span>
<span id="cb58-336"><a href="#cb58-336" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> bottle_id PK</span>
<span id="cb58-337"><a href="#cb58-337" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> cast_id FK</span>
<span id="cb58-338"><a href="#cb58-338" aria-hidden="true" tabindex="-1"></a>        dbl depth_m</span>
<span id="cb58-339"><a href="#cb58-339" aria-hidden="true" tabindex="-1"></a>        str depth_qual</span>
<span id="cb58-340"><a href="#cb58-340" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-341"><a href="#cb58-341" aria-hidden="true" tabindex="-1"></a>    bottle_measurement {</span>
<span id="cb58-342"><a href="#cb58-342" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> bottle_measurement_id PK</span>
<span id="cb58-343"><a href="#cb58-343" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> bottle_id FK</span>
<span id="cb58-344"><a href="#cb58-344" aria-hidden="true" tabindex="-1"></a>        str measurement_type</span>
<span id="cb58-345"><a href="#cb58-345" aria-hidden="true" tabindex="-1"></a>        dbl measurement_value</span>
<span id="cb58-346"><a href="#cb58-346" aria-hidden="true" tabindex="-1"></a>        dbl measurement_prec</span>
<span id="cb58-347"><a href="#cb58-347" aria-hidden="true" tabindex="-1"></a>        str measurement_qual</span>
<span id="cb58-348"><a href="#cb58-348" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-349"><a href="#cb58-349" aria-hidden="true" tabindex="-1"></a>    bottle_BEFORE ||--|{ bottle_measurement : <span class="ot">"</span><span class="st">pivot into</span><span class="ot">"</span></span>
<span id="cb58-350"><a href="#cb58-350" aria-hidden="true" tabindex="-1"></a>    bottle_AFTER ||-<span class="ot">-o</span>{ bottle_measurement : <span class="ot">"</span><span class="st">bottle_id</span><span class="ot">"</span></span>
<span id="cb58-351"><a href="#cb58-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-352"><a href="#cb58-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-355"><a href="#cb58-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-356"><a href="#cb58-356" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pivot_bottle_measurements</span></span>
<span id="cb58-357"><a href="#cb58-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-358"><a href="#cb58-358" aria-hidden="true" tabindex="-1"></a><span class="co"># define measurement mapping: type -&gt; value/prec/qual columns</span></span>
<span id="cb58-359"><a href="#cb58-359" aria-hidden="true" tabindex="-1"></a>bottle_meas_map <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb58-360"><a href="#cb58-360" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>measurement_type,     <span class="sc">~</span>value_col,      <span class="sc">~</span>prec_col,  <span class="sc">~</span>qual_col,</span>
<span id="cb58-361"><a href="#cb58-361" aria-hidden="true" tabindex="-1"></a>  <span class="st">"temperature"</span>,         <span class="st">"t_deg_c"</span>,       <span class="st">"t_prec"</span>,   <span class="st">"t_qual"</span>,</span>
<span id="cb58-362"><a href="#cb58-362" aria-hidden="true" tabindex="-1"></a>  <span class="st">"salinity"</span>,            <span class="st">"salnty"</span>,        <span class="st">"s_prec"</span>,   <span class="st">"s_qual"</span>,</span>
<span id="cb58-363"><a href="#cb58-363" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oxygen_ml_l"</span>,         <span class="st">"o2ml_l"</span>,        <span class="cn">NA</span>,         <span class="st">"o_qual"</span>,</span>
<span id="cb58-364"><a href="#cb58-364" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sigma_theta"</span>,         <span class="st">"s_theta"</span>,       <span class="cn">NA</span>,         <span class="st">"s_thtaq"</span>,</span>
<span id="cb58-365"><a href="#cb58-365" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oxygen_saturation"</span>,   <span class="st">"o2sat"</span>,         <span class="cn">NA</span>,         <span class="st">"o2satq"</span>,</span>
<span id="cb58-366"><a href="#cb58-366" aria-hidden="true" tabindex="-1"></a>  <span class="st">"oxygen_umol_kg"</span>,      <span class="st">"oxy_umol_kg"</span>,   <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-367"><a href="#cb58-367" aria-hidden="true" tabindex="-1"></a>  <span class="st">"chlorophyll_a"</span>,       <span class="st">"chlor_a"</span>,       <span class="cn">NA</span>,         <span class="st">"chlqua"</span>,</span>
<span id="cb58-368"><a href="#cb58-368" aria-hidden="true" tabindex="-1"></a>  <span class="st">"phaeopigment"</span>,        <span class="st">"phaeop"</span>,        <span class="cn">NA</span>,         <span class="st">"phaqua"</span>,</span>
<span id="cb58-369"><a href="#cb58-369" aria-hidden="true" tabindex="-1"></a>  <span class="st">"phosphate"</span>,           <span class="st">"po4u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"po4q"</span>,</span>
<span id="cb58-370"><a href="#cb58-370" aria-hidden="true" tabindex="-1"></a>  <span class="st">"silicate"</span>,            <span class="st">"si_o3u_m"</span>,      <span class="cn">NA</span>,         <span class="st">"si_o3qu"</span>,</span>
<span id="cb58-371"><a href="#cb58-371" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nitrite"</span>,             <span class="st">"no2u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"no2q"</span>,</span>
<span id="cb58-372"><a href="#cb58-372" aria-hidden="true" tabindex="-1"></a>  <span class="st">"nitrate"</span>,             <span class="st">"no3u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"no3q"</span>,</span>
<span id="cb58-373"><a href="#cb58-373" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ammonia"</span>,             <span class="st">"nh3u_m"</span>,        <span class="cn">NA</span>,         <span class="st">"nh3q"</span>,</span>
<span id="cb58-374"><a href="#cb58-374" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_rep1"</span>,            <span class="st">"c14as1"</span>,        <span class="st">"c14a1p"</span>,   <span class="st">"c14a1q"</span>,</span>
<span id="cb58-375"><a href="#cb58-375" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_rep2"</span>,            <span class="st">"c14as2"</span>,        <span class="st">"c14a2p"</span>,   <span class="st">"c14a2q"</span>,</span>
<span id="cb58-376"><a href="#cb58-376" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_dark"</span>,            <span class="st">"dark_as"</span>,       <span class="st">"dark_ap"</span>,  <span class="st">"darkaq"</span>,</span>
<span id="cb58-377"><a href="#cb58-377" aria-hidden="true" tabindex="-1"></a>  <span class="st">"c14_mean"</span>,            <span class="st">"mean_as"</span>,       <span class="st">"mean_ap"</span>,  <span class="st">"mean_aq"</span>,</span>
<span id="cb58-378"><a href="#cb58-378" aria-hidden="true" tabindex="-1"></a>  <span class="st">"light_pct"</span>,           <span class="st">"light_p"</span>,       <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-379"><a href="#cb58-379" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_depth"</span>,             <span class="st">"r_depth"</span>,       <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-380"><a href="#cb58-380" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_temperature"</span>,       <span class="st">"r_temp"</span>,        <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-381"><a href="#cb58-381" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_salinity_sva"</span>,      <span class="st">"r_sal"</span>,         <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-382"><a href="#cb58-382" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_dynamic_height"</span>,    <span class="st">"r_dynht"</span>,       <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-383"><a href="#cb58-383" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_ammonium"</span>,          <span class="st">"r_nuts"</span>,        <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-384"><a href="#cb58-384" aria-hidden="true" tabindex="-1"></a>  <span class="st">"r_oxygen_umol_kg"</span>,    <span class="st">"r_oxy_umol_kg"</span>, <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-385"><a href="#cb58-385" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dic_rep1"</span>,            <span class="st">"dic1"</span>,          <span class="cn">NA</span>,         <span class="st">"dic_quality_comment"</span>,</span>
<span id="cb58-386"><a href="#cb58-386" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dic_rep2"</span>,            <span class="st">"dic2"</span>,          <span class="cn">NA</span>,         <span class="st">"dic_quality_comment"</span>,</span>
<span id="cb58-387"><a href="#cb58-387" aria-hidden="true" tabindex="-1"></a>  <span class="st">"alkalinity_rep1"</span>,     <span class="st">"ta1"</span>,           <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-388"><a href="#cb58-388" aria-hidden="true" tabindex="-1"></a>  <span class="st">"alkalinity_rep2"</span>,     <span class="st">"ta2"</span>,           <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-389"><a href="#cb58-389" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ph_rep1"</span>,             <span class="st">"p_h1"</span>,          <span class="cn">NA</span>,         <span class="cn">NA</span>,</span>
<span id="cb58-390"><a href="#cb58-390" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ph_rep2"</span>,             <span class="st">"p_h2"</span>,          <span class="cn">NA</span>,         <span class="cn">NA</span>)</span>
<span id="cb58-391"><a href="#cb58-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-392"><a href="#cb58-392" aria-hidden="true" tabindex="-1"></a><span class="co"># build UNION ALL SQL from mapping</span></span>
<span id="cb58-393"><a href="#cb58-393" aria-hidden="true" tabindex="-1"></a>sql_parts <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_chr</span>(bottle_meas_map, <span class="cf">function</span>(</span>
<span id="cb58-394"><a href="#cb58-394" aria-hidden="true" tabindex="-1"></a>    measurement_type, value_col, prec_col, qual_col) {</span>
<span id="cb58-395"><a href="#cb58-395" aria-hidden="true" tabindex="-1"></a>  prec_expr <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.na</span>(prec_col)) <span class="st">"NULL"</span> <span class="cf">else</span> prec_col</span>
<span id="cb58-396"><a href="#cb58-396" aria-hidden="true" tabindex="-1"></a>  qual_expr <span class="ot">&lt;-</span> <span class="cf">if</span> (<span class="fu">is.na</span>(qual_col)) <span class="st">"NULL"</span> <span class="cf">else</span> qual_col</span>
<span id="cb58-397"><a href="#cb58-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(</span>
<span id="cb58-398"><a href="#cb58-398" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT bottle_id, '{measurement_type}' AS measurement_type,</span></span>
<span id="cb58-399"><a href="#cb58-399" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({value_col} AS DOUBLE) AS measurement_value,</span></span>
<span id="cb58-400"><a href="#cb58-400" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({prec_expr} AS DOUBLE) AS measurement_prec,</span></span>
<span id="cb58-401"><a href="#cb58-401" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({qual_expr} AS VARCHAR) AS measurement_qual</span></span>
<span id="cb58-402"><a href="#cb58-402" aria-hidden="true" tabindex="-1"></a><span class="st">     FROM bottle WHERE {value_col} IS NOT NULL"</span>)</span>
<span id="cb58-403"><a href="#cb58-403" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb58-404"><a href="#cb58-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-405"><a href="#cb58-405" aria-hidden="true" tabindex="-1"></a>sql_create <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb58-406"><a href="#cb58-406" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CREATE TABLE bottle_measurement AS</span></span>
<span id="cb58-407"><a href="#cb58-407" aria-hidden="true" tabindex="-1"></a><span class="st">   SELECT ROW_NUMBER() OVER (ORDER BY bottle_id, measurement_type)</span></span>
<span id="cb58-408"><a href="#cb58-408" aria-hidden="true" tabindex="-1"></a><span class="st">     AS bottle_measurement_id, *</span></span>
<span id="cb58-409"><a href="#cb58-409" aria-hidden="true" tabindex="-1"></a><span class="st">   FROM (</span></span>
<span id="cb58-410"><a href="#cb58-410" aria-hidden="true" tabindex="-1"></a><span class="st">     {paste(sql_parts, collapse = '</span><span class="sc">\n</span><span class="st">UNION ALL</span><span class="sc">\n</span><span class="st">')}</span></span>
<span id="cb58-411"><a href="#cb58-411" aria-hidden="true" tabindex="-1"></a><span class="st">   ) sub"</span>)</span>
<span id="cb58-412"><a href="#cb58-412" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, sql_create)</span>
<span id="cb58-413"><a href="#cb58-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-414"><a href="#cb58-414" aria-hidden="true" tabindex="-1"></a>n_meas <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM bottle_measurement"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-415"><a href="#cb58-415" aria-hidden="true" tabindex="-1"></a>n_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(DISTINCT measurement_type) FROM bottle_measurement"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-416"><a href="#cb58-416" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement: {format(n_meas, big.mark = ',')} rows, {n_types} measurement types"</span>))</span>
<span id="cb58-417"><a href="#cb58-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-418"><a href="#cb58-418" aria-hidden="true" tabindex="-1"></a><span class="co"># -- drop measurement columns from bottle base table ----</span></span>
<span id="cb58-419"><a href="#cb58-419" aria-hidden="true" tabindex="-1"></a>cols_to_drop <span class="ot">&lt;-</span> <span class="fu">unique</span>(<span class="fu">c</span>(</span>
<span id="cb58-420"><a href="#cb58-420" aria-hidden="true" tabindex="-1"></a>  bottle_meas_map<span class="sc">$</span>value_col,</span>
<span id="cb58-421"><a href="#cb58-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(bottle_meas_map<span class="sc">$</span>prec_col),</span>
<span id="cb58-422"><a href="#cb58-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(bottle_meas_map<span class="sc">$</span>qual_col)))</span>
<span id="cb58-423"><a href="#cb58-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-424"><a href="#cb58-424" aria-hidden="true" tabindex="-1"></a>n_before <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"bottle"</span>))</span>
<span id="cb58-425"><a href="#cb58-425" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cols_to_drop) {</span>
<span id="cb58-426"><a href="#cb58-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb58-427"><a href="#cb58-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(con, <span class="fu">glue</span>(<span class="st">'ALTER TABLE bottle DROP COLUMN "{col}"'</span>)),</span>
<span id="cb58-428"><a href="#cb58-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">warning</span>(<span class="fu">glue</span>(<span class="st">"could not drop {col}: {e$message}"</span>)))</span>
<span id="cb58-429"><a href="#cb58-429" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-430"><a href="#cb58-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-431"><a href="#cb58-431" aria-hidden="true" tabindex="-1"></a><span class="co"># rename p_qual to depth_qual (pressure/depth quality code stays in base table)</span></span>
<span id="cb58-432"><a href="#cb58-432" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">'ALTER TABLE bottle RENAME COLUMN p_qual TO depth_qual'</span>)</span>
<span id="cb58-433"><a href="#cb58-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-434"><a href="#cb58-434" aria-hidden="true" tabindex="-1"></a>n_after <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"bottle"</span>))</span>
<span id="cb58-435"><a href="#cb58-435" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle columns: {n_before} -&gt; {n_after} (dropped {n_before - n_after})"</span>))</span>
<span id="cb58-436"><a href="#cb58-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-437"><a href="#cb58-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-438"><a href="#cb58-438" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pivot Cast Conditions</span></span>
<span id="cb58-439"><a href="#cb58-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-440"><a href="#cb58-440" aria-hidden="true" tabindex="-1"></a>Pivot meteorological and environmental observation columns from <span class="in">`casts`</span></span>
<span id="cb58-441"><a href="#cb58-441" aria-hidden="true" tabindex="-1"></a>into long-format <span class="in">`cast_condition`</span> table.</span>
<span id="cb58-442"><a href="#cb58-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-445"><a href="#cb58-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{mermaid}</span></span>
<span id="cb58-446"><a href="#cb58-446" aria-hidden="true" tabindex="-1"></a>%%| label: pivot_cast_cond_diagram</span>
<span id="cb58-447"><a href="#cb58-447" aria-hidden="true" tabindex="-1"></a>%%| fig-cap: <span class="ot">"</span><span class="st">Pivot wide cast condition columns into long-format cast_condition table.</span><span class="ot">"</span></span>
<span id="cb58-448"><a href="#cb58-448" aria-hidden="true" tabindex="-1"></a>erDiagram</span>
<span id="cb58-449"><a href="#cb58-449" aria-hidden="true" tabindex="-1"></a>    casts_BEFORE {</span>
<span id="cb58-450"><a href="#cb58-450" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> cast_id PK</span>
<span id="cb58-451"><a href="#cb58-451" aria-hidden="true" tabindex="-1"></a>        str sta_key</span>
<span id="cb58-452"><a href="#cb58-452" aria-hidden="true" tabindex="-1"></a>        dbl lat_dec</span>
<span id="cb58-453"><a href="#cb58-453" aria-hidden="true" tabindex="-1"></a>        dbl lon_dec</span>
<span id="cb58-454"><a href="#cb58-454" aria-hidden="true" tabindex="-1"></a>        ts  datetime_utc</span>
<span id="cb58-455"><a href="#cb58-455" aria-hidden="true" tabindex="-1"></a>        dbl wave_dir</span>
<span id="cb58-456"><a href="#cb58-456" aria-hidden="true" tabindex="-1"></a>        dbl wave_ht</span>
<span id="cb58-457"><a href="#cb58-457" aria-hidden="true" tabindex="-1"></a>        dbl wave_prd</span>
<span id="cb58-458"><a href="#cb58-458" aria-hidden="true" tabindex="-1"></a>        dbl wind_dir</span>
<span id="cb58-459"><a href="#cb58-459" aria-hidden="true" tabindex="-1"></a>        dbl wind_spd</span>
<span id="cb58-460"><a href="#cb58-460" aria-hidden="true" tabindex="-1"></a>        dbl barometer</span>
<span id="cb58-461"><a href="#cb58-461" aria-hidden="true" tabindex="-1"></a>        dbl dry_t</span>
<span id="cb58-462"><a href="#cb58-462" aria-hidden="true" tabindex="-1"></a>        dbl wet_t</span>
<span id="cb58-463"><a href="#cb58-463" aria-hidden="true" tabindex="-1"></a>        dbl wea</span>
<span id="cb58-464"><a href="#cb58-464" aria-hidden="true" tabindex="-1"></a>        dbl cloud_typ</span>
<span id="cb58-465"><a href="#cb58-465" aria-hidden="true" tabindex="-1"></a>        dbl cloud_amt</span>
<span id="cb58-466"><a href="#cb58-466" aria-hidden="true" tabindex="-1"></a>        dbl visibility</span>
<span id="cb58-467"><a href="#cb58-467" aria-hidden="true" tabindex="-1"></a>        dbl secchi</span>
<span id="cb58-468"><a href="#cb58-468" aria-hidden="true" tabindex="-1"></a>        dbl forel_u</span>
<span id="cb58-469"><a href="#cb58-469" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-470"><a href="#cb58-470" aria-hidden="true" tabindex="-1"></a>    casts_AFTER {</span>
<span id="cb58-471"><a href="#cb58-471" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> cast_id PK</span>
<span id="cb58-472"><a href="#cb58-472" aria-hidden="true" tabindex="-1"></a>        str sta_key</span>
<span id="cb58-473"><a href="#cb58-473" aria-hidden="true" tabindex="-1"></a>        dbl lat_dec</span>
<span id="cb58-474"><a href="#cb58-474" aria-hidden="true" tabindex="-1"></a>        dbl lon_dec</span>
<span id="cb58-475"><a href="#cb58-475" aria-hidden="true" tabindex="-1"></a>        ts  datetime_utc</span>
<span id="cb58-476"><a href="#cb58-476" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-477"><a href="#cb58-477" aria-hidden="true" tabindex="-1"></a>    cast_condition {</span>
<span id="cb58-478"><a href="#cb58-478" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> cast_condition_id PK</span>
<span id="cb58-479"><a href="#cb58-479" aria-hidden="true" tabindex="-1"></a>        <span class="fu">int</span> cast_id FK</span>
<span id="cb58-480"><a href="#cb58-480" aria-hidden="true" tabindex="-1"></a>        str condition_type</span>
<span id="cb58-481"><a href="#cb58-481" aria-hidden="true" tabindex="-1"></a>        dbl condition_value</span>
<span id="cb58-482"><a href="#cb58-482" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-483"><a href="#cb58-483" aria-hidden="true" tabindex="-1"></a>    casts_BEFORE ||--|{ cast_condition : <span class="ot">"</span><span class="st">pivot into</span><span class="ot">"</span></span>
<span id="cb58-484"><a href="#cb58-484" aria-hidden="true" tabindex="-1"></a>    casts_AFTER ||-<span class="ot">-o</span>{ cast_condition : <span class="ot">"</span><span class="st">cast_id</span><span class="ot">"</span></span>
<span id="cb58-485"><a href="#cb58-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-486"><a href="#cb58-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-489"><a href="#cb58-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-490"><a href="#cb58-490" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pivot_cast_conditions</span></span>
<span id="cb58-491"><a href="#cb58-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-492"><a href="#cb58-492" aria-hidden="true" tabindex="-1"></a>cast_cond_map <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb58-493"><a href="#cb58-493" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>condition_type,        <span class="sc">~</span>source_col,</span>
<span id="cb58-494"><a href="#cb58-494" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wave_direction"</span>,       <span class="st">"wave_dir"</span>,</span>
<span id="cb58-495"><a href="#cb58-495" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wave_height"</span>,          <span class="st">"wave_ht"</span>,</span>
<span id="cb58-496"><a href="#cb58-496" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wave_period"</span>,          <span class="st">"wave_prd"</span>,</span>
<span id="cb58-497"><a href="#cb58-497" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wind_direction"</span>,       <span class="st">"wind_dir"</span>,</span>
<span id="cb58-498"><a href="#cb58-498" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wind_speed"</span>,           <span class="st">"wind_spd"</span>,</span>
<span id="cb58-499"><a href="#cb58-499" aria-hidden="true" tabindex="-1"></a>  <span class="st">"barometric_pressure"</span>,  <span class="st">"barometer"</span>,</span>
<span id="cb58-500"><a href="#cb58-500" aria-hidden="true" tabindex="-1"></a>  <span class="st">"dry_air_temp"</span>,         <span class="st">"dry_t"</span>,</span>
<span id="cb58-501"><a href="#cb58-501" aria-hidden="true" tabindex="-1"></a>  <span class="st">"wet_air_temp"</span>,         <span class="st">"wet_t"</span>,</span>
<span id="cb58-502"><a href="#cb58-502" aria-hidden="true" tabindex="-1"></a>  <span class="st">"weather_code"</span>,         <span class="st">"wea"</span>,</span>
<span id="cb58-503"><a href="#cb58-503" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cloud_type"</span>,           <span class="st">"cloud_typ"</span>,</span>
<span id="cb58-504"><a href="#cb58-504" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cloud_amount"</span>,         <span class="st">"cloud_amt"</span>,</span>
<span id="cb58-505"><a href="#cb58-505" aria-hidden="true" tabindex="-1"></a>  <span class="st">"visibility"</span>,           <span class="st">"visibility"</span>,</span>
<span id="cb58-506"><a href="#cb58-506" aria-hidden="true" tabindex="-1"></a>  <span class="st">"secchi_depth"</span>,         <span class="st">"secchi"</span>,</span>
<span id="cb58-507"><a href="#cb58-507" aria-hidden="true" tabindex="-1"></a>  <span class="st">"water_color"</span>,          <span class="st">"forel_u"</span>)</span>
<span id="cb58-508"><a href="#cb58-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-509"><a href="#cb58-509" aria-hidden="true" tabindex="-1"></a><span class="co"># build UNION ALL SQL</span></span>
<span id="cb58-510"><a href="#cb58-510" aria-hidden="true" tabindex="-1"></a>sql_parts <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_chr</span>(cast_cond_map, <span class="cf">function</span>(condition_type, source_col) {</span>
<span id="cb58-511"><a href="#cb58-511" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glue</span>(</span>
<span id="cb58-512"><a href="#cb58-512" aria-hidden="true" tabindex="-1"></a>    <span class="st">"SELECT cast_id, '{condition_type}' AS condition_type,</span></span>
<span id="cb58-513"><a href="#cb58-513" aria-hidden="true" tabindex="-1"></a><span class="st">       CAST({source_col} AS DOUBLE) AS condition_value</span></span>
<span id="cb58-514"><a href="#cb58-514" aria-hidden="true" tabindex="-1"></a><span class="st">     FROM casts WHERE {source_col} IS NOT NULL"</span>)</span>
<span id="cb58-515"><a href="#cb58-515" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb58-516"><a href="#cb58-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-517"><a href="#cb58-517" aria-hidden="true" tabindex="-1"></a>sql_create <span class="ot">&lt;-</span> <span class="fu">glue</span>(</span>
<span id="cb58-518"><a href="#cb58-518" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CREATE TABLE cast_condition AS</span></span>
<span id="cb58-519"><a href="#cb58-519" aria-hidden="true" tabindex="-1"></a><span class="st">   SELECT ROW_NUMBER() OVER (ORDER BY cast_id, condition_type)</span></span>
<span id="cb58-520"><a href="#cb58-520" aria-hidden="true" tabindex="-1"></a><span class="st">     AS cast_condition_id, *</span></span>
<span id="cb58-521"><a href="#cb58-521" aria-hidden="true" tabindex="-1"></a><span class="st">   FROM (</span></span>
<span id="cb58-522"><a href="#cb58-522" aria-hidden="true" tabindex="-1"></a><span class="st">     {paste(sql_parts, collapse = '</span><span class="sc">\n</span><span class="st">UNION ALL</span><span class="sc">\n</span><span class="st">')}</span></span>
<span id="cb58-523"><a href="#cb58-523" aria-hidden="true" tabindex="-1"></a><span class="st">   ) sub"</span>)</span>
<span id="cb58-524"><a href="#cb58-524" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, sql_create)</span>
<span id="cb58-525"><a href="#cb58-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-526"><a href="#cb58-526" aria-hidden="true" tabindex="-1"></a>n_cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM cast_condition"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-527"><a href="#cb58-527" aria-hidden="true" tabindex="-1"></a>n_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(DISTINCT condition_type) FROM cast_condition"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-528"><a href="#cb58-528" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition: {format(n_cond, big.mark = ',')} rows, {n_types} condition types"</span>))</span>
<span id="cb58-529"><a href="#cb58-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-530"><a href="#cb58-530" aria-hidden="true" tabindex="-1"></a><span class="co"># -- drop condition columns from casts ----</span></span>
<span id="cb58-531"><a href="#cb58-531" aria-hidden="true" tabindex="-1"></a>n_before <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb58-532"><a href="#cb58-532" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cast_cond_map<span class="sc">$</span>source_col) {</span>
<span id="cb58-533"><a href="#cb58-533" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tryCatch</span>(</span>
<span id="cb58-534"><a href="#cb58-534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dbExecute</span>(con, <span class="fu">glue</span>(<span class="st">'ALTER TABLE casts DROP COLUMN "{col}"'</span>)),</span>
<span id="cb58-535"><a href="#cb58-535" aria-hidden="true" tabindex="-1"></a>    <span class="at">error =</span> <span class="cf">function</span>(e) <span class="fu">warning</span>(<span class="fu">glue</span>(<span class="st">"could not drop {col}: {e$message}"</span>)))</span>
<span id="cb58-536"><a href="#cb58-536" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-537"><a href="#cb58-537" aria-hidden="true" tabindex="-1"></a>n_after <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">dbListFields</span>(con, <span class="st">"casts"</span>))</span>
<span id="cb58-538"><a href="#cb58-538" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"casts columns: {n_before} -&gt; {n_after} (dropped {n_before - n_after})"</span>))</span>
<span id="cb58-539"><a href="#cb58-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-540"><a href="#cb58-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-541"><a href="#cb58-541" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load Measurement Type Reference</span></span>
<span id="cb58-542"><a href="#cb58-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-543"><a href="#cb58-543" aria-hidden="true" tabindex="-1"></a>Load the <span class="in">`measurement_type`</span> lookup table that provides units and</span>
<span id="cb58-544"><a href="#cb58-544" aria-hidden="true" tabindex="-1"></a>descriptions for all measurement/condition types across datasets.</span>
<span id="cb58-545"><a href="#cb58-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-546"><a href="#cb58-546" aria-hidden="true" tabindex="-1"></a><span class="fu">### `measurement_type` vs `lookup`</span></span>
<span id="cb58-547"><a href="#cb58-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-548"><a href="#cb58-548" aria-hidden="true" tabindex="-1"></a>The <span class="in">`measurement_type`</span> table and the swfsc <span class="in">`lookup`</span> table serve fundamentally different purposes:</span>
<span id="cb58-549"><a href="#cb58-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-550"><a href="#cb58-550" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`measurement_type`** answers "what was measured?" — provides metadata (units, description, source provenance) for measurement codes used in <span class="in">`bottle_measurement`</span>, <span class="in">`cast_condition`</span>, and <span class="in">`ichthyo`</span></span>
<span id="cb58-551"><a href="#cb58-551" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**`lookup`** answers "what does this code mean?" — translates categorical values (egg developmental stages 1-11, larva stages, tow types) into human-readable descriptions</span>
<span id="cb58-552"><a href="#cb58-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-553"><a href="#cb58-553" aria-hidden="true" tabindex="-1"></a>Merging would create a sparse table with many NULL columns (e.g., <span class="in">`units`</span>/<span class="in">`_source_column`</span> NULL for egg stages; <span class="in">`lookup_num`</span>/<span class="in">`lookup_chr`</span> NULL for temperature). Both tables coexist in the Working DuckLake, loaded from their respective upstream workflows.</span>
<span id="cb58-554"><a href="#cb58-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-557"><a href="#cb58-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-558"><a href="#cb58-558" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_measurement_type</span></span>
<span id="cb58-559"><a href="#cb58-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-560"><a href="#cb58-560" aria-hidden="true" tabindex="-1"></a>meas_type_csv <span class="ot">&lt;-</span> <span class="fu">here</span>(</span>
<span id="cb58-561"><a href="#cb58-561" aria-hidden="true" tabindex="-1"></a>  <span class="st">"metadata/calcofi.org/bottle-database/measurement_type.csv"</span>)</span>
<span id="cb58-562"><a href="#cb58-562" aria-hidden="true" tabindex="-1"></a>d_meas_type <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(meas_type_csv)</span>
<span id="cb58-563"><a href="#cb58-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-564"><a href="#cb58-564" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(con, <span class="st">"measurement_type"</span>, d_meas_type, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-565"><a href="#cb58-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-566"><a href="#cb58-566" aria-hidden="true" tabindex="-1"></a><span class="co"># validate FK: all bottle_measurement types exist in reference table</span></span>
<span id="cb58-567"><a href="#cb58-567" aria-hidden="true" tabindex="-1"></a>orphan_btl_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-568"><a href="#cb58-568" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT measurement_type FROM bottle_measurement</span></span>
<span id="cb58-569"><a href="#cb58-569" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE measurement_type NOT IN (SELECT measurement_type FROM measurement_type)"</span>)</span>
<span id="cb58-570"><a href="#cb58-570" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(</span>
<span id="cb58-571"><a href="#cb58-571" aria-hidden="true" tabindex="-1"></a>  <span class="st">"all bottle_measurement.measurement_type must exist in measurement_type"</span> <span class="ot">=</span></span>
<span id="cb58-572"><a href="#cb58-572" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(orphan_btl_types) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-573"><a href="#cb58-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-574"><a href="#cb58-574" aria-hidden="true" tabindex="-1"></a><span class="co"># validate FK: all cast_condition types exist in reference table</span></span>
<span id="cb58-575"><a href="#cb58-575" aria-hidden="true" tabindex="-1"></a>orphan_cond_types <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-576"><a href="#cb58-576" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT DISTINCT condition_type FROM cast_condition</span></span>
<span id="cb58-577"><a href="#cb58-577" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE condition_type NOT IN (SELECT measurement_type FROM measurement_type)"</span>)</span>
<span id="cb58-578"><a href="#cb58-578" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(</span>
<span id="cb58-579"><a href="#cb58-579" aria-hidden="true" tabindex="-1"></a>  <span class="st">"all cast_condition.condition_type must exist in measurement_type"</span> <span class="ot">=</span></span>
<span id="cb58-580"><a href="#cb58-580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(orphan_cond_types) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-581"><a href="#cb58-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-582"><a href="#cb58-582" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"measurement_type: {nrow(d_meas_type)} types loaded, FK checks passed"</span>))</span>
<span id="cb58-583"><a href="#cb58-583" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-584"><a href="#cb58-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-585"><a href="#cb58-585" aria-hidden="true" tabindex="-1"></a><span class="fu">## Verify Primary Keys</span></span>
<span id="cb58-586"><a href="#cb58-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-589"><a href="#cb58-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-590"><a href="#cb58-590" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: verify_primary_keys</span></span>
<span id="cb58-591"><a href="#cb58-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-592"><a href="#cb58-592" aria-hidden="true" tabindex="-1"></a><span class="co"># verify cast_id uniqueness in casts</span></span>
<span id="cb58-593"><a href="#cb58-593" aria-hidden="true" tabindex="-1"></a>cast_keys <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"casts"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(cast_id)</span>
<span id="cb58-594"><a href="#cb58-594" aria-hidden="true" tabindex="-1"></a>n_dup_cast <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">duplicated</span>(cast_keys))</span>
<span id="cb58-595"><a href="#cb58-595" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"cast_id must be unique in casts"</span> <span class="ot">=</span> n_dup_cast <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-596"><a href="#cb58-596" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"casts.cast_id: {length(cast_keys)} unique values, 0 duplicates"</span>))</span>
<span id="cb58-597"><a href="#cb58-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-598"><a href="#cb58-598" aria-hidden="true" tabindex="-1"></a><span class="co"># verify bottle_id uniqueness in bottle</span></span>
<span id="cb58-599"><a href="#cb58-599" aria-hidden="true" tabindex="-1"></a>btl_keys <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"bottle"</span>) <span class="sc">|&gt;</span> <span class="fu">pull</span>(bottle_id)</span>
<span id="cb58-600"><a href="#cb58-600" aria-hidden="true" tabindex="-1"></a>n_dup_btl <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">duplicated</span>(btl_keys))</span>
<span id="cb58-601"><a href="#cb58-601" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"bottle_id must be unique in bottle"</span> <span class="ot">=</span> n_dup_btl <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-602"><a href="#cb58-602" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle.bottle_id: {length(btl_keys)} unique values, 0 duplicates"</span>))</span>
<span id="cb58-603"><a href="#cb58-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-604"><a href="#cb58-604" aria-hidden="true" tabindex="-1"></a><span class="co"># verify FK: bottle.cast_id -&gt; casts.cast_id</span></span>
<span id="cb58-605"><a href="#cb58-605" aria-hidden="true" tabindex="-1"></a>orphan_bottles <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"bottle"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-606"><a href="#cb58-606" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anti_join</span>(</span>
<span id="cb58-607"><a href="#cb58-607" aria-hidden="true" tabindex="-1"></a>    <span class="fu">tbl</span>(con, <span class="st">"casts"</span>),</span>
<span id="cb58-608"><a href="#cb58-608" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">"cast_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-609"><a href="#cb58-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">collect</span>()</span>
<span id="cb58-610"><a href="#cb58-610" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(</span>
<span id="cb58-611"><a href="#cb58-611" aria-hidden="true" tabindex="-1"></a>  <span class="st">"all bottle.cast_id must exist in casts.cast_id"</span> <span class="ot">=</span></span>
<span id="cb58-612"><a href="#cb58-612" aria-hidden="true" tabindex="-1"></a>    <span class="fu">nrow</span>(orphan_bottles) <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-613"><a href="#cb58-613" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb58-614"><a href="#cb58-614" aria-hidden="true" tabindex="-1"></a>  <span class="st">"FK integrity: all {length(btl_keys)} bottle.cast_id "</span>,</span>
<span id="cb58-615"><a href="#cb58-615" aria-hidden="true" tabindex="-1"></a>  <span class="st">"found in casts.cast_id"</span>))</span>
<span id="cb58-616"><a href="#cb58-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-617"><a href="#cb58-617" aria-hidden="true" tabindex="-1"></a><span class="co"># verify bottle_measurement_id uniqueness</span></span>
<span id="cb58-618"><a href="#cb58-618" aria-hidden="true" tabindex="-1"></a>n_dup_bm_id <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-619"><a href="#cb58-619" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb58-620"><a href="#cb58-620" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT bottle_measurement_id, COUNT(*) AS n</span></span>
<span id="cb58-621"><a href="#cb58-621" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM bottle_measurement</span></span>
<span id="cb58-622"><a href="#cb58-622" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY bottle_measurement_id</span></span>
<span id="cb58-623"><a href="#cb58-623" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-624"><a href="#cb58-624" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"bottle_measurement_id must be unique"</span> <span class="ot">=</span> n_dup_bm_id <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-625"><a href="#cb58-625" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement.bottle_measurement_id: unique, 0 duplicates"</span>))</span>
<span id="cb58-626"><a href="#cb58-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-627"><a href="#cb58-627" aria-hidden="true" tabindex="-1"></a><span class="co"># verify composite PK: bottle_measurement (bottle_id, measurement_type)</span></span>
<span id="cb58-628"><a href="#cb58-628" aria-hidden="true" tabindex="-1"></a>n_dup_meas <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-629"><a href="#cb58-629" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb58-630"><a href="#cb58-630" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT bottle_id, measurement_type, COUNT(*) AS n</span></span>
<span id="cb58-631"><a href="#cb58-631" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM bottle_measurement</span></span>
<span id="cb58-632"><a href="#cb58-632" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY bottle_id, measurement_type</span></span>
<span id="cb58-633"><a href="#cb58-633" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-634"><a href="#cb58-634" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"bottle_measurement (bottle_id, measurement_type) must be unique"</span> <span class="ot">=</span> n_dup_meas <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-635"><a href="#cb58-635" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement: composite key unique, 0 duplicates"</span>))</span>
<span id="cb58-636"><a href="#cb58-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-637"><a href="#cb58-637" aria-hidden="true" tabindex="-1"></a><span class="co"># verify FK: bottle_measurement.bottle_id -&gt; bottle.bottle_id</span></span>
<span id="cb58-638"><a href="#cb58-638" aria-hidden="true" tabindex="-1"></a>n_orphan_meas <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-639"><a href="#cb58-639" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(DISTINCT bottle_id) FROM bottle_measurement</span></span>
<span id="cb58-640"><a href="#cb58-640" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE bottle_id NOT IN (SELECT bottle_id FROM bottle)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-641"><a href="#cb58-641" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"all bottle_measurement.bottle_id must exist in bottle"</span> <span class="ot">=</span> n_orphan_meas <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-642"><a href="#cb58-642" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"bottle_measurement FK: all bottle_ids found in bottle"</span>))</span>
<span id="cb58-643"><a href="#cb58-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-644"><a href="#cb58-644" aria-hidden="true" tabindex="-1"></a><span class="co"># verify cast_condition_id uniqueness</span></span>
<span id="cb58-645"><a href="#cb58-645" aria-hidden="true" tabindex="-1"></a>n_dup_cc_id <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-646"><a href="#cb58-646" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb58-647"><a href="#cb58-647" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT cast_condition_id, COUNT(*) AS n</span></span>
<span id="cb58-648"><a href="#cb58-648" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM cast_condition</span></span>
<span id="cb58-649"><a href="#cb58-649" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY cast_condition_id</span></span>
<span id="cb58-650"><a href="#cb58-650" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-651"><a href="#cb58-651" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"cast_condition_id must be unique"</span> <span class="ot">=</span> n_dup_cc_id <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-652"><a href="#cb58-652" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition.cast_condition_id: unique, 0 duplicates"</span>))</span>
<span id="cb58-653"><a href="#cb58-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-654"><a href="#cb58-654" aria-hidden="true" tabindex="-1"></a><span class="co"># verify composite PK: cast_condition (cast_id, condition_type)</span></span>
<span id="cb58-655"><a href="#cb58-655" aria-hidden="true" tabindex="-1"></a>n_dup_cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-656"><a href="#cb58-656" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(*) FROM (</span></span>
<span id="cb58-657"><a href="#cb58-657" aria-hidden="true" tabindex="-1"></a><span class="st">    SELECT cast_id, condition_type, COUNT(*) AS n</span></span>
<span id="cb58-658"><a href="#cb58-658" aria-hidden="true" tabindex="-1"></a><span class="st">    FROM cast_condition</span></span>
<span id="cb58-659"><a href="#cb58-659" aria-hidden="true" tabindex="-1"></a><span class="st">    GROUP BY cast_id, condition_type</span></span>
<span id="cb58-660"><a href="#cb58-660" aria-hidden="true" tabindex="-1"></a><span class="st">    HAVING COUNT(*) &gt; 1)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-661"><a href="#cb58-661" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"cast_condition (cast_id, condition_type) must be unique"</span> <span class="ot">=</span> n_dup_cond <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-662"><a href="#cb58-662" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition: composite key unique, 0 duplicates"</span>))</span>
<span id="cb58-663"><a href="#cb58-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-664"><a href="#cb58-664" aria-hidden="true" tabindex="-1"></a><span class="co"># verify FK: cast_condition.cast_id -&gt; casts.cast_id</span></span>
<span id="cb58-665"><a href="#cb58-665" aria-hidden="true" tabindex="-1"></a>n_orphan_cond <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-666"><a href="#cb58-666" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT COUNT(DISTINCT cast_id) FROM cast_condition</span></span>
<span id="cb58-667"><a href="#cb58-667" aria-hidden="true" tabindex="-1"></a><span class="st">  WHERE cast_id NOT IN (SELECT cast_id FROM casts)"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-668"><a href="#cb58-668" aria-hidden="true" tabindex="-1"></a><span class="fu">stopifnot</span>(<span class="st">"all cast_condition.cast_id must exist in casts"</span> <span class="ot">=</span> n_orphan_cond <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb58-669"><a href="#cb58-669" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"cast_condition FK: all cast_ids found in casts"</span>))</span>
<span id="cb58-670"><a href="#cb58-670" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-671"><a href="#cb58-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-672"><a href="#cb58-672" aria-hidden="true" tabindex="-1"></a><span class="fu">## Schema Documentation</span></span>
<span id="cb58-673"><a href="#cb58-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-676"><a href="#cb58-676" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-677"><a href="#cb58-677" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dm_tbls</span></span>
<span id="cb58-678"><a href="#cb58-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-679"><a href="#cb58-679" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude views (casts_derived) — dm_from_con can't access views</span></span>
<span id="cb58-680"><a href="#cb58-680" aria-hidden="true" tabindex="-1"></a>db_tables <span class="ot">&lt;-</span> <span class="cf">function</span>(con) {</span>
<span id="cb58-681"><a href="#cb58-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setdiff</span>(<span class="fu">dbListTables</span>(con), <span class="st">"casts_derived"</span>) <span class="sc">|&gt;</span> <span class="fu">sort</span>()</span>
<span id="cb58-682"><a href="#cb58-682" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-683"><a href="#cb58-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-684"><a href="#cb58-684" aria-hidden="true" tabindex="-1"></a>tbls <span class="ot">&lt;-</span> <span class="fu">db_tables</span>(con)</span>
<span id="cb58-685"><a href="#cb58-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-686"><a href="#cb58-686" aria-hidden="true" tabindex="-1"></a><span class="co"># dm object for visualization (keys learned from data, not DB constraints)</span></span>
<span id="cb58-687"><a href="#cb58-687" aria-hidden="true" tabindex="-1"></a>dm_dev <span class="ot">&lt;-</span> <span class="fu">dm_from_con</span>(con, <span class="at">table_names =</span> tbls, <span class="at">learn_keys =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-688"><a href="#cb58-688" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(dm_dev, <span class="at">view_type =</span> <span class="st">"all"</span>)</span>
<span id="cb58-689"><a href="#cb58-689" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-690"><a href="#cb58-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-691"><a href="#cb58-691" aria-hidden="true" tabindex="-1"></a><span class="fu">### Primary Key Strategy</span></span>
<span id="cb58-692"><a href="#cb58-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-693"><a href="#cb58-693" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> Table <span class="pp">|</span> Primary Key <span class="pp">|</span> Type <span class="pp">|</span></span>
<span id="cb58-694"><a href="#cb58-694" aria-hidden="true" tabindex="-1"></a><span class="pp">|-------|-------------|------|</span></span>
<span id="cb58-695"><a href="#cb58-695" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`casts`</span> <span class="pp">|</span> <span class="in">`cast_id`</span> <span class="pp">|</span> Natural key (integer counter from source <span class="in">`Cst_Cnt`</span>) <span class="pp">|</span></span>
<span id="cb58-696"><a href="#cb58-696" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`bottle`</span> <span class="pp">|</span> <span class="in">`bottle_id`</span> <span class="pp">|</span> Natural key (integer counter from source <span class="in">`Btl_Cnt`</span>) <span class="pp">|</span></span>
<span id="cb58-697"><a href="#cb58-697" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`bottle_measurement`</span> <span class="pp">|</span> <span class="in">`bottle_measurement_id`</span> <span class="pp">|</span> Integer PK via <span class="in">`ROW_NUMBER(ORDER BY bottle_id, measurement_type)`</span>; composite <span class="in">`(bottle_id, measurement_type)`</span> enforced unique <span class="pp">|</span></span>
<span id="cb58-698"><a href="#cb58-698" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`cast_condition`</span> <span class="pp">|</span> <span class="in">`cast_condition_id`</span> <span class="pp">|</span> Integer PK via <span class="in">`ROW_NUMBER(ORDER BY cast_id, condition_type)`</span>; composite <span class="in">`(cast_id, condition_type)`</span> enforced unique <span class="pp">|</span></span>
<span id="cb58-699"><a href="#cb58-699" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`measurement_type`</span> <span class="pp">|</span> <span class="in">`measurement_type`</span> <span class="pp">|</span> Natural key (type code string) <span class="pp">|</span></span>
<span id="cb58-700"><a href="#cb58-700" aria-hidden="true" tabindex="-1"></a><span class="pp">|</span> <span class="in">`grid`</span> <span class="pp">|</span> <span class="in">`grid_key`</span> <span class="pp">|</span> Natural key <span class="pp">|</span></span>
<span id="cb58-701"><a href="#cb58-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-702"><a href="#cb58-702" aria-hidden="true" tabindex="-1"></a><span class="fu">### Foreign Key Relationships</span></span>
<span id="cb58-703"><a href="#cb58-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-704"><a href="#cb58-704" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-705"><a href="#cb58-705" aria-hidden="true" tabindex="-1"></a><span class="in">casts.cast_id (PK, integer) — station-level</span></span>
<span id="cb58-706"><a href="#cb58-706" aria-hidden="true" tabindex="-1"></a><span class="in">    ↓</span></span>
<span id="cb58-707"><a href="#cb58-707" aria-hidden="true" tabindex="-1"></a><span class="in">bottle.bottle_id (PK, integer) — sample-level</span></span>
<span id="cb58-708"><a href="#cb58-708" aria-hidden="true" tabindex="-1"></a><span class="in">bottle.cast_id (FK) → casts.cast_id</span></span>
<span id="cb58-709"><a href="#cb58-709" aria-hidden="true" tabindex="-1"></a><span class="in">    ↓</span></span>
<span id="cb58-710"><a href="#cb58-710" aria-hidden="true" tabindex="-1"></a><span class="in">bottle_measurement.bottle_measurement_id (PK, integer) — ROW_NUMBER(ORDER BY bottle_id, measurement_type)</span></span>
<span id="cb58-711"><a href="#cb58-711" aria-hidden="true" tabindex="-1"></a><span class="in">bottle_measurement.bottle_id (FK) → bottle.bottle_id</span></span>
<span id="cb58-712"><a href="#cb58-712" aria-hidden="true" tabindex="-1"></a><span class="in">bottle_measurement.measurement_type (FK) → measurement_type.measurement_type</span></span>
<span id="cb58-713"><a href="#cb58-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-714"><a href="#cb58-714" aria-hidden="true" tabindex="-1"></a><span class="in">cast_condition.cast_condition_id (PK, integer) — ROW_NUMBER(ORDER BY cast_id, condition_type)</span></span>
<span id="cb58-715"><a href="#cb58-715" aria-hidden="true" tabindex="-1"></a><span class="in">cast_condition.cast_id (FK) → casts.cast_id</span></span>
<span id="cb58-716"><a href="#cb58-716" aria-hidden="true" tabindex="-1"></a><span class="in">cast_condition.condition_type (FK) → measurement_type.measurement_type</span></span>
<span id="cb58-717"><a href="#cb58-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-718"><a href="#cb58-718" aria-hidden="true" tabindex="-1"></a><span class="in">casts.grid_key (FK) → grid.grid_key (after spatial join)</span></span>
<span id="cb58-719"><a href="#cb58-719" aria-hidden="true" tabindex="-1"></a><span class="in">casts.ship_code (soft FK) → ship.ship_nodc (validated after integration with swfsc)</span></span>
<span id="cb58-720"><a href="#cb58-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-721"><a href="#cb58-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-724"><a href="#cb58-724" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-725"><a href="#cb58-725" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: dm_fk</span></span>
<span id="cb58-726"><a href="#cb58-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-727"><a href="#cb58-727" aria-hidden="true" tabindex="-1"></a>tbls <span class="ot">&lt;-</span> <span class="fu">db_tables</span>(con)</span>
<span id="cb58-728"><a href="#cb58-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-729"><a href="#cb58-729" aria-hidden="true" tabindex="-1"></a>dm_dev <span class="ot">&lt;-</span> <span class="fu">dm_from_con</span>(con, <span class="at">table_names =</span> tbls, <span class="at">learn_keys =</span> <span class="cn">FALSE</span>)</span>
<span id="cb58-730"><a href="#cb58-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-731"><a href="#cb58-731" aria-hidden="true" tabindex="-1"></a><span class="co"># define relationships in dm (in-memory for visualization only)</span></span>
<span id="cb58-732"><a href="#cb58-732" aria-hidden="true" tabindex="-1"></a>add_bottle_keys <span class="ot">&lt;-</span> <span class="cf">function</span>(dm){</span>
<span id="cb58-733"><a href="#cb58-733" aria-hidden="true" tabindex="-1"></a>  dm <span class="sc">|&gt;</span></span>
<span id="cb58-734"><a href="#cb58-734" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(casts, cast_id) <span class="sc">|&gt;</span></span>
<span id="cb58-735"><a href="#cb58-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(bottle, bottle_id) <span class="sc">|&gt;</span></span>
<span id="cb58-736"><a href="#cb58-736" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(bottle_measurement, bottle_measurement_id) <span class="sc">|&gt;</span></span>
<span id="cb58-737"><a href="#cb58-737" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(cast_condition, cast_condition_id) <span class="sc">|&gt;</span></span>
<span id="cb58-738"><a href="#cb58-738" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(measurement_type, measurement_type) <span class="sc">|&gt;</span></span>
<span id="cb58-739"><a href="#cb58-739" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(bottle, cast_id, casts) <span class="sc">|&gt;</span></span>
<span id="cb58-740"><a href="#cb58-740" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(bottle_measurement, bottle_id, bottle) <span class="sc">|&gt;</span></span>
<span id="cb58-741"><a href="#cb58-741" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(bottle_measurement, measurement_type, measurement_type) <span class="sc">|&gt;</span></span>
<span id="cb58-742"><a href="#cb58-742" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(cast_condition, cast_id, casts) <span class="sc">|&gt;</span></span>
<span id="cb58-743"><a href="#cb58-743" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(cast_condition, condition_type, measurement_type, measurement_type)</span>
<span id="cb58-744"><a href="#cb58-744" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-745"><a href="#cb58-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-746"><a href="#cb58-746" aria-hidden="true" tabindex="-1"></a>dm_dev_fk <span class="ot">&lt;-</span> dm_dev <span class="sc">|&gt;</span></span>
<span id="cb58-747"><a href="#cb58-747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_bottle_keys</span>()</span>
<span id="cb58-748"><a href="#cb58-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-749"><a href="#cb58-749" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(dm_dev_fk, <span class="at">view_type =</span> <span class="st">"all"</span>)</span>
<span id="cb58-750"><a href="#cb58-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-751"><a href="#cb58-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-752"><a href="#cb58-752" aria-hidden="true" tabindex="-1"></a><span class="fu">## Add Spatial</span></span>
<span id="cb58-753"><a href="#cb58-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-754"><a href="#cb58-754" aria-hidden="true" tabindex="-1"></a><span class="fu">### Add `casts.geom`</span></span>
<span id="cb58-755"><a href="#cb58-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-758"><a href="#cb58-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-759"><a href="#cb58-759" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: mk_cast_pts</span></span>
<span id="cb58-760"><a href="#cb58-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-761"><a href="#cb58-761" aria-hidden="true" tabindex="-1"></a><span class="co"># add geometry column using DuckDB spatial</span></span>
<span id="cb58-762"><a href="#cb58-762" aria-hidden="true" tabindex="-1"></a><span class="co"># note: DuckDB spatial doesn't track SRID metadata (unlike PostGIS)</span></span>
<span id="cb58-763"><a href="#cb58-763" aria-hidden="true" tabindex="-1"></a><span class="co"># all geometries assumed WGS84 (EPSG:4326) by convention</span></span>
<span id="cb58-764"><a href="#cb58-764" aria-hidden="true" tabindex="-1"></a><span class="fu">add_point_geom</span>(con, <span class="st">"casts"</span>)</span>
<span id="cb58-765"><a href="#cb58-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-766"><a href="#cb58-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-767"><a href="#cb58-767" aria-hidden="true" tabindex="-1"></a><span class="fu">### Load `grid` table</span></span>
<span id="cb58-768"><a href="#cb58-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-769"><a href="#cb58-769" aria-hidden="true" tabindex="-1"></a>Load grid from the swfsc workflow's GCS parquet output (single source of</span>
<span id="cb58-770"><a href="#cb58-770" aria-hidden="true" tabindex="-1"></a>truth — grid is created in <span class="in">`ingest_swfsc.noaa.gov_calcofi-db.qmd`</span>).</span>
<span id="cb58-771"><a href="#cb58-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-774"><a href="#cb58-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-775"><a href="#cb58-775" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load_grid</span></span>
<span id="cb58-776"><a href="#cb58-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-777"><a href="#cb58-777" aria-hidden="true" tabindex="-1"></a><span class="fu">load_gcs_parquet_to_duckdb</span>(</span>
<span id="cb58-778"><a href="#cb58-778" aria-hidden="true" tabindex="-1"></a>  <span class="at">con        =</span> con,</span>
<span id="cb58-779"><a href="#cb58-779" aria-hidden="true" tabindex="-1"></a>  <span class="at">gcs_path   =</span> <span class="st">"gs://calcofi-db/ingest/swfsc.noaa.gov_calcofi-db/grid.parquet"</span>,</span>
<span id="cb58-780"><a href="#cb58-780" aria-hidden="true" tabindex="-1"></a>  <span class="at">table_name =</span> <span class="st">"grid"</span>)</span>
<span id="cb58-781"><a href="#cb58-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-782"><a href="#cb58-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-783"><a href="#cb58-783" aria-hidden="true" tabindex="-1"></a><span class="fu">### Update `casts.grid_key`</span></span>
<span id="cb58-784"><a href="#cb58-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-787"><a href="#cb58-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-788"><a href="#cb58-788" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: update_cast_from_grid</span></span>
<span id="cb58-789"><a href="#cb58-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-790"><a href="#cb58-790" aria-hidden="true" tabindex="-1"></a>grid_stats <span class="ot">&lt;-</span> <span class="fu">assign_grid_key</span>(con, <span class="st">"casts"</span>)</span>
<span id="cb58-791"><a href="#cb58-791" aria-hidden="true" tabindex="-1"></a>grid_stats <span class="sc">|&gt;</span> <span class="fu">datatable</span>()</span>
<span id="cb58-792"><a href="#cb58-792" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-793"><a href="#cb58-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-794"><a href="#cb58-794" aria-hidden="true" tabindex="-1"></a><span class="fu">### Create `casts_derived` VIEW</span></span>
<span id="cb58-795"><a href="#cb58-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-796"><a href="#cb58-796" aria-hidden="true" tabindex="-1"></a>Create convenience VIEW after all casts table modifications are complete</span>
<span id="cb58-797"><a href="#cb58-797" aria-hidden="true" tabindex="-1"></a>(column drops, pivots, spatial join). The VIEW adds back temporal and</span>
<span id="cb58-798"><a href="#cb58-798" aria-hidden="true" tabindex="-1"></a>coordinate columns derivable from the base table.</span>
<span id="cb58-799"><a href="#cb58-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-802"><a href="#cb58-802" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-803"><a href="#cb58-803" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: create_casts_derived</span></span>
<span id="cb58-804"><a href="#cb58-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-805"><a href="#cb58-805" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"DROP VIEW IF EXISTS casts_derived"</span>)</span>
<span id="cb58-806"><a href="#cb58-806" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"</span></span>
<span id="cb58-807"><a href="#cb58-807" aria-hidden="true" tabindex="-1"></a><span class="st">  CREATE VIEW casts_derived AS</span></span>
<span id="cb58-808"><a href="#cb58-808" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT *,</span></span>
<span id="cb58-809"><a href="#cb58-809" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM datetime_utc)::SMALLINT    AS year,</span></span>
<span id="cb58-810"><a href="#cb58-810" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(MONTH FROM datetime_utc)::SMALLINT   AS month,</span></span>
<span id="cb58-811"><a href="#cb58-811" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(QUARTER FROM datetime_utc)::SMALLINT AS quarter,</span></span>
<span id="cb58-812"><a href="#cb58-812" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(DOY FROM datetime_utc)::SMALLINT     AS julian_day,</span></span>
<span id="cb58-813"><a href="#cb58-813" aria-hidden="true" tabindex="-1"></a><span class="st">    (datetime_utc::DATE - DATE '1899-12-30')     AS julian_date,</span></span>
<span id="cb58-814"><a href="#cb58-814" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lat_dec))::SMALLINT                AS lat_deg,</span></span>
<span id="cb58-815"><a href="#cb58-815" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lat_dec) - FLOOR(ABS(lat_dec))) * 60    AS lat_min,</span></span>
<span id="cb58-816"><a href="#cb58-816" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lat_dec &gt;= 0 THEN 'N' ELSE 'S' END AS lat_hem,</span></span>
<span id="cb58-817"><a href="#cb58-817" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lon_dec))::SMALLINT                AS lon_deg,</span></span>
<span id="cb58-818"><a href="#cb58-818" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lon_dec) - FLOOR(ABS(lon_dec))) * 60    AS lon_min,</span></span>
<span id="cb58-819"><a href="#cb58-819" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lon_dec &gt;= 0 THEN 'E' ELSE 'W' END AS lon_hem,</span></span>
<span id="cb58-820"><a href="#cb58-820" aria-hidden="true" tabindex="-1"></a><span class="st">    STRFTIME(datetime_utc, '%Y%m')                AS cruise,</span></span>
<span id="cb58-821"><a href="#cb58-821" aria-hidden="true" tabindex="-1"></a><span class="st">    REPLACE(REPLACE(sta_key, '.', ''), ' ', '')   AS db_sta_key</span></span>
<span id="cb58-822"><a href="#cb58-822" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM casts"</span>)</span>
<span id="cb58-823"><a href="#cb58-823" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Created casts_derived VIEW with derived temporal/coordinate columns"</span>)</span>
<span id="cb58-824"><a href="#cb58-824" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-825"><a href="#cb58-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-826"><a href="#cb58-826" aria-hidden="true" tabindex="-1"></a><span class="fu">### Map Cast Locations</span></span>
<span id="cb58-827"><a href="#cb58-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-830"><a href="#cb58-830" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-831"><a href="#cb58-831" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: map_casts</span></span>
<span id="cb58-832"><a href="#cb58-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-833"><a href="#cb58-833" aria-hidden="true" tabindex="-1"></a><span class="co"># slowish, so use cached figure</span></span>
<span id="cb58-834"><a href="#cb58-834" aria-hidden="true" tabindex="-1"></a>map_casts_png <span class="ot">&lt;-</span> <span class="fu">here</span>(<span class="fu">glue</span>(<span class="st">"figures/{provider}_{dataset}_casts_map.png"</span>))</span>
<span id="cb58-835"><a href="#cb58-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-836"><a href="#cb58-836" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file_exists</span>(map_casts_png)) {</span>
<span id="cb58-837"><a href="#cb58-837" aria-hidden="true" tabindex="-1"></a>  casts_sf <span class="ot">&lt;-</span> calcofi4r<span class="sc">::</span><span class="fu">cc_read_sf</span>(con, <span class="st">"casts"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-838"><a href="#cb58-838" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(datetime_utc))</span>
<span id="cb58-839"><a href="#cb58-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-840"><a href="#cb58-840" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mapView</span>(casts_sf, <span class="at">zcol =</span> <span class="st">"year"</span>)</span>
<span id="cb58-841"><a href="#cb58-841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapshot2</span>(m, <span class="at">file =</span> map_casts_png)</span>
<span id="cb58-842"><a href="#cb58-842" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-843"><a href="#cb58-843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-844"><a href="#cb58-844" aria-hidden="true" tabindex="-1"></a>htmltools<span class="sc">::</span><span class="fu">img</span>(</span>
<span id="cb58-845"><a href="#cb58-845" aria-hidden="true" tabindex="-1"></a>  <span class="at">src   =</span> map_casts_png <span class="sc">|&gt;</span> <span class="fu">str_replace</span>(<span class="fu">here</span>(), <span class="st">"."</span>),</span>
<span id="cb58-846"><a href="#cb58-846" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="st">"600px"</span>)</span>
<span id="cb58-847"><a href="#cb58-847" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-848"><a href="#cb58-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-849"><a href="#cb58-849" aria-hidden="true" tabindex="-1"></a><span class="fu">## Report</span></span>
<span id="cb58-850"><a href="#cb58-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-853"><a href="#cb58-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-854"><a href="#cb58-854" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_latest</span></span>
<span id="cb58-855"><a href="#cb58-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-856"><a href="#cb58-856" aria-hidden="true" tabindex="-1"></a>all_tbls <span class="ot">&lt;-</span> <span class="fu">db_tables</span>(con)</span>
<span id="cb58-857"><a href="#cb58-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-858"><a href="#cb58-858" aria-hidden="true" tabindex="-1"></a>add_bottle_spatial_keys <span class="ot">&lt;-</span> <span class="cf">function</span>(dm){</span>
<span id="cb58-859"><a href="#cb58-859" aria-hidden="true" tabindex="-1"></a>  dm <span class="sc">|&gt;</span></span>
<span id="cb58-860"><a href="#cb58-860" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_pk</span>(grid, grid_key) <span class="sc">|&gt;</span></span>
<span id="cb58-861"><a href="#cb58-861" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dm_add_fk</span>(casts, grid_key, grid)</span>
<span id="cb58-862"><a href="#cb58-862" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-863"><a href="#cb58-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-864"><a href="#cb58-864" aria-hidden="true" tabindex="-1"></a>dm_final <span class="ot">&lt;-</span> <span class="fu">dm_from_con</span>(con, <span class="at">table_names =</span> all_tbls, <span class="at">learn_keys =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-865"><a href="#cb58-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_bottle_keys</span>() <span class="sc">|&gt;</span></span>
<span id="cb58-866"><a href="#cb58-866" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_bottle_spatial_keys</span>() <span class="sc">|&gt;</span></span>
<span id="cb58-867"><a href="#cb58-867" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_set_colors</span>(</span>
<span id="cb58-868"><a href="#cb58-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightgreen  =</span> grid,</span>
<span id="cb58-869"><a href="#cb58-869" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightyellow =</span> <span class="fu">c</span>(bottle_measurement, cast_condition),</span>
<span id="cb58-870"><a href="#cb58-870" aria-hidden="true" tabindex="-1"></a>    <span class="at">lightblue   =</span> measurement_type)</span>
<span id="cb58-871"><a href="#cb58-871" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(dm_final, <span class="at">view_type =</span> <span class="st">"all"</span>)</span>
<span id="cb58-872"><a href="#cb58-872" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-873"><a href="#cb58-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-876"><a href="#cb58-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-877"><a href="#cb58-877" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: summary_stats</span></span>
<span id="cb58-878"><a href="#cb58-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-879"><a href="#cb58-879" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb58-880"><a href="#cb58-880" aria-hidden="true" tabindex="-1"></a>n_casts   <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"casts"</span>) <span class="sc">|&gt;</span> <span class="fu">tally</span>() <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb58-881"><a href="#cb58-881" aria-hidden="true" tabindex="-1"></a>n_bottles <span class="ot">&lt;-</span> <span class="fu">tbl</span>(con, <span class="st">"bottle"</span>) <span class="sc">|&gt;</span> <span class="fu">tally</span>() <span class="sc">|&gt;</span> <span class="fu">pull</span>(n)</span>
<span id="cb58-882"><a href="#cb58-882" aria-hidden="true" tabindex="-1"></a>n_meas    <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM bottle_measurement"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-883"><a href="#cb58-883" aria-hidden="true" tabindex="-1"></a>n_cond    <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT COUNT(*) FROM cast_condition"</span>)[[<span class="dv">1</span>]]</span>
<span id="cb58-884"><a href="#cb58-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-885"><a href="#cb58-885" aria-hidden="true" tabindex="-1"></a>year_range <span class="ot">&lt;-</span> <span class="fu">dbGetQuery</span>(con, <span class="st">"</span></span>
<span id="cb58-886"><a href="#cb58-886" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT</span></span>
<span id="cb58-887"><a href="#cb58-887" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM MIN(datetime_utc))::INTEGER AS yr_min,</span></span>
<span id="cb58-888"><a href="#cb58-888" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM MAX(datetime_utc))::INTEGER AS yr_max</span></span>
<span id="cb58-889"><a href="#cb58-889" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM casts"</span>)</span>
<span id="cb58-890"><a href="#cb58-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-891"><a href="#cb58-891" aria-hidden="true" tabindex="-1"></a>fmt <span class="ot">&lt;-</span> <span class="cf">function</span>(x, ...) <span class="fu">format</span>(x, <span class="at">big.mark =</span> <span class="st">","</span>, ...)</span>
<span id="cb58-892"><a href="#cb58-892" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total casts: {fmt(n_casts)}"</span>))</span>
<span id="cb58-893"><a href="#cb58-893" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total bottles: {fmt(n_bottles)}"</span>))</span>
<span id="cb58-894"><a href="#cb58-894" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total bottle measurements: {fmt(n_meas)}"</span>))</span>
<span id="cb58-895"><a href="#cb58-895" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Total cast conditions: {fmt(n_cond)}"</span>))</span>
<span id="cb58-896"><a href="#cb58-896" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Year range: {year_range$yr_min} - {year_range$yr_max}"</span>))</span>
<span id="cb58-897"><a href="#cb58-897" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-898"><a href="#cb58-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-899"><a href="#cb58-899" aria-hidden="true" tabindex="-1"></a><span class="fu">## Validate Local Database</span></span>
<span id="cb58-900"><a href="#cb58-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-901"><a href="#cb58-901" aria-hidden="true" tabindex="-1"></a>Validate data quality in the local wrangling database before exporting</span>
<span id="cb58-902"><a href="#cb58-902" aria-hidden="true" tabindex="-1"></a>to parquet. The parquet outputs from this workflow can later be used to</span>
<span id="cb58-903"><a href="#cb58-903" aria-hidden="true" tabindex="-1"></a>update the Working DuckLake.</span>
<span id="cb58-904"><a href="#cb58-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-907"><a href="#cb58-907" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-908"><a href="#cb58-908" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: validate</span></span>
<span id="cb58-909"><a href="#cb58-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-910"><a href="#cb58-910" aria-hidden="true" tabindex="-1"></a><span class="co"># validate data quality</span></span>
<span id="cb58-911"><a href="#cb58-911" aria-hidden="true" tabindex="-1"></a>validation <span class="ot">&lt;-</span> <span class="fu">validate_for_release</span>(con)</span>
<span id="cb58-912"><a href="#cb58-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-913"><a href="#cb58-913" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (validation<span class="sc">$</span>passed) {</span>
<span id="cb58-914"><a href="#cb58-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="st">"Validation passed!"</span>)</span>
<span id="cb58-915"><a href="#cb58-915" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(validation<span class="sc">$</span>checks) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb58-916"><a href="#cb58-916" aria-hidden="true" tabindex="-1"></a>    validation<span class="sc">$</span>checks <span class="sc">|&gt;</span></span>
<span id="cb58-917"><a href="#cb58-917" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(status <span class="sc">!=</span> <span class="st">"pass"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-918"><a href="#cb58-918" aria-hidden="true" tabindex="-1"></a>      <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Validation Warnings"</span>)</span>
<span id="cb58-919"><a href="#cb58-919" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-920"><a href="#cb58-920" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb58-921"><a href="#cb58-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Validation FAILED:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb58-922"><a href="#cb58-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">"-"</span>, validation<span class="sc">$</span>errors, <span class="at">collapse =</span> <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span>
<span id="cb58-923"><a href="#cb58-923" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-924"><a href="#cb58-924" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-925"><a href="#cb58-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-926"><a href="#cb58-926" aria-hidden="true" tabindex="-1"></a><span class="fu">## Enforce Column Types</span></span>
<span id="cb58-927"><a href="#cb58-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-928"><a href="#cb58-928" aria-hidden="true" tabindex="-1"></a>Force integer/smallint types on columns that R's <span class="in">`numeric`</span> mapped to</span>
<span id="cb58-929"><a href="#cb58-929" aria-hidden="true" tabindex="-1"></a><span class="in">`DOUBLE`</span> during <span class="in">`dbWriteTable()`</span>. Uses <span class="in">`flds_redefine.csv`</span> (<span class="in">`type_new`</span>)</span>
<span id="cb58-930"><a href="#cb58-930" aria-hidden="true" tabindex="-1"></a>as the source of truth for source-table columns, plus explicit overrides</span>
<span id="cb58-931"><a href="#cb58-931" aria-hidden="true" tabindex="-1"></a>for derived-table columns.</span>
<span id="cb58-932"><a href="#cb58-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-935"><a href="#cb58-935" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-936"><a href="#cb58-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: enforce_types</span></span>
<span id="cb58-937"><a href="#cb58-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-938"><a href="#cb58-938" aria-hidden="true" tabindex="-1"></a>type_changes <span class="ot">&lt;-</span> <span class="fu">enforce_column_types</span>(</span>
<span id="cb58-939"><a href="#cb58-939" aria-hidden="true" tabindex="-1"></a>  <span class="at">con            =</span> con,</span>
<span id="cb58-940"><a href="#cb58-940" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_flds_rd      =</span> d<span class="sc">$</span>d_flds_rd,</span>
<span id="cb58-941"><a href="#cb58-941" aria-hidden="true" tabindex="-1"></a>  <span class="at">type_overrides =</span> <span class="fu">list</span>(),</span>
<span id="cb58-942"><a href="#cb58-942" aria-hidden="true" tabindex="-1"></a>  <span class="at">tables         =</span> <span class="fu">db_tables</span>(con),</span>
<span id="cb58-943"><a href="#cb58-943" aria-hidden="true" tabindex="-1"></a>  <span class="at">verbose        =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-944"><a href="#cb58-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-945"><a href="#cb58-945" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">nrow</span>(type_changes) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb58-946"><a href="#cb58-946" aria-hidden="true" tabindex="-1"></a>  type_changes <span class="sc">|&gt;</span></span>
<span id="cb58-947"><a href="#cb58-947" aria-hidden="true" tabindex="-1"></a>    <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Column type changes applied"</span>)</span>
<span id="cb58-948"><a href="#cb58-948" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb58-949"><a href="#cb58-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-950"><a href="#cb58-950" aria-hidden="true" tabindex="-1"></a><span class="co"># recreate casts_derived VIEW after type changes</span></span>
<span id="cb58-951"><a href="#cb58-951" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"DROP VIEW IF EXISTS casts_derived"</span>)</span>
<span id="cb58-952"><a href="#cb58-952" aria-hidden="true" tabindex="-1"></a><span class="fu">dbExecute</span>(con, <span class="st">"</span></span>
<span id="cb58-953"><a href="#cb58-953" aria-hidden="true" tabindex="-1"></a><span class="st">  CREATE VIEW casts_derived AS</span></span>
<span id="cb58-954"><a href="#cb58-954" aria-hidden="true" tabindex="-1"></a><span class="st">  SELECT *,</span></span>
<span id="cb58-955"><a href="#cb58-955" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(YEAR FROM datetime_utc)::SMALLINT    AS year,</span></span>
<span id="cb58-956"><a href="#cb58-956" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(MONTH FROM datetime_utc)::SMALLINT   AS month,</span></span>
<span id="cb58-957"><a href="#cb58-957" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(QUARTER FROM datetime_utc)::SMALLINT AS quarter,</span></span>
<span id="cb58-958"><a href="#cb58-958" aria-hidden="true" tabindex="-1"></a><span class="st">    EXTRACT(DOY FROM datetime_utc)::SMALLINT     AS julian_day,</span></span>
<span id="cb58-959"><a href="#cb58-959" aria-hidden="true" tabindex="-1"></a><span class="st">    (datetime_utc::DATE - DATE '1899-12-30')     AS julian_date,</span></span>
<span id="cb58-960"><a href="#cb58-960" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lat_dec))::SMALLINT                AS lat_deg,</span></span>
<span id="cb58-961"><a href="#cb58-961" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lat_dec) - FLOOR(ABS(lat_dec))) * 60    AS lat_min,</span></span>
<span id="cb58-962"><a href="#cb58-962" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lat_dec &gt;= 0 THEN 'N' ELSE 'S' END AS lat_hem,</span></span>
<span id="cb58-963"><a href="#cb58-963" aria-hidden="true" tabindex="-1"></a><span class="st">    FLOOR(ABS(lon_dec))::SMALLINT                AS lon_deg,</span></span>
<span id="cb58-964"><a href="#cb58-964" aria-hidden="true" tabindex="-1"></a><span class="st">    (ABS(lon_dec) - FLOOR(ABS(lon_dec))) * 60    AS lon_min,</span></span>
<span id="cb58-965"><a href="#cb58-965" aria-hidden="true" tabindex="-1"></a><span class="st">    CASE WHEN lon_dec &gt;= 0 THEN 'E' ELSE 'W' END AS lon_hem,</span></span>
<span id="cb58-966"><a href="#cb58-966" aria-hidden="true" tabindex="-1"></a><span class="st">    STRFTIME(datetime_utc, '%Y%m')                AS cruise,</span></span>
<span id="cb58-967"><a href="#cb58-967" aria-hidden="true" tabindex="-1"></a><span class="st">    REPLACE(REPLACE(sta_key, '.', ''), ' ', '')   AS db_sta_key</span></span>
<span id="cb58-968"><a href="#cb58-968" aria-hidden="true" tabindex="-1"></a><span class="st">  FROM casts"</span>)</span>
<span id="cb58-969"><a href="#cb58-969" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Recreated casts_derived VIEW after column type enforcement"</span>)</span>
<span id="cb58-970"><a href="#cb58-970" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-971"><a href="#cb58-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-972"><a href="#cb58-972" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data Preview</span></span>
<span id="cb58-973"><a href="#cb58-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-974"><a href="#cb58-974" aria-hidden="true" tabindex="-1"></a>Preview first and last rows of each table before writing parquet outputs.</span>
<span id="cb58-975"><a href="#cb58-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-978"><a href="#cb58-978" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-979"><a href="#cb58-979" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: preview_tables</span></span>
<span id="cb58-980"><a href="#cb58-980" aria-hidden="true" tabindex="-1"></a><span class="co">#| results: asis</span></span>
<span id="cb58-981"><a href="#cb58-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-982"><a href="#cb58-982" aria-hidden="true" tabindex="-1"></a><span class="fu">preview_tables</span>(con, <span class="fu">c</span>(</span>
<span id="cb58-983"><a href="#cb58-983" aria-hidden="true" tabindex="-1"></a>  <span class="st">"casts"</span>, <span class="st">"bottle"</span>, <span class="st">"bottle_measurement"</span>,</span>
<span id="cb58-984"><a href="#cb58-984" aria-hidden="true" tabindex="-1"></a>  <span class="st">"cast_condition"</span>, <span class="st">"measurement_type"</span>))  <span class="co"># grid canonical from swfsc</span></span>
<span id="cb58-985"><a href="#cb58-985" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-986"><a href="#cb58-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-989"><a href="#cb58-989" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-990"><a href="#cb58-990" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: preview_casts_derived</span></span>
<span id="cb58-991"><a href="#cb58-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-992"><a href="#cb58-992" aria-hidden="true" tabindex="-1"></a><span class="co"># casts_derived is a VIEW, preview separately</span></span>
<span id="cb58-993"><a href="#cb58-993" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(con, <span class="st">"SELECT * FROM casts_derived LIMIT 100"</span>) <span class="sc">|&gt;</span></span>
<span id="cb58-994"><a href="#cb58-994" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(</span>
<span id="cb58-995"><a href="#cb58-995" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption  =</span> <span class="st">"casts_derived — first 100 rows (VIEW)"</span>,</span>
<span id="cb58-996"><a href="#cb58-996" aria-hidden="true" tabindex="-1"></a>    <span class="at">rownames =</span> <span class="cn">FALSE</span>,</span>
<span id="cb58-997"><a href="#cb58-997" aria-hidden="true" tabindex="-1"></a>    <span class="at">filter   =</span> <span class="st">"top"</span>)</span>
<span id="cb58-998"><a href="#cb58-998" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-999"><a href="#cb58-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1000"><a href="#cb58-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">## Write Parquet Outputs</span></span>
<span id="cb58-1001"><a href="#cb58-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1002"><a href="#cb58-1002" aria-hidden="true" tabindex="-1"></a>Export tables to parquet files for downstream use.</span>
<span id="cb58-1003"><a href="#cb58-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1006"><a href="#cb58-1006" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-1007"><a href="#cb58-1007" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: write_parquet</span></span>
<span id="cb58-1008"><a href="#cb58-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1009"><a href="#cb58-1009" aria-hidden="true" tabindex="-1"></a><span class="co"># write parquet files with manifest</span></span>
<span id="cb58-1010"><a href="#cb58-1010" aria-hidden="true" tabindex="-1"></a>parquet_stats <span class="ot">&lt;-</span> <span class="fu">write_parquet_outputs</span>(</span>
<span id="cb58-1011"><a href="#cb58-1011" aria-hidden="true" tabindex="-1"></a>  <span class="at">con              =</span> con,</span>
<span id="cb58-1012"><a href="#cb58-1012" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir       =</span> dir_parquet,</span>
<span id="cb58-1013"><a href="#cb58-1013" aria-hidden="true" tabindex="-1"></a>  <span class="at">tables           =</span> <span class="fu">setdiff</span>(<span class="fu">db_tables</span>(con), <span class="st">"grid"</span>),  <span class="co"># grid canonical from swfsc</span></span>
<span id="cb58-1014"><a href="#cb58-1014" aria-hidden="true" tabindex="-1"></a>  <span class="at">strip_provenance =</span> F)</span>
<span id="cb58-1015"><a href="#cb58-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1016"><a href="#cb58-1016" aria-hidden="true" tabindex="-1"></a>parquet_stats <span class="sc">|&gt;</span></span>
<span id="cb58-1017"><a href="#cb58-1017" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">file =</span> <span class="fu">basename</span>(path)) <span class="sc">|&gt;</span></span>
<span id="cb58-1018"><a href="#cb58-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>path) <span class="sc">|&gt;</span></span>
<span id="cb58-1019"><a href="#cb58-1019" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Parquet export statistics"</span>)</span>
<span id="cb58-1020"><a href="#cb58-1020" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-1021"><a href="#cb58-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1022"><a href="#cb58-1022" aria-hidden="true" tabindex="-1"></a><span class="fu">## Write Metadata</span></span>
<span id="cb58-1023"><a href="#cb58-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1024"><a href="#cb58-1024" aria-hidden="true" tabindex="-1"></a>Build <span class="in">`metadata.json`</span> sidecar file documenting all tables and columns in</span>
<span id="cb58-1025"><a href="#cb58-1025" aria-hidden="true" tabindex="-1"></a>parquet outputs. DuckDB <span class="in">`COMMENT ON`</span> does not propagate to parquet, so</span>
<span id="cb58-1026"><a href="#cb58-1026" aria-hidden="true" tabindex="-1"></a>this provides the metadata externally.</span>
<span id="cb58-1027"><a href="#cb58-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1030"><a href="#cb58-1030" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-1031"><a href="#cb58-1031" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: write_metadata</span></span>
<span id="cb58-1032"><a href="#cb58-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1033"><a href="#cb58-1033" aria-hidden="true" tabindex="-1"></a>metadata_path <span class="ot">&lt;-</span> <span class="fu">build_metadata_json</span>(</span>
<span id="cb58-1034"><a href="#cb58-1034" aria-hidden="true" tabindex="-1"></a>  <span class="at">con                  =</span> con,</span>
<span id="cb58-1035"><a href="#cb58-1035" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_tbls_rd            =</span> d<span class="sc">$</span>d_tbls_rd,</span>
<span id="cb58-1036"><a href="#cb58-1036" aria-hidden="true" tabindex="-1"></a>  <span class="at">d_flds_rd            =</span> d<span class="sc">$</span>d_flds_rd,</span>
<span id="cb58-1037"><a href="#cb58-1037" aria-hidden="true" tabindex="-1"></a>  <span class="at">metadata_derived_csv =</span> <span class="fu">here</span>(</span>
<span id="cb58-1038"><a href="#cb58-1038" aria-hidden="true" tabindex="-1"></a>    <span class="st">"metadata/calcofi.org/bottle-database/metadata_derived.csv"</span>),</span>
<span id="cb58-1039"><a href="#cb58-1039" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_dir           =</span> dir_parquet,</span>
<span id="cb58-1040"><a href="#cb58-1040" aria-hidden="true" tabindex="-1"></a>  <span class="at">tables               =</span> <span class="fu">db_tables</span>(con),</span>
<span id="cb58-1041"><a href="#cb58-1041" aria-hidden="true" tabindex="-1"></a>  <span class="at">set_comments         =</span> <span class="cn">TRUE</span>,</span>
<span id="cb58-1042"><a href="#cb58-1042" aria-hidden="true" tabindex="-1"></a>  <span class="at">provider             =</span> provider,</span>
<span id="cb58-1043"><a href="#cb58-1043" aria-hidden="true" tabindex="-1"></a>  <span class="at">dataset              =</span> dataset,</span>
<span id="cb58-1044"><a href="#cb58-1044" aria-hidden="true" tabindex="-1"></a>  <span class="at">workflow_url         =</span> <span class="fu">glue</span>(</span>
<span id="cb58-1045"><a href="#cb58-1045" aria-hidden="true" tabindex="-1"></a>    <span class="st">"https://calcofi.io/workflows/"</span>,</span>
<span id="cb58-1046"><a href="#cb58-1046" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ingest_calcofi.org_bottle-database.html"</span>))</span>
<span id="cb58-1047"><a href="#cb58-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1048"><a href="#cb58-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># show metadata summary</span></span>
<span id="cb58-1049"><a href="#cb58-1049" aria-hidden="true" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(metadata_path)</span>
<span id="cb58-1050"><a href="#cb58-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">tibble</span>(</span>
<span id="cb58-1051"><a href="#cb58-1051" aria-hidden="true" tabindex="-1"></a>  <span class="at">table   =</span> <span class="fu">names</span>(metadata<span class="sc">$</span>tables),</span>
<span id="cb58-1052"><a href="#cb58-1052" aria-hidden="true" tabindex="-1"></a>  <span class="at">n_cols  =</span> <span class="fu">map_int</span>(</span>
<span id="cb58-1053"><a href="#cb58-1053" aria-hidden="true" tabindex="-1"></a>    <span class="fu">names</span>(metadata<span class="sc">$</span>tables),</span>
<span id="cb58-1054"><a href="#cb58-1054" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span><span class="fu">sum</span>(<span class="fu">grepl</span>(<span class="fu">glue</span>(<span class="st">"^{.x}</span><span class="sc">\\</span><span class="st">."</span>), <span class="fu">names</span>(metadata<span class="sc">$</span>columns)))),</span>
<span id="cb58-1055"><a href="#cb58-1055" aria-hidden="true" tabindex="-1"></a>  <span class="at">name_long =</span> <span class="fu">map_chr</span>(metadata<span class="sc">$</span>tables, <span class="sc">~</span>.x<span class="sc">$</span>name_long)) <span class="sc">|&gt;</span></span>
<span id="cb58-1056"><a href="#cb58-1056" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datatable</span>(<span class="at">caption =</span> <span class="st">"Table metadata summary"</span>)</span>
<span id="cb58-1057"><a href="#cb58-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-1058"><a href="#cb58-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1061"><a href="#cb58-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-1062"><a href="#cb58-1062" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: show_metadata_json</span></span>
<span id="cb58-1063"><a href="#cb58-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1064"><a href="#cb58-1064" aria-hidden="true" tabindex="-1"></a>listviewer<span class="sc">::</span><span class="fu">jsonedit</span>(</span>
<span id="cb58-1065"><a href="#cb58-1065" aria-hidden="true" tabindex="-1"></a>  jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(metadata_path, <span class="at">simplifyVector =</span> <span class="cn">FALSE</span>),</span>
<span id="cb58-1066"><a href="#cb58-1066" aria-hidden="true" tabindex="-1"></a>  <span class="at">mode =</span> <span class="st">"view"</span>)</span>
<span id="cb58-1067"><a href="#cb58-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-1068"><a href="#cb58-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1069"><a href="#cb58-1069" aria-hidden="true" tabindex="-1"></a><span class="fu">## Upload to GCS Archive</span></span>
<span id="cb58-1070"><a href="#cb58-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1071"><a href="#cb58-1071" aria-hidden="true" tabindex="-1"></a>Upload parquet files, manifest, and metadata sidecar to</span>
<span id="cb58-1072"><a href="#cb58-1072" aria-hidden="true" tabindex="-1"></a><span class="in">`gs://calcofi-db/ingest/{provider}_{dataset}/`</span>.</span>
<span id="cb58-1073"><a href="#cb58-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1076"><a href="#cb58-1076" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-1077"><a href="#cb58-1077" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: upload_gcs</span></span>
<span id="cb58-1078"><a href="#cb58-1078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1079"><a href="#cb58-1079" aria-hidden="true" tabindex="-1"></a>gcs_ingest_prefix <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"ingest/{provider}_{dataset}"</span>)</span>
<span id="cb58-1080"><a href="#cb58-1080" aria-hidden="true" tabindex="-1"></a>gcs_bucket        <span class="ot">&lt;-</span> <span class="st">"calcofi-db"</span></span>
<span id="cb58-1081"><a href="#cb58-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1082"><a href="#cb58-1082" aria-hidden="true" tabindex="-1"></a><span class="co"># list local files to upload (parquet + json sidecars)</span></span>
<span id="cb58-1083"><a href="#cb58-1083" aria-hidden="true" tabindex="-1"></a>local_files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(dir_parquet, <span class="at">full.names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb58-1084"><a href="#cb58-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1085"><a href="#cb58-1085" aria-hidden="true" tabindex="-1"></a><span class="co"># upload each file</span></span>
<span id="cb58-1086"><a href="#cb58-1086" aria-hidden="true" tabindex="-1"></a><span class="fu">walk</span>(local_files, <span class="cf">function</span>(f) {</span>
<span id="cb58-1087"><a href="#cb58-1087" aria-hidden="true" tabindex="-1"></a>  gcs_path <span class="ot">&lt;-</span> <span class="fu">glue</span>(<span class="st">"gs://{gcs_bucket}/{gcs_ingest_prefix}/{basename(f)}"</span>)</span>
<span id="cb58-1088"><a href="#cb58-1088" aria-hidden="true" tabindex="-1"></a>  <span class="fu">put_gcs_file</span>(f, gcs_path)</span>
<span id="cb58-1089"><a href="#cb58-1089" aria-hidden="true" tabindex="-1"></a>  <span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Uploaded {basename(f)} -&gt; {gcs_path}"</span>))</span>
<span id="cb58-1090"><a href="#cb58-1090" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb58-1091"><a href="#cb58-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1092"><a href="#cb58-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(</span>
<span id="cb58-1093"><a href="#cb58-1093" aria-hidden="true" tabindex="-1"></a>  <span class="st">"</span><span class="sc">\n</span><span class="st">Uploaded {length(local_files)} files to "</span>,</span>
<span id="cb58-1094"><a href="#cb58-1094" aria-hidden="true" tabindex="-1"></a>  <span class="st">"gs://{gcs_bucket}/{gcs_ingest_prefix}/"</span>))</span>
<span id="cb58-1095"><a href="#cb58-1095" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-1096"><a href="#cb58-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1097"><a href="#cb58-1097" aria-hidden="true" tabindex="-1"></a><span class="fu">## Cleanup</span></span>
<span id="cb58-1098"><a href="#cb58-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1101"><a href="#cb58-1101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb58-1102"><a href="#cb58-1102" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: cleanup</span></span>
<span id="cb58-1103"><a href="#cb58-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1104"><a href="#cb58-1104" aria-hidden="true" tabindex="-1"></a><span class="co"># close local wrangling database connection</span></span>
<span id="cb58-1105"><a href="#cb58-1105" aria-hidden="true" tabindex="-1"></a><span class="fu">close_duckdb</span>(con)</span>
<span id="cb58-1106"><a href="#cb58-1106" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="st">"Local wrangling database connection closed"</span>)</span>
<span id="cb58-1107"><a href="#cb58-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1108"><a href="#cb58-1108" aria-hidden="true" tabindex="-1"></a><span class="co"># note: parquet outputs are in data/parquet/calcofi.org_bottle-database/</span></span>
<span id="cb58-1109"><a href="#cb58-1109" aria-hidden="true" tabindex="-1"></a><span class="co"># these can be used to update the Working DuckLake in a separate workflow</span></span>
<span id="cb58-1110"><a href="#cb58-1110" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"Parquet outputs written to: {dir_parquet}"</span>))</span>
<span id="cb58-1111"><a href="#cb58-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">message</span>(<span class="fu">glue</span>(<span class="st">"GCS outputs at: gs://{gcs_bucket}/{gcs_ingest_prefix}/"</span>))</span>
<span id="cb58-1112"><a href="#cb58-1112" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-1113"><a href="#cb58-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1114"><a href="#cb58-1114" aria-hidden="true" tabindex="-1"></a><span class="fu">## TODO</span></span>
<span id="cb58-1115"><a href="#cb58-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1116"><a href="#cb58-1116" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Review column names and apply db naming conventions, per @docs/db.qmd and @workflows/README_PLAN.qmd: cast_cnt -&gt; cast_id, btl_cnt -&gt; bottle_id, sta_id -&gt; sta_key, etc.</span>
<span id="cb58-1117"><a href="#cb58-1117" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Pivot longer casts/bottle tables for easier analysis. Created bottle_measurement (value/prec/qual) and cast_condition tables, plus measurement_type reference.</span>
<span id="cb58-1118"><a href="#cb58-1118" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[x]</span> Consolidate casts temporal columns (date+time -&gt; datetime_utc), drop 16 derivable columns, create casts_derived VIEW.</span>
<span id="cb58-1119"><a href="#cb58-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1120"><a href="#cb58-1120" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Link possible fields to @workflows/ingest_swfsc.noaa.gov_calcofi-db.qmd. Flag mismatches.</span>
<span id="cb58-1121"><a href="#cb58-1121" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Cruise bridge: derive cruise_key from bottle cruise (YYYYMM) + ship_code to match swfsc cruise_key (YYMMKK). Deferred — needs ship_key lookup.</span>
<span id="cb58-1122"><a href="#cb58-1122" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Validate casts.ship_code -&gt; ship.ship_nodc FK after integration with swfsc data.</span>
<span id="cb58-1123"><a href="#cb58-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1124"><a href="#cb58-1124" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="va">[ ]</span> Review documentation for more comment descriptions at [Data <span class="sc">\&gt;</span></span>
<span id="cb58-1125"><a href="#cb58-1125" aria-hidden="true" tabindex="-1"></a>  Data Formats <span class="sc">\|</span> CalCOFI.org](https://calcofi.com/index.php?option=com_content&amp;view=category&amp;id=73&amp;Itemid=993)</span>
<span id="cb58-1126"><a href="#cb58-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1127"><a href="#cb58-1127" aria-hidden="true" tabindex="-1"></a>::: {.callout-caution collapse="true"}</span>
<span id="cb58-1128"><a href="#cb58-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1129"><a href="#cb58-1129" aria-hidden="true" tabindex="-1"></a><span class="fu">## Session Info</span></span>
<span id="cb58-1130"><a href="#cb58-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1131"><a href="#cb58-1131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r session_info}</span></span>
<span id="cb58-1132"><a href="#cb58-1132" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">session_info</span>()</span>
<span id="cb58-1133"><a href="#cb58-1133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb58-1134"><a href="#cb58-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-1135"><a href="#cb58-1135" aria-hidden="true" tabindex="-1"></a>:::</span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>